{"config":{"lang":["fi"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Tervetuloa kurssille","text":"<p>Oppimateriaali on tarkoitettu Kajaanin Ammattikorkeakoulun ensimm\u00e4isen tai toisen vuoden opiskelijoille. Kurssilla tutustutaan Linuxiin k\u00e4ytt\u00f6liittym\u00e4n\u00e4 sek\u00e4 graafiseen ymp\u00e4rist\u00f6\u00f6n ett\u00e4 komentoriviin. Kurssin esimerkit ovat p\u00e4\u00e4osin ajettu Ubuntu distribuutiota k\u00e4ytt\u00e4en, mutta liiallista \"distribution-lockia\" v\u00e4ltell\u00e4\u00e4n parhaan mukaan. Aiempi kokemus Linuxista ei ole mill\u00e4\u00e4n tavoin vaadittua.</p> <p></p> <p>Kuvio 1: DALL-E 3:n n\u00e4kymys <code>sudo</code>-oikeuksin varustetusta pingviinist\u00e4.</p>"},{"location":"#opiskeluvinkki","title":"Opiskeluvinkki","text":"<p>T\u00e4m\u00e4 kurssi vaatii kohtalaisen paljon oma-aloitteisuutta ja itseopiskelua, ja t\u00e4m\u00e4n vuoksi kurssin aikana opettaja on resursoinut reilusti aikaa opiskelijoiden auttamiseen. Jos jokin komento ei toimi, \u00e4l\u00e4 nosta k\u00e4si\u00e4si pystyyn, vaan kysy rohkeasti apua.</p>"},{"location":"#faktavirheet","title":"Faktavirheet","text":"<p>Mik\u00e4li kurssimateriaali sis\u00e4lt\u00e4\u00e4 virheellist\u00e4 tietoa, tee jompi kumpi:</p> <ul> <li>Forkkaa GitHubin repository ja tarjoa Pull Request, joka sis\u00e4lt\u00e4\u00e4 korjausehdotukset.</li> <li>Ota yhteytt\u00e4 yll\u00e4pitoon ja esittele virheellisen tiedon korjaus.</li> </ul>"},{"location":"exercises/","title":"Teht\u00e4v\u00e4kooste","text":"<p>T\u00e4ss\u00e4 tiedostossa on listattuna kaikki materiaalin teht\u00e4v\u00e4t. Osa niist\u00e4 ei v\u00e4ltt\u00e4m\u00e4tt\u00e4  kuulu sinun kurssitoteutukseesi. Huomaa, ett\u00e4 t\u00e4m\u00e4 tiedosto luodaan automaattisesti parsimalla  kaikki repositorion Markdown-tiedostot l\u00e4pi. Mik\u00e4li huomaat puuttuvia teht\u00e4vi\u00e4, ilmoita opettajalle. Otsikon per\u00e4ss\u00e4 suluissa oleva numero on j\u00e4rjestysprioriteetti: se vaikuttaa vain t\u00e4m\u00e4n listan j\u00e4rjestykseen.</p> <p>Lista hy\u00f6dynt\u00e4\u00e4 Material for MkDocs -teeman Tasklist -ominaisuutta.</p> <p>Kopioi teht\u00e4v\u00e4lista leikep\u00f6yd\u00e4lle ja muokkaa se sinun k\u00e4ytt\u00f6\u00f6si sopivaksi.</p> <pre><code>## Aloita t\u00e4st\u00e4 (100)\n\n- [ ] Teht\u00e4v\u00e4: Asenna Ubuntu\n- [ ] Teht\u00e4v\u00e4: Ubuntu opiskelukuntoon\n\n## OS (110)\n\n- [ ] Teht\u00e4v\u00e4: K\u00e4ytt\u00f6j\u00e4rjestelm\u00e4n tarve\n- [ ] Teht\u00e4v\u00e4: Graafinen k\u00e4ytt\u00f6liittym\u00e4\n- [ ] Teht\u00e4v\u00e4: Wayland vs X11\n- [ ] Teht\u00e4v\u00e4: Suositellut jakelut\n- [ ] Teht\u00e4v\u00e4: LTS-lyhenne\n\n## Kernel (120)\n\n- [ ] Teht\u00e4v\u00e4: Kernelin teht\u00e4v\u00e4t\n\n## Tiedostot (200)\n\n- [ ] Teht\u00e4v\u00e4: Hakemistopuu\n- [ ] Teht\u00e4v\u00e4: lsblk\n\n## Komennot (210)\n\n- [ ] Teht\u00e4v\u00e4: Monirivinen komento\n- [ ] Teht\u00e4v\u00e4: Standardoi hakemistorakenne\n- [ ] Teht\u00e4v\u00e4: Graafinen tiedostoselain\n- [ ] Teht\u00e4v\u00e4: IsOt jA PiEnEt kIrJaImEt\n- [ ] Teht\u00e4v\u00e4: V\u00e4lily\u00f6nnit tiedostonimiss\u00e4\n- [ ] Teht\u00e4v\u00e4: Read The Fine Manual ja date-komento\n- [ ] Teht\u00e4v\u00e4: Kissa, ananas, avaruus ja pari muuta\n\n## K\u00e4ytt\u00e4j\u00e4t (220)\n\n- [ ] Teht\u00e4v\u00e4: Nologin\n- [ ] Teht\u00e4v\u00e4: Kenen joukoissa seisot?\n- [ ] Teht\u00e4v\u00e4: Luo k\u00e4ytt\u00e4j\u00e4\n- [ ] Teht\u00e4v\u00e4: K\u00e4ytt\u00e4j\u00e4 ja kirjautuminen\n- [ ] Teht\u00e4v\u00e4: Poista k\u00e4ytt\u00e4j\u00e4\n- [ ] Teht\u00e4v\u00e4: Pidenn\u00e4 sudo-salasanan kyselytiheytt\u00e4\n\n## K\u00e4ytt\u00f6oikeudet (230)\n\n- [ ] Teht\u00e4v\u00e4: K\u00e4ytt\u00f6oikeudet\n- [ ] Teht\u00e4v\u00e4: Tarkista k\u00e4ytt\u00f6oikeudet skriptill\u00e4\n\n## Terminaali (300)\n\n- [ ] Teht\u00e4v\u00e4: tty\n- [ ] Teht\u00e4v\u00e4: Z-Shellin asennus\n\n## Standardivirrat (310)\n\n- [ ] Teht\u00e4v\u00e4: tee\n- [ ] Teht\u00e4v\u00e4: Ohjaa stdout tiedostoon\n- [ ] Teht\u00e4v\u00e4: Ohjaa stderr tiedostoon\n- [ ] Teht\u00e4v\u00e4: PATH ja putket\n\n## Startup-tiedostot (320)\n\n- [ ] Teht\u00e4v\u00e4: Hello world\n- [ ] Teht\u00e4v\u00e4: Asenna Oh My Zsh\n- [ ] Teht\u00e4v\u00e4: Vaihda Oh My Zsh teema\n- [ ] Teht\u00e4v\u00e4: Vaihda Bashiin (ja halutessasi takaisin)\n\n## Ohjelmapaketit (410)\n\n- [ ] Teht\u00e4v\u00e4: Asenna ohjelma\n- [ ] Teht\u00e4v\u00e4: Selvit\u00e4 ohjelman tiedostot\n- [ ] Teht\u00e4v\u00e4: Asennuslokaatiot\n- [ ] Teht\u00e4v\u00e4: Sources.List\n- [ ] Teht\u00e4v\u00e4: Mik\u00e4 on PPA?\n\n## Cross-distro (420)\n\n- [ ] Teht\u00e4v\u00e4: Asenna snap:ll\u00e4\n- [ ] Teht\u00e4v\u00e4: Snap-sovellusten lokaatio\n- [ ] Teht\u00e4v\u00e4: Asenna Flatpakilla\n- [ ] Teht\u00e4v\u00e4: Flatpak-sovellusten lokaatio\n- [ ] Teht\u00e4v\u00e4: Asenna Go\n\n## Prosessit (500)\n\n- [ ] Teht\u00e4v\u00e4: Selvit\u00e4 oman shellisi PID\n- [ ] Teht\u00e4v\u00e4: K\u00e4ynnist\u00e4 ja pys\u00e4yt\u00e4 prosessi taustalla\n- [ ] Teht\u00e4v\u00e4: Tapa prosessi siististi ja v\u00e4kisin\n\n## Systemd (510)\n\n- [ ] Teht\u00e4v\u00e4: Tutustu Systemd Unittiin\n- [ ] Teht\u00e4v\u00e4: Systemd timer\n\n## Cron (520)\n\n- [ ] Teht\u00e4v\u00e4: Cron toimii!\n- [ ] Teht\u00e4v\u00e4: Docker Prune scheduled\n\n## Lokit (530)\n\n- [ ] Teht\u00e4v\u00e4: Kirjoita oma lokimerkint\u00e4\n- [ ] Teht\u00e4v\u00e4: Tarkista palvelun lokit\n- [ ] Teht\u00e4v\u00e4: Todista tietyn palvelun event\n\n## Kontit (540)\n\n- [ ] Teht\u00e4v\u00e4: Docker ps\n\n## SSH (600)\n\n- [ ] Teht\u00e4v\u00e4: SSH yhteys\n\n## Tmux (610)\n\n- [ ] Teht\u00e4v\u00e4: tmuxin k\u00e4ytt\u00f6\n</code></pre>"},{"location":"asennus/aloita/","title":"Aloita t\u00e4st\u00e4","text":""},{"location":"asennus/aloita/#luvun-tehtavat","title":"Luvun teht\u00e4v\u00e4t","text":"<p>T\u00e4m\u00e4n koko luvun Asennus teht\u00e4v\u00e4 on poikkeuksellisesti heti alussa. T\u00e4m\u00e4 johtuu siit\u00e4, ett\u00e4 tarkka asennus riippuu siit\u00e4, mit\u00e4 laitteita sinulla on k\u00e4yt\u00f6ss\u00e4si.</p> <p>Teht\u00e4v\u00e4: Asenna Ubuntu</p> <p>Valitse sinulle sopivin vaihtoehto Linuxin asennustavoista. Lyhyesti vaihtoehdot ovat:</p> <ul> <li>Fyysinen Linux: Dual Boot tai Primary OS</li> <li>Lokaali VM: Oracle VirtualBox, VMware Workstation, Hyper-V</li> <li>DC VM: vSphere</li> </ul> <p>N\u00e4ist\u00e4 neuvotut tavat ovat:</p> <ul> <li>Option A: Dual Boot</li> <li>Option B: VirtualBox</li> </ul> <p>Teht\u00e4v\u00e4 on dokumentoida t\u00e4m\u00e4 prosessi oppimisp\u00e4iv\u00e4kirjaan. K\u00e4yt\u00e4th\u00e4n dokumentoinnissa monipuolisesti teksti\u00e4, kuvia, l\u00e4hteit\u00e4, komentoja code blokeissa ja muita tarvittavia elementtej\u00e4.</p> <p>Teht\u00e4v\u00e4: Ubuntu opiskelukuntoon</p> <p>Kun olet saanut Linuxin asennettua ja olet kirjautunut onnistuneesti GNOME-ty\u00f6p\u00f6yd\u00e4lle, on aika laittaa Linux opiskelukuntoon. T\u00e4m\u00e4 tarkoittaa, ett\u00e4 asennat tarvittavat ohjelmat ja teet tarvittavat asetukset, jotta voit aloittaa opiskelun.</p> <p>T\u00e4h\u00e4n l\u00f6ytyy ohjeet dokumentista Ubuntu opiskelukuntoon.</p> <p>Teht\u00e4v\u00e4 on dokumentoida t\u00e4m\u00e4 prosessi oppimisp\u00e4iv\u00e4kirjaan. K\u00e4yt\u00e4 dokumentaatiossa tekstin, l\u00e4hteiden ja komentojen lis\u00e4ksi my\u00f6s kuvakaappauksia. Kuvia asennusprosessista saat kahdella tavalla:</p> <ul> <li>Ruutukaappaukset: Paina linuxissa n\u00e4pp\u00e4imist\u00f6lt\u00e4 Print Screen -nappia. Aukeaa ohjelma, jolla voi ottaa kuvakaappauksia.</li> <li>K\u00e4nnykk\u00e4kuvat: Ota kuvia k\u00e4nnyk\u00e4ll\u00e4si suoraan n\u00e4yt\u00f6lt\u00e4si.</li> </ul>"},{"location":"asennus/aloita/#kuinka-valita-sopiva-tapa","title":"Kuinka valita sopiva tapa?","text":"<p>Fyysiselle koneelle asentaminen on oppimisen kannalta suositeltava tapa. Opit opintojen aikana k\u00e4ytt\u00e4m\u00e4\u00e4n Linuxia, jos k\u00e4yt\u00e4 sit\u00e4 jatkuvasti - t\u00e4m\u00e4 on helpointa, jos se on asennettuna suoraan koneellesi, ja k\u00e4yt\u00e4t sit\u00e4 p\u00e4ivitt\u00e4in opiskeluihisi. Jos koet ylitsep\u00e4\u00e4sem\u00e4t\u00f6nt\u00e4 ep\u00e4varmuutta t\u00e4m\u00e4n suhteen, seuraavaksi suositelluin metodi on asentaa Linux virtuaalikoneeseen.</p> <p>Alla miellekartta, joka auttaa sinua valitsemaan itsellesi sopivan tavan asentaa Linux.</p> <pre><code>graph TD\n    A[Valitse Linuxin asennustapa] --&gt; B{Uskallatko asentaa fyysiselle koneelle?}\n    B --&gt;|Kyll\u00e4| C[Linux Dual Boot]\n    B --&gt;|Ei| D{Oletko Data Center -opiskelija?}\n    D --&gt;|Kyll\u00e4| E[vSphere VM]\n    D --&gt;|Ei| F{Onko sinulla Windows Pro -lisenssi?}\n    F --&gt;|Kyll\u00e4| G[Hyper-V]\n    F --&gt;|Ei| H{Valitse sopivin hypervisor}\n    H --&gt; J[VirtualBox]\n    H --&gt; K[VMware Workstation]\n    H --&gt; Mac[VMware Fusion]</code></pre> <p>Warning</p> <p>Data center -opiskelijat ovat ainoita, joilla on riitt\u00e4v\u00e4t oikeudet luoda VMwaren vSphereen virtuaalikone. Mik\u00e4li et ole DC-opiskelija, unohda t\u00e4m\u00e4 vaihtoehto.</p>"},{"location":"asennus/aloita/#poikkeustilanteet","title":"Poikkeustilanteet","text":"<p>Mik\u00e4li sinulla on jokin yll\u00e4 mainituista poikkeava tilanne, ota yhteytt\u00e4 opettajaan. Kurssin voi mahdollisesti suorittaa esimerkiksi Azure-virtuaalikoneella tai WSL2-ymp\u00e4rist\u00f6n avulla. H\u00e4t\u00e4tapauksessa kurssin voi suorittaa jopa Linux-luokan koneilla siten, ett\u00e4 luot virt-manager avulla virtuaalikoneen. T\u00e4h\u00e4n tarvitsee kuitenkin erikseen luvan, ja korostan, ett\u00e4 omalle koneelle asentaminen on suositeltavaa. </p> <p>Tip</p> <p>Saatat v\u00e4heksy\u00e4 Linuxia ja komentorivi\u00e4 nyt, mutta ty\u00f6el\u00e4m\u00e4ss\u00e4 tulet tietyll\u00e4 todenn\u00e4k\u00f6isyydell\u00e4 katumaan, mik\u00e4li et k\u00e4yt\u00e4 opintojasi hy\u00f6dyksi n\u00e4iden taitojen kartuttamiseen. Asenna Linux ja k\u00e4yt\u00e4 sit\u00e4 p\u00e4ivitt\u00e4in opiskelussa: n\u00e4in opit sen huomaamatta opiskeluiden aikana.</p>"},{"location":"asennus/dualboot/","title":"Option A: Dual Boot","text":"<p>Warning</p> <p>Sin\u00e4 kannat kaiken vastuun, mik\u00e4li p\u00e4\u00e4t\u00e4t ryhty\u00e4 t\u00e4h\u00e4n prosessiin. Dual boot on opiskeluiden kannalta hyv\u00e4, mutta k\u00e4ytt\u00f6j\u00e4rjestelm\u00e4n asennukseen liittyy luontaisesti riskej\u00e4. Eth\u00e4n tee t\u00e4t\u00e4 esimerkiksi tietokoneelle, jossa on perheenj\u00e4senten Windows-tilien takana t\u00e4rkeit\u00e4 tiedostoja. \u00c4l\u00e4 my\u00f6sk\u00e4\u00e4n tee t\u00e4t\u00e4 tietokoneelle, jonka olet saanut yritykselt\u00e4 tai oppilaitokselta k\u00e4ytt\u00f6\u00f6n siten, ett\u00e4 heid\u00e4n IT-osasto hallinnoi sinun konettasi. Jatka t\u00e4m\u00e4n ohjeen lukemista vain jos olet asentamassa t\u00e4t\u00e4 omalle, henkil\u00f6kohtaiselle tietokoneellesi, ja olet varannut aikaa mahdollista Windowsin uudelleenasennusta tai muuta vianselvittely\u00e4 varten.</p>"},{"location":"asennus/dualboot/#esivaatimukset","title":"Esivaatimukset","text":"<ul> <li>Toinen tietokone. Saatat joutua etsim\u00e4\u00e4n ohjeita tai apua kesken asennuksen. Voi esimerkiksi k\u00e4yd\u00e4 siten, ett\u00e4 Wifi-adapterisi ajurit eiv\u00e4t asennu ongelmitta, joten et p\u00e4\u00e4se Internetiin Ubuntusta k\u00e4sin. Vianselvityksess\u00e4 auttaa, mik\u00e4li sinulla on toinen tietokone.</li> <li>K\u00e4rsiv\u00e4llisyytt\u00e4. Varaudu siihen, ett\u00e4 asennukseen menee v\u00e4hint\u00e4\u00e4n tunti, vaikka kaikki menisi kerralla nappiin. </li> <li>Tyhj\u00e4 USB-tikku. Kokoa tulisi olla v\u00e4hint\u00e4\u00e4n 8 GB. Vaihtoehtoisesti my\u00f6s Compact Flash -kortit ja vastaavat saattavat toimia, mik\u00e4li koneessasi on kortinlukija.</li> <li>Varmuuskopio kaikesta. Sinulla tulee olla (henkinen) valmius siihen, ett\u00e4 saatat joutua asentamaan Windowsin uusiksi, jos pahin katastrofi iskee.</li> <li>Tilaa asennusta varten. Valitse seuraavista asennusvaihtoehdoista yksi:<ul> <li>Option A: C-asemalla (tai vastaavalla) on ylim\u00e4\u00e4r\u00e4ist\u00e4 tilaa josta voit luopua.</li> <li>Option B: Sinulla on ylim\u00e4\u00e4r\u00e4inen, k\u00e4ytt\u00e4m\u00e4t\u00f6n SSD-levy, jonka voit luovuttaa Ubuntun k\u00e4ytt\u00f6\u00f6n.</li> </ul> </li> </ul> Lis\u00e4ksi mielell\u00e4\u00e4n my\u00f6s ... <ul> <li>Emolevyn ohjekirja. Saatat joutua piipahtaa UEFI-asetuksissa ja/tai vaihtaa boot-j\u00e4rjestyst\u00e4. T\u00e4t\u00e4 varten sinun tulee selvitt\u00e4\u00e4, mik\u00e4 pikan\u00e4pp\u00e4in sinun j\u00e4rjestelm\u00e4ss\u00e4si toimii.</li> <li>Microsoft Account -tunnukset. Secure Boot ja/tai BitLocker saattaa huolestua asennusprosessista. Jos saat t\u00e4h\u00e4n liittyv\u00e4n varoitusruudun, \u00e4l\u00e4 painokoi. Noudata ruudulla n\u00e4kyvi\u00e4 ohjeita. Saatat joutua esimerkiksi kirjautumaan Microsoft Accountiin ja n\u00e4pyttelem\u00e4\u00e4n ruudulla n\u00e4kyvi\u00e4 koodeja palveluun.</li> <li>Muistiinpanov\u00e4lineet. Kannattaa dokumentoida kaikki tekem\u00e4si vaiheet. Ota kuvia ja/tai kirjoita memoa. T\u00e4st\u00e4 voi olla apua mahdollisessa vianselvityksess\u00e4.</li> <li>Verkkokaapeli. Mik\u00e4li koneessasi on tavallinen Ethernet-portti, saattaa verkkokaapeli osoittautua hy\u00f6dylliseksi, mik\u00e4li sinulla on ongelmia Wifi-adapterin ajureiden kanssa.</li> </ul>"},{"location":"asennus/dualboot/#lyhyt-ohje","title":"Lyhyt ohje","text":""},{"location":"asennus/dualboot/#ohjeet-tueksi","title":"Ohjeet tueksi","text":"<p>Mik\u00e4li seuraat t\u00e4t\u00e4 lyhytt\u00e4, kuvatonta ohjetta, voi olla hy\u00f6dyksi kurkata videolta, milt\u00e4 vaiheet varsinaisesti n\u00e4ytt\u00e4v\u00e4t. Video-ohjeessa ei n\u00e4ytet\u00e4 Fast Boot -vaihetta, mutta se on selitettyn\u00e4 my\u00f6hemmin vaihe-vaiheelta ohjeissa.</p> <p>Video-ohje ilman Fast Boot -asetuksen disablointia: How to Dual Boot Ubuntu 24.04 LTS and Windows 10 / 11</p>"},{"location":"asennus/dualboot/#vaiheet-1-5","title":"Vaiheet 1-5","text":"<p>Vaiheet 1-5 auttavat sinua p\u00e4\u00e4sem\u00e4\u00e4n Ubuntu Installeriin. My\u00f6hemm\u00e4t vaiheet ovat samat kuin Ubuntua virtuaalikoneelle asennettaessa - pois lukien vaihe, jossa valitaan \"Install Ubuntu alongside Windows Boot Manager\". N\u00e4ist\u00e4 l\u00f6ytyy kuvallinen ohje t\u00e4m\u00e4n sivun lopusta.</p> <ol> <li> <p>Lataa Ubuntu 24.04 LTS amd64 ISO-image Download Ubuntu Desktop -sivulta (6 GB).</p> </li> <li> <p>Polta ISO-image USB-tikulle. T\u00e4m\u00e4 hoituu helposti Etcher-sovelluksella: Balena Etcher. HUOM! Kaikki tikulla oleva data katoaa. Varmista, ett\u00e4 tikulla ei ole t\u00e4rkeit\u00e4 tiedostoja.</p> </li> <li> <p>Valmistele osio. Riippuen mihin asennat:</p> <ol> <li>(Option A:) Pienenn\u00e4 (engl. shrink) valitsemaasi NTFS-osiota noudattaen Windows Disk Managementill\u00e4 (hotkey: Windows + X ja sitten K). N\u00e4in kiintolevylle vapautuu osioimatonta tilaa. Arvioi oma tilantarpeesi: riittt\u00e4\u00e4k\u00f6 200 GB?</li> <li>(Option B:) Asenna tai identifioi hy\u00f6dynt\u00e4m\u00e4t\u00f6n SSD-asema. Poista mahdolliset osiot Windows Disk Managementill\u00e4 tai my\u00f6hemmin Ubuntun asennusohjelmalla.</li> </ol> </li> <li> <p>Kytke Fast Boot pois p\u00e4\u00e4lt\u00e4. Asennus saattaa toimia ilman t\u00e4t\u00e4 steppi\u00e4, mutta kenell\u00e4p\u00e4 el\u00e4m\u00e4ss\u00e4 niin kiire olisi, ett\u00e4 Fast Boot pit\u00e4\u00e4 olla p\u00e4\u00e4ll\u00e4. Mene Control Panel, klikkaa katerogian otsikkoa Hardware and Sound, klikkaa Power Options. Valitse vasemmasta menusta Choose what the power buttons do. Klikkaa admin-oikeuksia vaativaa Change settings that are currently unavailable nappia. Nyt voit ottaa ruksin pois fast startupista.</p> <p>Huom!</p> <p>Sammuta kone. Huomaa, ett\u00e4 Fast Boot kytkeytyy p\u00e4\u00e4lle \"after shutdown\". Sammuta kone kokonaan. Ei siis Restart vaan Shutdown.</p> </li> <li> <p>K\u00e4ynnist\u00e4 USB-tikulta. T\u00e4h\u00e4n on monta tapaa, mutta me noudatamme Windowsin menujen kautta Windows Recovery Environmentiin menoa. Avaa Settings (Windows + x, sitten n), valitse vasemmalta System ja avautuvasta listasta Recovery. Klikkaa Advanced startup -kohdasta Restart now. P\u00e4\u00e4set Windows Recovery Environmentiin. Jos luomasi USB-tikku ei ole USB-portissa, laita se USB-porttiin. Valitse Use a Device. Valitse USB-tikkusi listalta.</p> </li> </ol>"},{"location":"asennus/dualboot/#vian-selvitys","title":"Vian selvitys","text":"<p>Etk\u00f6 p\u00e4\u00e4ssyt Ubuntu Installeriin asti? Alla olevassa laatikossa on pari vaihtoehtoa vian selvitykseen. Huomaa, ett\u00e4 Linuxia opetellessa omatoimisuus on valttia. Jos et p\u00e4\u00e4se eteenp\u00e4in, kysy rohkeasti apua kanssaopiskelijoilta, k\u00e4yt\u00e4 hakukonetta ja k\u00e4yt\u00e4 jopa ChatGPT:t\u00e4 tai vastaavaa kielimallia apuna. Muista dokumentoida kaikki kokeilemasi korjausyritykset.</p> Vian selvitys <p>Mahdollisia vikakorjauksia t\u00e4m\u00e4n j\u00e4lkeen ovat esimerkiksi:</p> <p>Kone k\u00e4ynnistyy v\u00e4kisin Windowsiin? </p> <p>Jos Ubuntu ei k\u00e4ynnisty USB-tikulta, eli et p\u00e4\u00e4se GRUB-menuun valitsemaan \"Try or install Ubuntu\" vaan kone k\u00e4ynnistyy Windowsiin, niin k\u00e4ynnist\u00e4 kone uusiksi tavallisesti. Kun UEFI-menut vilisev\u00e4t ruudulla, noudata emolevysi ohjekirjan tai ruudulla n\u00e4kyvien neuvojen ohjetta p\u00e4\u00e4st\u00e4ksesi Boot Menuun. Yleens\u00e4 t\u00e4m\u00e4 vaatii F2, F10, F12, Del tai jonkin muun n\u00e4pp\u00e4imen painamista l\u00e4hes v\u00e4litt\u00f6m\u00e4sti koneen k\u00e4ynnistymisen j\u00e4lkeen. </p> <p>Mik\u00e4li F2 ja muut n\u00e4pp\u00e4imet eiv\u00e4t p\u00e4\u00e4st\u00e4 sinua UEFI-menuun, voit navigoida sinne Windowsin kautta. Mene Windows Recovery Environmentiin (kuten vaiheessa 5) ja valitse Troubleshoot =&gt; Advanced Options =&gt; UEFI Firmware Settings =&gt; Restart.</p> <p>Kun olet p\u00e4\u00e4ssyt UEFI-menuun, etsi \"Boot order\". Vaihda USB-tikku ensimm\u00e4iseksi. Tallenna ja poistu. Koneesi pit\u00e4isi nyt k\u00e4ynnisty\u00e4 USB-tikulta. Tarvittaessa lue emolevysi ohjekirjasta lis\u00e4\u00e4. UEFI-menu on emolevyst\u00e4 riippuen erilainen.</p> <p>Secure Boot vastustaa? </p> <p>Jos saat \"The Secure Boot key you've entered is not valid.\"-tyylisi\u00e4 valituksia ja Ubuntu-asennus keskeytyy, mahdollisia korjauksia ovat:</p> <ul> <li> <p>Ehdotus 1: Valitse Ubuntun asennuksessa, ett\u00e4 \u00e4l\u00e4 asenna kolmannen osapuolen ajureita. Asenna n\u00e4m\u00e4 my\u00f6hemmin itse.</p> </li> <li> <p>Ehdotus 2: Kytke UEFI:n Secure Boot esimerkiksi \"Other OS\"-tilaan, jos vakiona on Windows.</p> </li> <li> <p>Ehdotus 3: Kytke Secure Boot pois p\u00e4\u00e4lt\u00e4 UEFI-menusta. Asenna Ubuntu. T\u00e4m\u00e4n j\u00e4lkeen sinun tulisi voida kytke\u00e4 Secure Boot takaisin.</p> </li> </ul> <p>Bitlocker vastustaa. </p> <p>Jos saat Bitlocker-avaimen kyselyit\u00e4, noudata ruudulla n\u00e4kyvi\u00e4 ohjeita. Saatat joutua kirjautumaan Microsoft Accountiin ja n\u00e4pyttelem\u00e4\u00e4n ruudulla n\u00e4kyvi\u00e4 koodeja palveluun. Ubuntun dokumentaatiosta l\u00f6ytyy my\u00f6s ohjeita t\u00e4h\u00e4n: (Additional) Installing Ubuntu alongside Windows with BitLocker</p> <p>Intel RST (RAID)</p> <p>Intel Rapid Storage Technology tai muut RAID-tekniikat saattavat aiheuttaa ongelmia Ubuntun asennuksessa. Jos saat virheilmoituksia, selvit\u00e4 ohjeiden avulla, kuinka saat AHCI-ajurit k\u00e4ytt\u00f6\u00f6n rikkomatta Windows-asennustasi. Yksi vanhahko ohje on SOLUTION: Switch Windows 10 from RAID/IDE to AHCI operation, mutta se voi hyvin olla yh\u00e4 p\u00e4tev\u00e4. Muistathan varmuuskopioida t\u00e4rke\u00e4t tiedostosi ennen kuin ryhdyt muuttamaan asetuksia - ja muistathan ett\u00e4 kannat vastuun mahdollisista seuraamuksista. </p>"},{"location":"asennus/dualboot/#seuraavat-vaiheet","title":"Seuraavat vaiheet?","text":"<p>Olettaen, ett\u00e4 p\u00e4\u00e4sit nyt Live-CD:lt\u00e4 ajettavaan Ubuntuun, sinulla py\u00f6rii nyt Ubuntu keskusmuistissa! Haluamme kuitenkin asentaa sen kiintolevylle pysyv\u00e4sti. Asennuksen pit\u00e4isi k\u00e4ynnisty\u00e4 itsest\u00e4\u00e4n. Jos ei, klikkaa \"Install Ubuntu\"-pikakuvaketta ruudun oikeassa alalaidassa. Nyt voit noudattaa samoja ohjeita kuin Ubuntua virtuaalikoneelle asennettaessa. Noudata ruudulla n\u00e4kyvi\u00e4 ohjeita.</p> <p>Jos tarvitset ohjeistusta, lue alempaa Vaihe 6 ja eteenp\u00e4in.</p>"},{"location":"asennus/dualboot/#pitka-kuvallinen-ohje","title":"Pitk\u00e4 kuvallinen ohje","text":"<p>Mik\u00e4li haluat yll\u00e4 olevan ohjeen tueksi kuvia, pl\u00e4r\u00e4ile my\u00f6s t\u00e4m\u00e4 ohje l\u00e4pi. Huomaa, ett\u00e4 vaiheet ovat hyvin samoja kuin yll\u00e4 linkitetyss\u00e4 Youtube-videossa. T\u00e4ss\u00e4 ohjeessa k\u00e4ytet\u00e4\u00e4n C-aseman kutistamista. Mik\u00e4li asennat erilliselle SSD-levylle, j\u00e4t\u00e4 turhat vaiheet (kuten osion kutistaminen) v\u00e4liin.</p>"},{"location":"asennus/dualboot/#vaihe-1-lataa-ubuntu","title":"Vaihe 1: Lataa Ubuntu","text":"<p>Mene Ubuntu.com -sivulle ja lataa Ubuntu 24.04 LTS. Valitse 64-bit versiona. Lataus on noin 6 GB.</p>"},{"location":"asennus/dualboot/#vaihe-2-polta-iso-image-usb-tikulle","title":"Vaihe 2: Polta ISO-image USB-tikulle","text":"<p>Lataa Balena Etcher ja polta Ubuntu ISO-image USB-tikulle. Huomaa, ett\u00e4 kaikki tikulla oleva data katoaa. Varmista, ett\u00e4 tikulla ei ole t\u00e4rkeit\u00e4 tiedostoja.</p> <p></p> <p>Kuvio 1: Balena Etcherin k\u00e4ytt\u00f6liittym\u00e4. Tarkista huolella, ett\u00e4 valittu USB Device on oikea. Kuvan asennuksessa se on toista kymment\u00e4 vuotta vanha Kingston DataTraveler 2.0 kokoa 8 GB.</p>"},{"location":"asennus/dualboot/#vaihe-3-valmistele-osio","title":"Vaihe 3: Valmistele osio","text":"<p>Kutista C-asema Windows Disk Managementill\u00e4. Klikkaa aloitusmenun Windows-ikonia hiiren oikealla korvalla (tai hotkey Win+X) ja valitse \"Disk Management\". Klikkaa hiiren oikealla C-asemaa ja valitse \"Shrink Volume\".</p> <p></p> <p>Kuvio 2: Disk Managementin kutistus-toiminto l\u00f6ytyy Disk Managementin kontekstivalikosta.</p> <p></p> <p>Kuvio 3: Valitse kuinka paljon haluat kutistaa C-asemaa. Kuvassa 974485 Mt osio on jaettu kahteen suunnilleen yht\u00e4 suureen osioon: 487,243 MB eli noin 476 GB.</p> <p></p> <p>Kuvio 4: Disk Managementin n\u00e4kym\u00e4 kutistuksen j\u00e4lkeen. Huomaa, ett\u00e4 kutistettu osio on \"Unallocated\". Kyseist\u00e4 tilaa ei voi k\u00e4ytt\u00e4\u00e4 ennen kuin se on osioitu, jolloin se formatoidaan esimerkiksi ext4-tiedostoj\u00e4rjestelm\u00e4ll\u00e4 (tai NTFS Windowsin k\u00e4ytt\u00f6\u00f6n).</p> <p></p> <p>Kuvio 5: Windows saattaa varoittaa, ett\u00e4 osio on formatoitava ennen k\u00e4ytt\u00f6\u00e4. T\u00e4m\u00e4 on normaalia. Klikkaa \"Cancel\" tai \"OK\" valituksesta riippuen.</p>"},{"location":"asennus/dualboot/#vaihe-4-kytke-fast-boot-pois-paalta","title":"Vaihe 4: Kytke Fast Boot pois p\u00e4\u00e4lt\u00e4","text":"<p>Fast Boot nopeuttaa Windowsin k\u00e4ynnistymist\u00e4, mutta aiheuttaa mit\u00e4 todenn\u00e4k\u00f6isemmin ongelmia Ubuntun asennuksessa. Mene Control Panel, klikkaa katerogian otsikkoa Hardware and Sound, klikkaa Power Options. Valitse vasemmasta menusta Choose what the power buttons do. Klikkaa admin-oikeuksia vaativaa Change settings that are currently unavailable nappia. Nyt voit ottaa ruksin pois fast startupista.</p> <p></p> <p>Kuvio 6: Fast Bootin poiskytkeminen Windowsin asetuksista.</p> <p>HUOM!</p> <p>Fast Boot kytkeytyy p\u00e4\u00e4lle \"after shutdown\". Sammuta kone kokonaan. Ei siis Restart vaan Shutdown.</p>"},{"location":"asennus/dualboot/#vaihe-5-kaynnista-usb-tikulta","title":"Vaihe 5: K\u00e4ynnist\u00e4 USB-tikulta","text":"<p>Kun k\u00e4ytt\u00f6j\u00e4rjestelm\u00e4si on k\u00e4ynnistynyt uudelleen, mene Windows Recovery Environmentiin. Avaa Settings (Win+X), valitse vasemmalta System ja avautuvasta listasta Recovery. Klikkaa Advanced startup -kohdasta Restart now. P\u00e4\u00e4set Windows Recovery Environmentiin. Jos luomasi USB-tikku ei ole USB-portissa, laita se USB-porttiin. Valitse Use a Device. Valitse USB-tikkusi listalta.</p> <p></p> <p>Kuvio 7: Kuvassa n\u00e4kyy pop-up, joka avautuu, kun valitset \"Advanced startup\"-kohdasta \"Restart now\".</p> <p>T\u00e4ss\u00e4 v\u00e4liss\u00e4 tietokoneesi k\u00e4ynnistyy uudestaan ja p\u00e4\u00e4dyt Windows Recovery Environmentiin. Valitse Use a Device ja valitse USB-tikku.</p> <p></p> <p>Kuvio 8: Kuvassa n\u00e4kyy Windows Recovery Environmentin \"Use a Device\" kursorin alla. Valitse t\u00e4m\u00e4.</p> <p></p> <p>Kuvio 9: Valitse USB-tikku, johon poltit Ubuntun.</p>"},{"location":"asennus/dualboot/#vaihe-6-kaynnista-live-cd","title":"Vaihe 6: K\u00e4ynnist\u00e4 Live-CD","text":"<p>Kun tietokoneesi k\u00e4ynnistyy tikulta, sinulle pit\u00e4isi avautua GBU GRUB Multiboot loader. UEFI on siirt\u00e4nyt nyt vastuun k\u00e4ynnistyksest\u00e4 GRUB:lle. Valitse \"Try or Install Ubuntu\". T\u00e4m\u00e4 k\u00e4ynnist\u00e4\u00e4 Ubuntu Live-CD:n, joka on ei-persistentti Ubuntu-asennus. T\u00e4m\u00e4 tarkoittaa, ett\u00e4 kaikki muutokset katoavat, kun sammutat koneen. T\u00e4t\u00e4 k\u00e4ytet\u00e4\u00e4n Linuxin asentamiseen pysyv\u00e4sti SSD-levyllesi; jatkossa k\u00e4ynnist\u00e4t koneesi suoraan SSD-levylt\u00e4, mihin asentuu GRUB bootloader sek\u00e4 itse Ubuntu.</p> <p></p> <p>Kuvio 10: GRUB Boot Menu. Valitse \"Try or Install Ubuntu\".</p> <p>Question</p> <p>Mik\u00e4li et p\u00e4\u00e4se t\u00e4h\u00e4n vaiheeseen, katso vianselvitysohjeet ylemp\u00e4\u00e4: Vian selvitys.</p> <p>Tip</p> <p>Jos sinulla on joskus ongelmia Linuxin kanssa, voit aina k\u00e4ynnist\u00e4\u00e4 Live-CD:n ja k\u00e4ytt\u00e4\u00e4 sit\u00e4 apuna ongelmanratkaisussa. T\u00e4m\u00e4 auttaa esimerkiksi niiss\u00e4 tilanteissa, ett\u00e4 olet vahingossa sotknut <code>/etc/fstab</code>-tiedoston tai GRUB-konfiguraation <code>/boot/grub/grub.cfg</code>.</p>"},{"location":"asennus/dualboot/#vaihe-7-asenna-ubuntu","title":"Vaihe 7: Asenna Ubuntu","text":"<p>Kun olet p\u00e4\u00e4ssyt Ubuntu Live-CD:lle, klikkaa \"Install Ubuntu\" -pikakuvaketta, mik\u00e4li asennus ei k\u00e4ynnisty automaattisesti. Asennusohjelma saattaa my\u00f6s tarjota p\u00e4ivityst\u00e4 itselleen (eli siis asennusohjelma lataa itsest\u00e4\u00e4n uuden version.) Jos n\u00e4in k\u00e4y, asennusohjelma sammuu ja sinun tulee tuplaklikata \"Install Ubuntu\" -pikakuvaketta uudelleen.</p> <p>Alla on tyypilliset asennuksen valinnat vaihe vaiheelta. Mik\u00e4li haluat n\u00e4hd\u00e4 kuvat kaikista vaiheista, voit seurata Ubuntun omaa asennusohjetta alkaen vaiheesta 4. Boot from USB flash drive.</p> <ul> <li>Choose your language<ul> <li>Valitse: English</li> </ul> </li> <li>Accessibility in Ubuntu<ul> <li>Klikkaa: Next (paitsi jos tarvitset ko. ominaisuuksia)</li> </ul> </li> <li>Select your keyboard layout<ul> <li>Valitse: Finnish</li> <li>Testaa alla olevassa kent\u00e4ss\u00e4 ett\u00e4 \u00e4\u00e4kk\u00f6set toimivat.</li> </ul> </li> <li> <p>Connect to the internet</p> <ul> <li>Suositus: Kytke verkkokaapeli kiinni. Valitse Use wired connection.</li> <li>Vaihtoehto: K\u00e4yt\u00e4 wifi\u00e4.</li> </ul> <p>Note</p> <p>Riippuen wifi-adapterista saatat joutua s\u00e4\u00e4t\u00e4m\u00e4\u00e4n ajureiden kanssa. Hyv\u00e4ss\u00e4 lykyss\u00e4 Ubuntun kernel tukee adapteriasi suoraan. Jos ei, valmistaudu etsim\u00e4\u00e4n ohjeita netist\u00e4. T\u00e4m\u00e4 on yksi niist\u00e4 tilanteista, jossa toinen tietokone on hy\u00f6dyllinen.</p> </li> <li> <p>What do you want to do with Ubuntu?</p> <ul> <li>Valitse: Install Ubuntu</li> </ul> </li> <li>How would you like to install Ubuntu?<ul> <li>Valitse: Interactive Installation</li> </ul> </li> <li>What apps would you like to install to start with?<ul> <li>Valitse: Default selection</li> </ul> </li> <li>Install recommanded proprietary software?<ul> <li>Ruksaa p\u00e4\u00e4lle: Install third-party software for graphics and Wi-Fi hardware</li> </ul> </li> <li> <p>How do you want to install Ubuntu?</p> <ul> <li>Valitse: Install Ubuntu alongside Windows Boot Manager.</li> </ul> <p></p> <p>Kuvio 11: Valitse \"Install Ubuntu alongside Windows Boot Manager\".</p> <p>Warning</p> <p>\u00c4l\u00e4 valitse \"Erase disk and install Ubuntu\". T\u00e4m\u00e4 tuhoaa kaiken Windowsin datan. Sen sijaan \"Manual installation\" voi olla hyv\u00e4 valinta, jos haluat tarkemmin m\u00e4\u00e4ritell\u00e4 osiot. T\u00e4m\u00e4 on kuitenkin edistyneempi vaihtoehto eik\u00e4 pit\u00e4isi olla tarpeen, mik\u00e4li luet t\u00e4t\u00e4 ohjetta.</p> </li> <li> <p>Create your account</p> <ul> <li>Your Name: Etunimi Sukunimi</li> <li>Your computer's name: Valitse jokin nimi koneellesi tai luota generoituun nimeen.</li> <li>Your username: [a-z] ja [0-9] -merkkej\u00e4, esim. sukunimesi pienell\u00e4.<ul> <li>Esimerkiksi: <code>sourander</code></li> </ul> </li> <li> <p>Choose a password: Valitse vahva salasana.</p> <ul> <li>Password: Kirjoita salasana uudelleen.</li> <li>Ruksaa p\u00e4\u00e4lle: Require my password to log in</li> </ul> <p>Hyv\u00e4 salasana</p> <p>Hyv\u00e4 salasana on pitk\u00e4, vaikeasti arvattava ja sis\u00e4lt\u00e4\u00e4 erikoismerkkej\u00e4 - mutta kuitenkin kohtalaisen helppo kirjoittaa. Joudut kirjoittaa salasanaa aika-ajoin uudestaan: aina sis\u00e4\u00e4nkirjautuessa ja silloin t\u00e4ll\u00f6in ajaessasi <code>sudo</code>-komentoja.</p> <p>Warning</p> <p>Eth\u00e4n unohda salasanaasi! Laita se talteen salasananhallintaohjelmaan tai muuhun turvalliseen paikkaan.</p> </li> </ul> </li> <li> <p>Choose your Location</p> <ul> <li>Location: Helsinki tai vaikka Kajaani</li> <li>Timezone: Europe/Helsinki</li> </ul> </li> <li>Review your choices<ul> <li>Tarkista asetukset.</li> <li>Klikkaa: Install</li> </ul> </li> </ul>"},{"location":"asennus/dualboot/#vaihe-8-kaynnista-kone-uudelleen","title":"Vaihe 8: K\u00e4ynnist\u00e4 kone uudelleen","text":"<p>Kun asennus on valmis, se tarjoaa mahdollisuutta k\u00e4ynnist\u00e4\u00e4 kone uudelleen. Klikkaa \"Restart Now\". Kun kone k\u00e4ynnistyy uudelleen, sinua pyydet\u00e4\u00e4n irrottamaan asennusmedia. Irrota USB-tikku ja paina Enter.</p> <p></p> <p>Kuvio 12: Irrota asennusmedia ja paina Enter.</p> <p>Kirjaudu Ubuntuun sis\u00e4\u00e4n k\u00e4ytt\u00e4en juuri luomaasi k\u00e4ytt\u00e4j\u00e4tunnusta ja salasanaa. Onnea, olet nyt asentanut Ubuntu 24.04 LTS:n Windowsin rinnalle!</p>"},{"location":"asennus/dualboot/#vaihe-9-kokeile-ubuntuun-ja-windowsiin-kaynnistysta","title":"Vaihe 9: Kokeile Ubuntuun ja Windowsiin k\u00e4ynnistyst\u00e4","text":"<p>Varmista viel\u00e4, ett\u00e4 p\u00e4\u00e4set yh\u00e4 Windowsiin. Kun sammutat ja k\u00e4ynnist\u00e4t koneesi uudestaan, sinulle pit\u00e4isi avautua GRUB-valikko, jossa voit valita k\u00e4ynnistet\u00e4\u00e4nk\u00f6 Ubuntu vai Windows (eli Windows Boot Manager). K\u00e4ynnist\u00e4 kone toistamiseen uusiksi ja kokeile, ett\u00e4 p\u00e4\u00e4set kumpaankin k\u00e4ytt\u00f6j\u00e4rjestelm\u00e4\u00e4n.</p> <p>GRUB-menu k\u00e4ynnistyy olettaen ett\u00e4 se on UEFI-asetuksissa ensimm\u00e4isen\u00e4 boot-optiona. Mik\u00e4li GRUB-menu ei avaudu, sinun tulee menn\u00e4 UEFI-asetuksiin ja valita GRUB bootloader ensimm\u00e4iseksi. UEFI-menuun p\u00e4\u00e4seminen on neuvottu aiemmin vaiheessa 5.</p> <p></p> <p>Kuvio 13: UEFI Boot Order. Valitse GRUB bootloader ensimm\u00e4iseksi. Huomaa, ett\u00e4 UEFI-menu on erilainen jokaisessa emolevyss\u00e4. Sinun n\u00e4kym\u00e4si voi poiketa t\u00e4st\u00e4 kuvasta hyvinkin merkitt\u00e4v\u00e4ll\u00e4 tavalla.</p>"},{"location":"asennus/dualboot/#kuinka-paasta-eroon-ubuntusta","title":"Kuinka p\u00e4\u00e4st\u00e4 eroon Ubuntusta?","text":"<p>Jos haluat joskus luopua dual bootista, vaiheet ovat hyvin tiivistetysti seuraavat:</p> <ol> <li>Vaihda UEFI-asetuksista Windowsin boot-j\u00e4rjestys ensimm\u00e4iseksi (ks. Kuvio 13).</li> <li>Kirjaudu Windowsiin.</li> <li>Poista Ubuntun luomat osiot Windows Disk Managementill\u00e4.</li> <li>Laajenna (engl. extend) Windowsin osio takaisin alkuper\u00e4iseen kokoon.</li> <li>Siirry Windows Recovery Environmentiin ja k\u00e4ynnist\u00e4 sielt\u00e4 Command Prompt.</li> <li>Kirjoita luotettavasta ohjeesta l\u00f6yt\u00e4m\u00e4si komennot ja paina Enter.</li> </ol> <p>Mik\u00e4 sitten on luotettava ohje kohdan 6 komentoihin? Esimerkiksi Microsoftin tai jonkin tietokonevalmistajan ohje. Esimerkkin\u00e4 olkoon Dellin How to Repair the EFI Bootloader on a GPT Hard Drive for Windows Operating Systems on your Dell Computer. Teeth\u00e4n kuitenkin oman tutkimusty\u00f6si ennen n\u00e4iden tiiviiden ohjeiden noudattamista. Etsi tuore, luotettava ohje.</p> <p>Jos vaiheet 5-6 eiv\u00e4t onnistu, tarvitset Windowsin asennusmedian (eli USB-tikun jolle on poltettu Windowsin asennusmedia). K\u00e4ynnist\u00e4 kone Windowsin asennusmedialta ja etsi menuista \"Command prompt\". Aja komento kohdasta 6.</p> <p>\u00c4\u00e4rimm\u00e4isempi vaihtoehto on vet\u00e4\u00e4 koko levy sile\u00e4ksi ja asentaa Windows uusiksi. T\u00e4m\u00e4 onnistuu Windows-asennusmedian avulla.</p>"},{"location":"asennus/opiskelukuntoon/","title":"Lopuksi: Ubuntu opiskelukuntoon","text":"<p>Warning</p> <p>T\u00e4m\u00e4 ohje on t\u00e4ll\u00e4 hetkell\u00e4 aikansa n\u00e4hnyt. Tilalle tulee yksinkertaisempi ohje, jossa on k\u00e4yt\u00f6ss\u00e4 Dockerilla ajettu uv, joka pohjustaa cookiecutterin.</p> <p>Lis\u00e4ksi Ubuntu 24.04 vaihtuu 26.04:\u00e4\u00e4n.</p> <p>T\u00e4m\u00e4n ohjeen tarkoitus on auttaa sinua pika-asentamaan tarvittavat ohjelmat siten, ett\u00e4 voit ty\u00f6st\u00e4\u00e4 oppimisp\u00e4iv\u00e4kirjaa Linuxista k\u00e4sin. Pohjaoletus on, ett\u00e4 sinulla on Ubuntu jo asennettuna. Mik\u00e4li sinulla ei ole aiempaa Linux-kokemusta, ohjeen komennot saattavat tuntua osittain heprealta. Kannattaa palata t\u00e4h\u00e4n materiaaliin kurssin lopuksi: todenn\u00e4k\u00f6isesti huomaat, ett\u00e4 ohjeissa ei ole mit\u00e4\u00e4n, mit\u00e4 et osaisi tehd\u00e4 itsen\u00e4isesti, ohjelmien omia dokumentaatioita seuraamalla.</p>"},{"location":"asennus/opiskelukuntoon/#video-ohjeet","title":"Video-ohjeet","text":"<p>Video 1: Linux Perusteet 2025 kurssin ohjelmien asennusohjeet.</p> <p>Yll\u00e4 on upotettuna Youtube-video, jossa freesiin Ubuntu-asennukseen suoritetaan kaikki t\u00e4m\u00e4n ohjeen merkitt\u00e4v\u00e4t vaiheet. Alla on tekstimuodossa l\u00e4hes identtiset vaiheet sis\u00e4lt\u00e4v\u00e4 ohje. Voit valita, kumpaa haluat seurata - tai tutustutko kumpaankin.</p> <p>Warning</p> <p>Huomaa, ett\u00e4 videon kohdasta \"Docker Engine\" j\u00e4i uupumaan Rootless Moden asennus. Se paikataan hieman my\u00f6hemmin ajassa 27 minuuttia. Eroa kirjoitettuun ohjeeseen on my\u00f6s siin\u00e4, ett\u00e4 ensimm\u00e4ist\u00e4 oppimisp\u00e4iv\u00e4kirjaa ei koskaan kirjoiteta, eik\u00e4 sis\u00e4lt\u00f6\u00e4 pusketa my\u00f6sk\u00e4\u00e4n Gitlabiin.</p>"},{"location":"asennus/opiskelukuntoon/#tekstiohjeet","title":"Tekstiohjeet","text":""},{"location":"asennus/opiskelukuntoon/#vaihe-1-git","title":"Vaihe 1: Git","text":"<p>Avaa Terminal (gnome-terminal) eli pseudoterminaali. T\u00e4m\u00e4 onnistuu monella eri tavalla:</p> <ul> <li>Pikan\u00e4pp\u00e4in Ctrl+Alt+T</li> <li>Hiiren oikealla korvalla ty\u00f6p\u00f6yd\u00e4n tyhj\u00e4ll\u00e4 alueella ja valitsemalla \"Open Terminal\"</li> <li>Klikkaa Win -n\u00e4pp\u00e4int\u00e4 ja kirjoita hakukentt\u00e4\u00e4n \"Terminal\" ja paina enter.</li> <li>Avaa ruudun vasemmasta alalaidasta \"Show Apps\" ja kirjoita hakukentt\u00e4\u00e4n \"Terminal\" ja paina enter.</li> </ul> <p>Kun Terminal on auki, aja seuraavat komennot, joskin siten, ett\u00e4 korvaat oikeisiin paikkoihin oman nimesi ja oman s\u00e4hk\u00f6postiosoitteesi:</p> Bash<pre><code># Upgrade software and install git\n$ sudo apt update &amp;&amp; sudo apt upgrade\n$ sudo apt install git\n\n# Set git configuration\n$ git config --global user.name \"Your Name\"\n$ git config --global user.email \"your.name@kamk.fi\"\n$ git config --global pull.ff only\n$ git config --global init.defaultBranch main\n</code></pre> <p>Warning</p> <p>Eth\u00e4n k\u00e4yt\u00e4 ajamissasi komennoissa <code>$</code>-merkki\u00e4. Se on yll\u00e4 indikoimassa sit\u00e4, ett\u00e4 komentoa ajetaan Bash-konsolissa tavallisella k\u00e4ytt\u00e4j\u00e4ll\u00e4. Se ei ole osa komentoa vaan osa promptia</p>"},{"location":"asennus/opiskelukuntoon/#vaihe-2-luo-avainpari","title":"Vaihe 2: Luo avainpari","text":"<p>Luo avainpari SSH-yhteyksi\u00e4 varten. Aja alla olevat komennot, mutta korvaa taas omat tietosi oikeisiin paikkoihin. Keksi tietokoneellesi jokin alias, jolla tunnistat avaimen. Esimerkiksi \"dell-laptop\" tai \"hp-laptop\" tai \"opiskelulappari\".</p> <p>Komento <code>ssh-keygen</code> kysyy sinulta muutamia kysymyksi\u00e4. Voit j\u00e4tt\u00e4\u00e4 k\u00e4yt\u00e4nn\u00f6ss\u00e4 kaikki tyhjiksi, jolloin se k\u00e4ytt\u00e4\u00e4 vakioasetuksia, mutta passphrase kannattaa asettaa. Muuten olet alttiina sille, ett\u00e4 joku voi esiinty\u00e4 sinuna, mik\u00e4li avain joutuu v\u00e4\u00e4riin k\u00e4siin.</p> Bash<pre><code># Create SSH key pair\n$ ssh-keygen -t ed25519 -C \"your.name@kamk.fi alias-for-computer\"\n\n# Print the public key to terminal (for copying)\n$ cat ~/.ssh/id_ed25519.pub\n</code></pre>"},{"location":"asennus/opiskelukuntoon/#vaihe-3-lisaa-avain-gitlabiin","title":"Vaihe 3: Lis\u00e4\u00e4 avain GitLabiin","text":"<p>Navigoi osoitteeseen: gitlab.dclabra.fi</p> <ol> <li>Kirjaudu sis\u00e4\u00e4n</li> <li>Klikkaa omaa etunimen alkukirjainta vasemmassa yl\u00e4kulmassa</li> <li>Valitse \"Preferences\"</li> <li>Valitse \"SSH Keys\"</li> <li>Paina \"Add SSH Key\"</li> </ol> <p>Liit\u00e4 avain leikep\u00f6yd\u00e4lt\u00e4si ja paina \"Add Key\". Valitse jokin expiraatioaika, esimerkiksi vuoden tai lukuvuoden loppuun asti.</p>"},{"location":"asennus/opiskelukuntoon/#vaihe-4-testaa-yhteys-ja-tallenna-passphrase","title":"Vaihe 4: Testaa yhteys ja tallenna passphrase","text":"<p>T\u00e4m\u00e4n j\u00e4lkeen testaa Terminaalissa yhteys komennolla:</p> Bash<pre><code># Test connection\n$ ssh -T ssh://git@gitlab.dclabra.fi\n</code></pre> <p>Sinulle aukeaa seuraavanlainen pop-up -ikkuna, jossa pyydet\u00e4\u00e4n sy\u00f6tt\u00e4m\u00e4\u00e4n avaimen salasana. Sy\u00f6t\u00e4 valitsemasi passphrase, ruksaa p\u00e4\u00e4lle \"Automatically unlock this key when I'm logged in\" ja paina \"Unlock\".</p> <p></p> <p>Kuvio 1: Avaimen salasanan sy\u00f6tt\u00f6ikkuna.</p>"},{"location":"asennus/opiskelukuntoon/#vaihe-5-asenna-visual-studio-code","title":"Vaihe 5: Asenna Visual Studio Code","text":"<p>Visual Studio Coden voi asentaa useallakin eri tavalla; me asennetaan se App Centerist\u00e4. </p> <ol> <li>Avaa App Center</li> <li>Etsi \"Visual Studio Code\"</li> <li>Asenna se ja avaa se.</li> </ol> <p>Miksi VS Code?</p> <p>K\u00e4yt\u00e4mme Visual Studio Codea oppimisp\u00e4iv\u00e4kirjan kirjoittamiseen. Sit\u00e4 voi kirjoittaa mill\u00e4 tahansa tekstieditorilla, mutta VS Code on sek\u00e4 helppok\u00e4ytt\u00f6inen ett\u00e4 laajasti k\u00e4ytetty.</p>"},{"location":"asennus/opiskelukuntoon/#vaihe-6-asenna-docker-engine","title":"Vaihe 6: Asenna Docker Engine","text":"<p>T\u00e4ss\u00e4 ohjeessa ei asenneta graafista Docker Desktop -ohjelmaa, vaan Docker Engine. Kannattaa noudattaa Dockerin omia, ajan tasalla olevia ohjeita. N\u00e4ist\u00e4 t\u00e4rkeimm\u00e4t ovat Install Docker Engine on Ubuntu ja Run the Docker daemon as a non-root user (Rootless mode).</p> <p>S\u00e4\u00e4st\u00e4mme hieman aikaa ajamalla convenience scriptin, joka ajaa meid\u00e4n puolestamme tarvittavat komennot.</p> Bash<pre><code># Install prerequisites\nsudo apt install curl\n\n# Save the script as get-docker.sh\ncurl -fsSL https://get.docker.com -o get-docker.sh\n\n# Dry-run the script to to see what commands it will run\nsudo sh ./get-docker.sh --dry-run\n</code></pre> <p>Yll\u00e4 ajettu dry run on alalla yleinen termi sille, ett\u00e4 skripti ajetaan siten, ett\u00e4 se tulostaa mit\u00e4 se tekisi, mutta ei tee sit\u00e4. Kyseess\u00e4 on siis simulaatio. On \u00e4\u00e4rimm\u00e4isen suositeltavaa kirjoittaa komennon tuloste oppimisp\u00e4iv\u00e4kirjaasi: voit kurssin aikana tutustua siihen, mit\u00e4 ajetut komennot tekev\u00e4t. Kurssin lopussa sinun tulisi voida t\u00e4ysin ymm\u00e4rt\u00e4\u00e4 jokainen rivi.</p> Bash<pre><code># Run the script\nsudo sh ./get-docker.sh\n\n# Remove the script\nrm get-docker.sh\n</code></pre> <p>Nyt voit testata Dockerin toimivuuden komennolla:</p> Bash<pre><code># Tarkista ett\u00e4 komento l\u00f6ytyy\n# Jos ei, sulje terminaali ja avaa uusi\ndocker --version\n\n# Hello World!\nsudo docker run hello-world\n</code></pre> <p>Warning</p> <p>Huomaa, ett\u00e4 komento vaati \"sudo\"-alun. T\u00e4h\u00e4n l\u00f6ytyy h\u00e4t\u00e4inen fix, joka on lis\u00e4t\u00e4 oma k\u00e4ytt\u00e4j\u00e4 Docker-ryhm\u00e4\u00e4n. Dockerin suosittelema tapa on rootless mode. T\u00e4ll\u00f6in Docker ei vaadi sudo-oikeuksia, mik\u00e4 lis\u00e4\u00e4 j\u00e4rjestelm\u00e4si turvallisuutta, kun ajat tuntemattomia kontteja.</p>"},{"location":"asennus/opiskelukuntoon/#vaihe-7-tee-dockerista-rootless","title":"Vaihe 7: Tee Dockerista Rootless","text":"<p>Aktivoi rootless mode, jotta et jatkossa tarvitse sudo-oikeuksia Docker-konttien ajoon.</p> Bash<pre><code># Install prerequisites\nsudo apt install uidmap\n\n# Disable daemon\nsudo systemctl disable --now docker.service\nsudo systemctl disable --now docker.socket\n\n# Delete socket file\nsudo rm /var/run/docker.sock\n\n# Run a script\ndockerd-rootless-setuptool.sh install\n\n# Add DOCKER_HOST environment variable to startup script\necho \"export DOCKER_HOST=unix:///run/user/${UID}/docker.sock\" &gt;&gt; ~/.bashrc\n\n# Daemon should be enabled and running, but let's make sure\nsystemctl --user enable docker.service\nsystemctl --user start docker.service\n</code></pre> Kuinka peruuttaa t\u00e4m\u00e4? <p>Jos sinulle ilmaantuu syy ajaa Dockeria <code>root</code>-k\u00e4ytt\u00e4j\u00e4n\u00e4 eli Rootful-moodissa \u2013 keksin sanan juuri itse \u2013, voit peruuttaa t\u00e4m\u00e4n vaiheen muutokset alla n\u00e4kyvien komentojen avulla. Mik\u00e4 t\u00e4llainen syy voi olla? Esimerkiksi Dev Containers, Nokia Containerlab tai jokin DevOps-kurssi, jonka olet aloittanut netiss\u00e4, tai jokin muu himmeli, joka vaatii Dockerin ajamista <code>root</code>-k\u00e4ytt\u00e4j\u00e4n\u00e4.</p> Bash<pre><code># Apuskriptill\u00e4 poisto (lue t\u00e4m\u00e4n output: se neuvoo, kuinka voit tuhota halutessasi my\u00f6s datan eli kontit, imaget ja muut)\ndockerd-rootless-setuptool.sh uninstall\n\nnano ~/.bashrc # tai .zshrc tai mik\u00e4 shelli sinulla onkaan\n# Kommentoi seuraavann\u00e4k\u00f6inen rivi pois, jos l\u00f6yd\u00e4t moisen:\n# export DOCKER_HOST=unix:///run/user/${UID}/docker.sock\n\nsudo systemctl enable docker.service\nsudo systemctl enable docker.socket\n\nsudo groupadd docker\nsudo usermod -aG docker $USER\n</code></pre> <p>Lopuksi k\u00e4ynnist\u00e4 kone viel\u00e4 uudelleen. Tarkista, ett\u00e4 <code>echo $DOCKER_HOST</code> ei tulosta mit\u00e4\u00e4n. Jos tulostaa, etsi, miss\u00e4 tiedostossa se on saanut arvonsa. Olettaen ett\u00e4 kyseinen ymp\u00e4rist\u00f6muuttuja on asettamatta, niin jatkossa <code>docker run hello-world</code> on k\u00e4yt\u00e4nn\u00f6ss\u00e4 sama kuin <code>sudo docker run hello-world</code>. Eli Rootful-moodi on k\u00e4yt\u00f6ss\u00e4.</p>"},{"location":"asennus/opiskelukuntoon/#vaihe-8-kloonaa-kurssin-repositorio","title":"Vaihe 8: Kloonaa kurssin repositorio","text":"<p>Jos et ole viel\u00e4 alustanut repositorioosi oppimisp\u00e4iv\u00e4kirjaa, tee se nyt. N\u00e4m\u00e4 vaiheet neuvotaan my\u00f6s Oppimisp\u00e4iv\u00e4kirja 101-sivustolla. Aloita luomalla t\u00e4t\u00e4 kurssia varten oma hakemisto. T\u00e4yt\u00e4 <code>&lt;kurssin-nimi-tahan-2024&gt;</code> oikealla kurssinimell\u00e4, kuten <code>linux-perusteet-2025</code>. N\u00e4et tuon Gitlab-urlin namespacesta, esimerkiksi: <code>https://repo.kamit.fi/linux-perusteet-2025</code></p> <p>Note</p> <p>K\u00e4yt\u00e4 URLia, jonka l\u00f6yd\u00e4t Reppu Moodlesta tai jonka opettaja on sinulle neuvonut. \u00c4l\u00e4 luo omia repositorioita omatoimisesti, sill\u00e4 opettaja luo ne skriptill\u00e4 Moodle-osallistujalistan perusteella. Jos olet hukassa, kysy opettajalta.</p> Bash<pre><code># Create directory for learning diary\nmkdir -p ~/Code/kurssin-nimi-tahan-2025/\n\n# Change directory\ncd ~/Code/kurssin-nimi-tahan-2025/\n</code></pre> <p>Seuraavaksi kloonaa oppimisp\u00e4iv\u00e4kirjasi repositorio. T\u00e4m\u00e4 on helppoa tehd\u00e4 kopioimalla Gitlabin ohjeen tarjoamat komennot. Ohjeet l\u00f6ytyv\u00e4t sinun tyhj\u00e4st\u00e4 repositoriostasi, joka on muotoa: <code>https://repo.kamit.fi/&lt;kurssin-nimi-2024&gt;/&lt;etunimisukunimi&gt;/</code>. Komennot kannattaa ajaa yksitellen, jotta n\u00e4et, jos v\u00e4liss\u00e4 tulee virheit\u00e4. Eth\u00e4n siis kopioi ja liit\u00e4 kaikkia komentoja kerralla.</p> Mist\u00e4 tunnistaa oikeat ohjeet? <p>Oikeat ohjeet l\u00f6ytyv\u00e4t sinun tyhj\u00e4st\u00e4 repositoriostasi. Ne katoavat, kun pusket ensimm\u00e4isen commitin repositorioon. Repositoriossa on kolme eri ohjetta p\u00e4\u00e4llek\u00e4in. Sinun tarvitsemasi on otsikolla Create a new repository eli ylin kolmesta ohjeesta. Alla sen sis\u00e4lt\u00f6, joskin v\u00e4\u00e4r\u00e4n urlin kanssa:</p> Gitlabin komento<pre><code>git clone $CHECK_YOUR_OWN_URL_FROM_GITLAB\ncd etunimisukunimi\ngit switch --create main\ntouch README.md\ngit add README.md\ngit commit -m \"add README\"\ngit push --set-upstream origin main\n</code></pre>"},{"location":"asennus/opiskelukuntoon/#vaihe-9-alusta-oppimispaivakirja","title":"Vaihe 9: Alusta oppimisp\u00e4iv\u00e4kirja","text":"<p>Seuraa ohjeita, jotka l\u00f6ytyv\u00e4t kamk cookiecutters repositorion README.md-tiedostosta. Lyhyt vastaus on, ett\u00e4 aja seuraava komento ja noudata ohjeita:</p> Bash<pre><code>docker run -it --rm \\\n-v \"$(pwd):/workspace\" \\\n-w /workspace \\\nghcr.io/astral-sh/uv:python3.11-bookworm \\\nuvx cookiecutter gh:sourander/kamk-cookiecutters -f\n</code></pre> <p>Tip</p> <p>Liit\u00e4 yll\u00e4 oleva komento leikep\u00f6yd\u00e4lle Code copy button:n avulla, joka on koodisnippetin oikeassa yl\u00e4kulmassa. Se on kuvake, jossa on kaksi paperia p\u00e4\u00e4llekk\u00e4in. N\u00e4in saat komennon kopioitua ilman mahdollisia n\u00e4kym\u00e4tt\u00f6mi\u00e4 merkkej\u00e4 kaikkine kenoviivoineen ja rivivaihtoineen.</p>"},{"location":"asennus/opiskelukuntoon/#vaihe-10-ensimmainen-oppimispaivakirjamerkinta","title":"Vaihe 10: Ensimm\u00e4inen oppimisp\u00e4iv\u00e4kirjamerkint\u00e4","text":"<p>Avaa oppimisp\u00e4iv\u00e4kirja, eli nykyinen kansio, Visual Studio Codessa. T\u00e4m\u00e4 onnistuu helposti komennolla:</p> Bash<pre><code>code .\n</code></pre> <p>T\u00e4m\u00e4n j\u00e4lkeen toimi Visual Studio Codessa, kuten muilla kursseilla on opetettu. Jos et ole k\u00e4ytt\u00e4nyt Visual Studio Codea aiemmin, kannattaa tutustua Oppimisp\u00e4iv\u00e4kirja 101 -sivuston ohjeisiin. Sielt\u00e4 l\u00f6ytyy my\u00f6s videomuotoinen ohje oppimisp\u00e4iv\u00e4kirjan alustamiseen ja merkint\u00f6jen kirjoittamiseen.</p>"},{"location":"asennus/opiskelukuntoon/#vaihe-11-aja-oppimispaivakirja","title":"Vaihe 11: Aja oppimisp\u00e4iv\u00e4kirja","text":"<p>Aja oppimisp\u00e4iv\u00e4kirja komennoilla, jotka neuvotaan <code>HOW-TO-DOCS.md</code>-tiedostossa. T\u00e4m\u00e4 tiedosto l\u00f6ytyy oppimisp\u00e4iv\u00e4kirjasi juuresta. Lyhyt vastaus on, ett\u00e4 aja komento:</p> Bash<pre><code># Run docker compose project\ndocker compose -f docker-compose-docs.yml up -d\n</code></pre> <p>Avaa nettiselain, esimerkiksi Firefox, ja navigoi osoitteeseen <code>http://localhost:8000</code>. Siell\u00e4 pit\u00e4isi olla oppimisp\u00e4iv\u00e4kirjasi.</p>"},{"location":"asennus/opiskelukuntoon/#vaihe-12-muista-versionhallinta","title":"Vaihe 12: Muista versionhallinta!","text":"<p>Kun olet tehnyt ensimm\u00e4isen merkint\u00e4si oppimisp\u00e4iv\u00e4kirjaan, puske muutokset Gitlabiin. T\u00e4m\u00e4 neuvotaan toisilla kursseilla, mutta on lyhyimmill\u00e4\u00e4n:</p> Bash<pre><code>git add .\ngit commit -m \"First learning diary entry\"\ngit push\n</code></pre>"},{"location":"asennus/opiskelukuntoon/#vaihe-13-tarkista-gitlab-pages","title":"Vaihe 13: Tarkista GitLab Pages","text":"<p>K\u00e4y GitLab:n sivuilla sinun repositoriosi GitLab Pages -osiossa. Sielt\u00e4 l\u00f6ytyy linkki sinun oppimisp\u00e4iv\u00e4kirjaasi.</p>"},{"location":"asennus/opiskelukuntoon/#bonus-promptin-muokkaus","title":"Bonus: Promptin muokkaus","text":"<p>Prompt on se osa komentorivin k\u00e4ytt\u00f6liittym\u00e4st\u00e4, joka n\u00e4kyy ennen kuin kirjoitat komennon. Tyypillinen prompt on pitk\u00e4. Se sis\u00e4lt\u00e4\u00e4 muun muassa koko polun nykyiseen hakemistoon. Prompt voi olla siis esimerkiksi muotoa:</p> <pre><code>mattimeikalainen@DELL-XPS-15-MODEL123456:~/Code/linux-perusteet-2025/docs/asennus/opiskelukuntoon.md $\n</code></pre> <p>Voit lyhent\u00e4\u00e4 prompttia muokkaamalla <code>~/.bashrc</code>-tiedostoa. T\u00e4ll\u00f6in yll\u00e4 oleva prompt voisi olla esimerkiksi muotoa:</p> <pre><code>mattimeikalainen:asennus (main) $ \n</code></pre> <p>Prompti m\u00e4\u00e4rittyy <code>PS1</code>-muuttujassa. Sen syntaksi on hieman hirvitt\u00e4v\u00e4, mutta promptin muokkaukseen l\u00f6ytyy paljon valmiita ohjeita netist\u00e4 \u2013 jopa interaktiivisia generaattoreita. Alla on valmis esimerkki, jolla saat yksinkertaisen, mutta informatiivisen promptin, joka n\u00e4ytt\u00e4\u00e4 k\u00e4ytt\u00e4j\u00e4nimen, nykyisen hakemiston nimen ja Git-haaran nimen, mik\u00e4li olet Git-repositoriossa. </p> <ol> <li>Tee varmuuskopio tiedostosta ensin <code>cp ~/.bashrc ~/.bashrc.bak</code>.</li> <li>Avaa tiedosto <code>~/.bashrc</code> Visual Studio Codessa komennolla <code>code ~/.bashrc</code>. </li> <li>Etsi if-lauseke, jossa m\u00e4\u00e4ritell\u00e4\u00e4n <code>PS1</code></li> <li>Korvaa koko if-lauseke alla olevalla koodilla.</li> </ol> .bashrc<pre><code>if [ \"$color_prompt\" = yes ]; then\n    # This is the original. You may comment it out.\n    # PS1='${debian_chroot:+($debian_chroot)}\\[\\033[01;32m\\]\\u@\\h\\[\\033[00m\\]:\\[\\033[01;34m\\]\\w\\[\\033[00m\\]\\$ '\n\n    # This is a naive way to show git branch in prompt\n    # Advanced users may want to use __git_ps1 from git-completion.bash\n    parse_git_branch() {\n        git branch 2&gt;/dev/null | sed -n 's/^\\* \\(.*\\)/ (\\1)/p'\n    }\n\n    green='\\[\\e[32m\\]'\n    blue='\\[\\e[34m\\]'\n    red='\\[\\e[31m\\]'\n    nocolor='\\[\\e[0m\\]'\n    PS1=\"${green}\\u${nocolor}:${blue}\\W${red}\\$(parse_git_branch)${nocolor} \\$ \"\n\n\n    unset green blue red nocolor\n\nelse\n    PS1='${debian_chroot:+($debian_chroot)}\\u@\\h:\\w\\$ '\nfi\nunset color_prompt force_color_prompt\n</code></pre> <p>Warning</p> <p>Jos rikot <code>.bashrc</code>-tiedoston, saat virheilmoituksia aina avatessasi uuden terminaalin \u2013 tai pahimmassa tapauksessa et saa lainkaan terminaalia auki. T\u00e4ll\u00f6in voit korjata tilanteen avaamalla tiedoston graafisella editorilla, kuten Visual Studio Codella, ja poistamalla rikkin\u00e4iset rivit, tai palauttamalla varmuuskopion komennolla <code>cp ~/.bashrc.bak ~/.bashrc</code>.</p> <p>Tip</p> <p>Jos VS Coden Terminaali aiheuttaa p\u00e4\u00e4nvaivaa esimerkiksi oudon t\u00e4ydennyksen tai sen omien PS1-lis\u00e4ysten vuoksi, paina VS Codessa F1, avaa \"Preferences: Open Settings (JSON)\" ja lis\u00e4\u00e4 sinne seuraava rivi:</p> <pre><code>\"terminal.integrated.shellIntegration.enabled\": false,\n</code></pre>"},{"location":"asennus/virtualbox/","title":"Option B: VirtualBox","text":"<p>Tip</p> <p>Jos et jostain syyst\u00e4 voi asentaa Dual boottia (esim. et uskalla, tai sinulla on todella pieni SSD-levy), seuraavaksi suositelluin vaihtoehto on asentaa Linux Oracle Virtualboxin avulla. </p> <p>Alla olevassa ohjeessa asennetaan Ubuntu 24.04 LTS. Varmista kurssilla suositeltu versio opettajalta.</p> <p>Note</p> <p>Jos et saa Virtual Boxia jostain syyst\u00e4 toimimaan, \u00e4l\u00e4 j\u00e4\u00e4 toimettomaksi vaan ota opettajaan yhteytt\u00e4. Jos ongelma ei ratkea, etsit\u00e4\u00e4n vaihtoehtoinen tapa (esim. VMware vSphere tai WSL2).</p>"},{"location":"asennus/virtualbox/#video-ohje","title":"Video-ohje","text":"<p>VirtualBoxin ja tuoreimman Ubuntu LTS:n asennukseen l\u00f6ytyy niin reilusti valmiita videomuotoisia ohjeita, ett\u00e4 en turhaan toista niit\u00e4. Alla yksi esimerkki.</p> <p>Video 1: Open Integrator -tilin ohje Windows 11:lle, jossa asennetaan VirtualBox ja Ubuntu 24.04 LTS.</p>"},{"location":"asennus/virtualbox/#tekstiohje","title":"Tekstiohje","text":""},{"location":"asennus/virtualbox/#esiasetukset","title":"Esiasetukset","text":"<p>Alla oleva ohjeistus on testattu Windows 11 Home -versiossa. Mik\u00e4li sinulla on Windows Pro, voit k\u00e4ytt\u00e4\u00e4 Hyper-V:t\u00e4.</p> <ol> <li>Etsi <code>Turn Windows features on or off</code>-ikkuna Windowsista.</li> <li>Kytke <code>Virtual Machine Platform</code> p\u00e4\u00e4lle.</li> </ol> <p>Note</p> <p>Docker:n FAQ suosittelee kytkem\u00e4\u00e4n p\u00e4\u00e4lle my\u00f6s <code>Windows Hypervisor Platform</code>, mik\u00e4li haluat k\u00e4ytt\u00e4\u00e4 VirtualBoxia ja Dockeria joskus rinnakkain.</p> <p>Warning</p> <p>T\u00e4m\u00e4 ohje ei k\u00e4sittele Hyper-V:t\u00e4. Lyhyesti kuitenkin: se on Type-1 Hypervisor, ja tuoreet VirtualBox-versiot tukevat sit\u00e4 backendin\u00e4 (experimental feature). Vaihtoehtoisesti voit luoda Hyper-V -koneita Microsoftin omalla Hyper-V Managerilla. Jos k\u00e4yt\u00e4t VirtualBoxia Windows Pro -versiossa, ja sinulla on suorituskykyongelmia, kokeile joko kytke\u00e4 Hyper-V pois p\u00e4\u00e4lt\u00e4 tai luo virtuaalikoneet Hyper-V Managerilla.</p>"},{"location":"asennus/virtualbox/#luo-virtuaalikone","title":"Luo virtuaalikone","text":"<ol> <li>Asenna Oracle VM VirtualBox 7.x (linkki)</li> <li>Lataa Ubuntu Desktop Image, 64-bit AMD (linkki)</li> <li>Valitse VirtualBoxissa <code>Machine =&gt; New</code> tai klikkaa Ctrl+N</li> </ol> <p>T\u00e4yt\u00e4 VirtualBoxissa aukeavaan pop-uppiin tarvittavat tiedot: </p> <ul> <li>Valitse koneelle nimi (esim. <code>ubuntu2204</code>), kansio johon virtuaalikoneen image sek\u00e4 muut tiedostot tallennetaan (esim. <code>C:\\Users\\username\\VirtualBox VMs</code>), sek\u00e4 \u00e4sken lataamasi image.</li> <li>\u26a0\ufe0f Laita ruksi kohtaan <code>Skip Unattended Installation</code>. Jos haluat kokeilla <code>Plug'n'Pray</code>-asennusta, voit j\u00e4tt\u00e4\u00e4 ruksin paikoilleen, mutta tulet k\u00e4rsim\u00e4\u00e4n t\u00e4st\u00e4 my\u00f6hemmin. \u26a0\ufe0f</li> <li>Klikkaa Next.</li> <li>Kun kysyt\u00e4\u00e4n, anna virtuaalikoneelle esimerkiksi <code>4 CPU</code>:ta ja <code>8 GB</code> muistia, olettaen ett\u00e4 omassa tietokoneessasi on riitt\u00e4miin tarjolla.</li> <li>Klikkaa Next.</li> </ul> <p>Note</p> <p>Linux tulee olemaan virtuaalikoneessa hidas jos sit\u00e4 vertaa dual boot -asennukseen. Jos haluat sukkelamman kokemuksen, asenna Linux suoraan koneellesi. T\u00e4t\u00e4 varten on Dual Boot -ohje.</p>"},{"location":"asennus/virtualbox/#asenna-os","title":"Asenna OS","text":"<ul> <li>K\u00e4ynnist\u00e4 VM Start-n\u00e4pp\u00e4imell\u00e4.</li> <li>Ruutuun ilmestyy GRUB.<ul> <li>Valitse <code>Try or Install Ubuntu</code></li> </ul> </li> <li>Ubuntu installer k\u00e4ynnistyy.<ul> <li>Valitse <code>Install Ubuntu</code>. Anna kielen olla <code>English</code>.</li> <li>Klikkaa Next.</li> </ul> </li> <li>Ubuntu installer kysyy tietoja:<ul> <li>Valitse n\u00e4pp\u00e4imist\u00f6asetteluksi <code>Finnish -&gt; Finnish</code>.</li> <li>Klikkaa Continue</li> </ul> </li> <li>Ubuntu installer kysyy tietoja:<ul> <li>Valitse <code>Minimal Installation</code></li> <li>Valitse <code>Download updates while installing Ubuntu</code></li> <li>Klikkaa Continue</li> </ul> </li> <li>Ubuntu installer kysyy tietoja:<ul> <li>Valitse <code>Erase disk and install Ubuntu</code></li> <li>Klikkaa Install Now.</li> </ul> </li> </ul> <p>Seuraavissa ruuduissa kysell\u00e4\u00e4n maakohtaisia asetuksia, nime\u00e4, k\u00e4ytt\u00e4j\u00e4tunnusta, salasanaa ja niin edelleen. Valitse ne mielihalujesi mukaan.</p> <p>Kun odottelet hetken, Ubuntu Installer pyyt\u00e4\u00e4 k\u00e4ynnist\u00e4m\u00e4\u00e4n tietokoneen uusiksi, ja voit aloittaa k\u00e4yt\u00f6n. Jos kone ei meinaa k\u00e4ynnisty\u00e4, poista asennusmedia CD/DVD-asemasta ja paina Restart VM.</p>"},{"location":"asennus/virtualbox/#ukk","title":"UKK","text":""},{"location":"asennus/virtualbox/#k-juuri-asennettu-ubuntu-ei-kaynnisty","title":"K: Juuri asennettu Ubuntu ei k\u00e4ynnisty.","text":"<p>V: K\u00e4ynnist\u00e4 virtuaalikone uudelleen. Jos se ei auta, tarkista ett\u00e4 asennusmedia (eli <code>.ISO</code>-tiedosto) on poistettu virtuaalikoneen CD/DVD-asemasta.</p>"},{"location":"asennus/virtualbox/#k-ruudun-ylla-kalenterissa-nakyy-kummallisia-merkkeja-terminaali-ei-myoskaan-aukea","title":"K: Ruudun yll\u00e4 kalenterissa n\u00e4kyy kummallisia merkkej\u00e4. Terminaali ei my\u00f6sk\u00e4\u00e4n aukea.","text":"<p>V: T\u00e4m\u00e4 johtunee siit\u00e4, ett\u00e4 <code>Skip Unattended Installation</code> ei ole ollut valittuna Ubuntua asentaessa. Asenna Ubuntu uusiksi.</p>"},{"location":"asennus/virtualbox/#k-en-voi-kopioida-leikepoydalta-tietoa-vmn-ja-hostin-valilla","title":"K: En voi kopioida leikep\u00f6yd\u00e4lt\u00e4 tietoa VM:n ja Hostin v\u00e4lill\u00e4","text":"<p>Asenna Guest Additions. T\u00e4m\u00e4 hoituu n\u00e4in:</p> <ol> <li>Klikkaa VirtualBoxin menuista <code>Devices =&gt; Ingest Guest Additions CD Image...</code></li> <li>Pop-up aukeaa. Klikkaa <code>Run</code>.</li> <li>Kun asennus on ohi, poista levyke. T\u00e4m\u00e4 onnistuu klikkaamalla ty\u00f6p\u00f6yd\u00e4n CD ROM -ikonia ja valitsemalla ensin <code>Unmount</code> ja sitten <code>Eject</code>.</li> <li>K\u00e4ynnist\u00e4 virtuaalikone uusiksi (tai v\u00e4hint\u00e4\u00e4n loggaa ulos ja sis\u00e4\u00e4n.)</li> </ol> <p>Jos kohta 2:n Pop-Up ei ilmesty, klikkaa ty\u00f6p\u00f6yd\u00e4lt\u00e4 CD ROM -ikonia, jolloin tiedostoselaimeen avautuu virtuaalisen CD:n sis\u00e4lt\u00f6 kansion\u00e4kym\u00e4n\u00e4. Klikkaa <code>autorun.sh</code> oikealla hiirenkorvalla, valitse <code>Run as a Program</code>, ja t\u00e4yt\u00e4 kysytt\u00e4ess\u00e4 salasanasi. Jatka kohtaan 3.</p> <p>Jos kohdan 3 ohje ei toimi, pakota levy ulos. Valitse VirtualBoxista <code>Devices =&gt; Optical Drives =&gt; Remove disk from virtual drive</code>. Klikkaa Force pop-uppiin jos ei muuten l\u00e4hde.</p>"},{"location":"asennus/virtualbox/#k-vm-on-paalla-mutta-ruutu-on-musta","title":"K: VM on p\u00e4\u00e4ll\u00e4, mutta ruutu on musta.","text":"<p>Anna koneen n\u00e4yt\u00f6nohjaimelle lis\u00e4\u00e4 muistia. Sammuta kone ja s\u00e4\u00e4d\u00e4 sen asetuksista <code>Display =&gt; Video Memory: 64 MB</code></p>"},{"location":"c_ohjelmointi/args/","title":"Argumentit","text":""},{"location":"c_ohjelmointi/args/#kasin-parsimalla","title":"K\u00e4sin parsimalla","text":"<p>Linuxin k\u00e4yt\u00f6ss\u00e4 sinulle pit\u00e4isi olla tullut jo tutuksi, ett\u00e4 monille ohjelmille voi sy\u00f6tt\u00e4\u00e4 argumentteina, kuten <code>cat file_a file_b</code>, jossa argumentteja ovat <code>file_a</code> ja <code>file_b</code>. C-ohjelmissa argumentit voidaan ottaa vastaan <code>main</code>-funktion parametreina. Esimerkiksi:</p> argue.c<pre><code>#include &lt;stdio.h&gt;\n\nint main(int argc, char *argv[]) {\n    printf(\"Ohjelman nimi: %s\\n\", argv[0]);\n    printf(\"Argumentteja: %d\\n\", argc);\n    for (int i = 1; i &lt; argc; i++) {\n        printf(\"Argumentti %d: %s\\n\", i, argv[i]);\n    }\n    return 0;\n}\n</code></pre> <p>K\u00e4\u00e4nn\u00e4 ohjelma ja kokeile ajaa se eri argumenteilla.</p> Bash<pre><code># Ei argumentteja\n$ ./argue\n\n# Yksi argumentti\n$ ./argue kissa\n\n# Useampi argumentti\n$ ./argue kissa koira \"Hello, World\"\n\n# Argumentit, joissa suoritetaan erilaista string expansionia\n$ ./argue $SHELL $(whoami) $((5+5))\n</code></pre> <p>Kysymys</p> <p>Kokeile ajaa seuraava: </p> Bash<pre><code>./argue kissa koira \"Hello, World!\"`  # &lt;== Huomaa lis\u00e4tty huutomerkki! \n</code></pre> <p>T\u00e4m\u00e4 aiheuttaa ongelmia. Miksi? Miten ne voi kiert\u00e4\u00e4?</p>"},{"location":"c_ohjelmointi/args/#kirjaston-avulla","title":"Kirjaston avulla","text":"<p>Argumenttien k\u00e4sittely on yleinen ongelma, joten (GNU) C:ss\u00e4 on valmiita kirjastoja, jotka auttavat standardisoimaan argumenttien k\u00e4sittely\u00e4. Parametrien parmiseen soveltuu <code>unistd.h</code>:sta l\u00f6ytyv\u00e4 funktio <code>getopt</code> sek\u00e4 <code>getopt_long</code>. Tyypillinen Linux-k\u00e4ytt\u00e4j\u00e4 odottaa, ett\u00e4 optionit voi antaa haluamassaan j\u00e4rjestyksess\u00e4, ja annetaan yleens\u00e4 seuraavanlaisessa formaatissa: </p> Bash<pre><code>myprog \\ \n  -v                         `# lyhyt toggle-optio` \\\n  -a value                   `# lyhyt arvo-optio` \\\n  --some-long-option==value  `# pitk\u00e4 arvo-optio` \\\n  --some-long-toggle         `# pitk\u00e4 toggle-optio`\n</code></pre> <p>Tutustu alla olevaan koodiin. Huomaa, ett\u00e4 getopt:n kolmas argumentti sis\u00e4lt\u00e4\u00e4 kaksoispisteen seuraavien per\u00e4ss\u00e4: <code>n:</code> ja <code>w:</code>. T\u00e4m\u00e4 tarkoittaa, ett\u00e4 <code>n</code> ja <code>w</code> ovat optioita, jotka vaativat arvon. <code>l</code> on toggle-optio, joka ei vaadi arvoa. Sill\u00e4 ei ole per\u00e4ss\u00e4\u00e4n kaksoispistett\u00e4.</p> betterargue.c<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(int argc, char *argv[]) {\n    int opt;\n    int n = 1;\n    int line_numbers = 0;\n    char *word = \"spam\";\n\n    while ((opt = getopt(argc, argv, \"n:w:l\")) != EOF) {\n        switch (opt) {\n            case 'n':\n                n = atoi(optarg);\n                if (n &lt; 1) {\n                    fprintf(stderr, \"Invalid count: %d\\n\", n);\n                    return 1;\n                }\n                break;\n            case 'w':\n                word = optarg;\n                break;\n            case 'l':\n                line_numbers = 1;\n                break;\n            default:\n                fprintf(stderr, \"Usage: %s [-l] [-n &lt;count&gt;] [-w &lt;word&gt;]\\n\", argv[0]);\n                return 1;\n        }\n    }\n\n    for (int i = 0; i &lt; n; i++) {\n        if (line_numbers) {\n            printf(\"%d: \", i);\n        }\n        printf(\"%s\\n\", word);\n    }\n\n    return 0;\n\n}\n</code></pre> <p>K\u00e4\u00e4nn\u00e4 ja kokeile ajaa seuraavasti:</p> Bash<pre><code># Ei argumentteja\n$ ./betterargue\n\n# Pelkk\u00e4 sana m\u00e4\u00e4riteltyn\u00e4\n$ ./betterargue -w kissa\n\n# Pelkk\u00e4 m\u00e4\u00e4r\u00e4 m\u00e4\u00e4riteltyn\u00e4\n$ ./betterargue -n 5\n\n# Molemmat m\u00e4\u00e4riteltyn\u00e4\n$ ./betterargue -n 5 -w kissa\n\n# My\u00f6s rivinumerot togglettu p\u00e4\u00e4lle\n$ ./betterargue -n 5 -w kissa -l\n</code></pre> <p>Tip</p> <p>Lue aiheesta lis\u00e4\u00e4 The GNU C Library Reference Manual, mukaan lukien ohje siit\u00e4, kuinka k\u00e4ytt\u00e4\u00e4 pitki\u00e4 optioita kuten <code>--word</code> tai <code>--line-numbers</code>.</p>"},{"location":"c_ohjelmointi/merkkijonot/","title":"Merkkijonot","text":"<p>Mik\u00e4li et k\u00e4yt\u00e4 kirjastoja, C-kielest\u00e4 puuttuu tyystin merkkijono eli string muuttujatyyppi ja avustavat funktiot, joiden avulla voisi esimerkiksi selvitt\u00e4\u00e4 merkkijonon pituuden tai liimata kaksi merkkijonoa yhteen.</p> <p>Huomaa, ett\u00e4 literaalit merkkijonot m\u00e4\u00e4ritell\u00e4\u00e4n lainausmerkkien v\u00e4liin: <code>\"kissa\"</code>. Yksitt\u00e4iset heittomerkit on varattu kirjainten m\u00e4\u00e4rittelyyn: <code>'k'</code>. Lista kirjaimia olisi muotoa <code>char kissa[] = {'k', 'i', 's', 's', 'a', '\\0'};</code>. Huomaa, ett\u00e4 merkkijonon lopussa on aina nollamerkki, joka kertoo, ett\u00e4 merkkijono on p\u00e4\u00e4ttynyt. Merkkijonojen k\u00e4sittelyyn l\u00f6ytyy C Standard Libraryst\u00e4 header file nimelt\u00e4\u00e4n <code>string.h</code>.</p> kirjaimet.c<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    char word[] = \"Hello, w\u00f6rld!\"; // (1)!\n    int length = sizeof(word) / sizeof(word[0]); // (2)!\n\n    printf(\"Muuttujan word pituus on: %d \\n\", length);\n\n    for (int i = 0; i &lt; length; i++)\n    {\n        printf(\"%i: %c (0x%02X)\\n\", i, word[i], word[i]);\n    }\n}\n</code></pre> <ol> <li>Kokeile my\u00f6s esimerkiksi word[5] ja word[20]</li> <li>Muokkaa koodia siten, ett\u00e4 k\u00e4yt\u00e4t lenght muuttujan arvon laskemiseen <code>strlen()</code> funktiota, joka l\u00f6ytyy <code>string.h</code> kirjastosta.</li> </ol> <p>Tip</p> <p>Voit kokeilla my\u00f6s word-muuttujan luomista siten, ett\u00e4 se on muotoa array of characters. T\u00e4m\u00e4 hoituu seuraavalla tavalla:</p> <pre><code>char word[20] = {'H', 'e', 'l', 'l', 'o', ',', ' ', 'w', 'o', 'r', 'l', 'd', '!', '\\0'};\n</code></pre> <p>Mit\u00e4 ongelmia \u00f6-kirjain aiheuttaa? Toimiiko koodi jos korvaat sen o-kirjaimella?</p>"},{"location":"c_ohjelmointi/merkkijonot/#merkkijonot-listassa","title":"Merkkijonot listassa","text":"<p>Lista voi sis\u00e4lt\u00e4\u00e4 listoja. Selvit\u00e4, mit\u00e4 alla oleva koodi tekee:</p> <pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nchar imdb_top_movies[][50] = {\n    \"The Shawshank Redemption\",\n    \"The Godfather\",\n    \"The Dark Knight\",\n    \"The Godfather: Part II\",\n    \"12 Angry Men\",\n    \"Schindler's List\",\n    \"The Lord of the Rings: The Return of the King\",\n    \"Pulp Fiction\",\n    \"The Lord of the Rings: The Fellowship of the Ring\",\n    \"The Good, the Bad and the Ugly\",\n};\n\nint n = sizeof(imdb_top_movies) / sizeof(imdb_top_movies[0]);\n\nint main() {\n\n    char search_word[50];\n    printf(\"Search for a movie title: \");\n    scanf(\"%s\", search_word);\n\n    for (int i = 0; i &lt; n; i++) {\n\n        if (strstr(imdb_top_movies[i], search_word)) {\n            printf(\"Found: %s\\n\", imdb_top_movies[i]);\n        }\n    }\n}\n</code></pre>"},{"location":"c_ohjelmointi/modularisointi/","title":"Modularisointi","text":"<p>T\u00e4h\u00e4n asti kaikki esimerkit ovat sijainneet yhdess\u00e4 C-tiedostossa. T\u00e4m\u00e4 ei ole kovin k\u00e4yt\u00e4nn\u00f6llist\u00e4, jos ohjelma on suuri. T\u00e4ss\u00e4 tulevat apuun header-tiedostot sek\u00e4 build system nimelt\u00e4\u00e4n <code>make</code>.</p>"},{"location":"c_ohjelmointi/modularisointi/#simppeli-esimerkki","title":"Simppeli esimerkki","text":"<p>Lue tiedostot <code>headerdemo.c</code> ja <code>headerdemo.h</code>. Lis\u00e4\u00e4 tiedostoihin sis\u00e4lt\u00f6 alla n\u00e4kyv\u00e4st\u00e4 koodista.</p> <p>Tiedostojen kuvaus:</p> <ul> <li><code>app_itself.c</code> on ohjelma itse. </li> <li><code>headerdemo.h</code> sis\u00e4lt\u00e4\u00e4 <code>printHello</code>-funktion prototyypin (declaration).</li> <li><code>headerdemo.c</code> sis\u00e4lt\u00e4\u00e4 <code>printHello</code>-funktion toteutuksen (definition).</li> </ul>"},{"location":"c_ohjelmointi/modularisointi/#koodi","title":"Koodi","text":"app_itself.cheaderdemo.cheaderdemo.h <pre><code>#include \"headerdemo.h\"\n\nint main() {\n    printHello();\n    return 0;\n}\n</code></pre> <pre><code>#include \"headerdemo.h\"\n#include &lt;stdio.h&gt;\n\nvoid printHello() { printf(\"Hello, World!\\n\"); }\n</code></pre> <pre><code>#pragma once // #(1)!\n\nvoid printHello();\n</code></pre> <ol> <li><code>#pragma once</code>-direktiivi est\u00e4\u00e4 header-tiedoston sis\u00e4llytt\u00e4misen useammin kuin kerran. T\u00e4m\u00e4 auttaa ehk\u00e4iseen ongelmia, jotka syntyv\u00e4t, kun header-tiedosto sis\u00e4llytet\u00e4\u00e4n useammin kuin kerran, kuten circular dependency. Vaihtoehto, jos k\u00e4\u00e4nt\u00e4j\u00e4 ei tue pragma oncea, on k\u00e4ytt\u00e4\u00e4 <code>#ifndef</code>-direktiivi\u00e4.</li> </ol> <p>Miksi &lt;&gt; merkit?</p> <p>Huomaa lokaalin ja toisesta polusta l\u00f6ytyv\u00e4n header-tiedoston ero. Lokaali header-tiedosto on sijoitettu lainausmerkkien sis\u00e4\u00e4n, kun taas toisesta polusta l\u00f6ytyv\u00e4 tiedosto on sijoitettu kulmasulkeiden sis\u00e4\u00e4n.</p> <p>Jos haluat l\u00f6yt\u00e4\u00e4 <code>stdio.h</code>-tiedoston, jota GCC k\u00e4ytt\u00e4\u00e4, voit ajaa seuraavan komennon:</p> Bash<pre><code>gcc -E -x c - -v &lt; /dev/null\n</code></pre> <p>Etsi outputista rivej\u00e4, jotka n\u00e4ytt\u00e4v\u00e4t t\u00e4lt\u00e4:</p> Bash<pre><code>#include &lt;...&gt; search starts here:\n/usr/lib/gcc/aarch64-linux-gnu/11/include\n/usr/local/include\n/usr/include/aarch64-linux-gnu\n/usr/include\n</code></pre> <p>Tulet l\u00f6yt\u00e4m\u00e4\u00e4n esimerkiksi tiedostot:</p> <ul> <li><code>/usr/include/stdio.h</code> (ASCII)</li> <li><code>/usr/lib/aarch64-linux-gnu/libc.so</code> (ASCII)</li> <li><code>/usr/lib/aarch64-linux-gnu/libc.so.6</code> (ELF)</li> </ul> <p>Yll\u00e4 mainittu <code>.so</code>-tiedosto on dynaaminen kirjasto, joka sis\u00e4lt\u00e4\u00e4 koodia, jota voidaan ajaa ohjelman suorituksen. Windowsissa sen vastine on DLL-tiedosto.</p>"},{"location":"c_ohjelmointi/modularisointi/#kaantaminen","title":"K\u00e4\u00e4nt\u00e4minen","text":"<p>Koodi k\u00e4\u00e4nnet\u00e4\u00e4n aivan kuten ennenkin, mutta sinun tulee listata kaikki tarvittavat <code>*.c</code>-tiedostot. K\u00e4\u00e4nn\u00e4 ohjelma seuraavasti:</p> Bash<pre><code># Jos hakemistossa ei ole muita .c-tiedostoja\n$ gcc *.c -o app_itself\n\n# Jos on, m\u00e4\u00e4rittele lista\n$ gcc app_itself.c headerdemo.c -o app_itself\n</code></pre> <p>Question</p> <p>Luo toinen ohjelma, nimelt\u00e4\u00e4n Another App, joka hy\u00f6dynt\u00e4\u00e4 samaa kirjastoa.</p>"},{"location":"c_ohjelmointi/modularisointi/#objektitiedostot","title":"Objektitiedostot","text":"<p>Ohjelman k\u00e4\u00e4nt\u00e4misen sijasta voit k\u00e4\u00e4nt\u00e4\u00e4 kaikki <code>jotain.c</code>-tiedostot objektitiedostoiksi. T\u00e4st\u00e4 on se hy\u00f6ty, ett\u00e4 mik\u00e4li jatkossa <code>egg.c</code> muuttuu, mutta <code>ham.c</code> ja <code>spam.c</code> eiv\u00e4t, sinun tarvitsee generoida vain <code>egg.o</code> uudelleen. Kevyit\u00e4 ohjelmia k\u00e4\u00e4nt\u00e4ess\u00e4 tuskin huomaat eroa, k\u00e4\u00e4nsitk\u00f6 kaikki tiedostot uudelleen vai vain muuttuneet, mutta t\u00e4m\u00e4 on hyv\u00e4 tuntea, koska tulet t\u00f6rm\u00e4\u00e4m\u00e4\u00e4n <code>.o</code>, <code>.so</code>, <code>.ko</code> ja vastaaviin objektitiedostoihin.</p> Bash<pre><code># Jos hakemistossa ei ole ei-tarpeellisia .c-tiedostoja\n$ gcc -c *.c\n\n# Jos on, m\u00e4\u00e4rittele lista\n$ gcc -c app_itself.c headerdemo.c\n</code></pre> Miksi -c? <p><code>-c</code>-flagi kertoo GCC:lle, ett\u00e4 \"Only run preprocess, compile, and assemble steps\". Linkitys ja suoritettavan tiedoston luonti j\u00e4\u00e4v\u00e4t tekem\u00e4tt\u00e4.</p> <p>Hakemistoon luodaan uudet objektitiedostot:</p> Bash<pre><code>$ tree\n.\n\u251c\u2500\u2500 app_itself.c\n\u251c\u2500\u2500 app_itself.o  &lt;== t\u00e4m\u00e4\n\u251c\u2500\u2500 headerdemo.c\n\u251c\u2500\u2500 headerdemo.h\n\u2514\u2500\u2500 headerdemo.o  &lt;== t\u00e4m\u00e4\n</code></pre> <p>Jatkossa, kun <code>headerdemo.c</code> muuttuu, sinun tarvitsee k\u00e4\u00e4nt\u00e4\u00e4 vain <code>headerdemo.o</code> uudelleen.</p> Bash<pre><code># K\u00e4\u00e4nn\u00e4\n$ gcc *.o -o app_itself\n$ ./app_itself\nHello, World!\n\n# Muokkaa headerdemo.c:t\u00e4 ja k\u00e4\u00e4nn\u00e4 uusiksi\n$ sed -i 's/World/Humans/' headerdemo.c\n$ gcc -c headerdemo.c\n$ gcc *.o -o app_itself\nHello, Humans!\n</code></pre> <p>S\u00e4\u00e4st\u00f6 on t\u00e4ss\u00e4 tapauksessa mit\u00e4t\u00f6n, koska l\u00e4hdekoodissa on vain muutama rivi. Tilanne olisi toinen, jos l\u00e4hdekoodia olisi tuhansia rivej\u00e4 ja/tai jos k\u00e4yt\u00f6ss\u00e4 oleva CPU olisi merkitt\u00e4v\u00e4n hidas.</p>"},{"location":"c_ohjelmointi/modularisointi/#hello-make","title":"Hello Make","text":"<p>T\u00e4m\u00e4 opas on todella lyhyt johdanto Make:n k\u00e4ytt\u00f6\u00f6n. Kannattaa tutustua lis\u00e4ksi helppolukuiseen Learn Makefile with the tastiest examples-oppaaseen.</p>"},{"location":"c_ohjelmointi/modularisointi/#makefile","title":"Makefile","text":"Makefile<pre><code>file_x: file_a file_b file_c\n    @echo \"I am being executed!\"\n    touch file_x\n</code></pre> <p>Syntaksi</p> <pre><code>target: dependency1 dependency2 ...\n    # Komentoja\n    # sisennettyn\u00e4\n    # TAB-merkill\u00e4\n    command_that_builds_target\n</code></pre> <p>Komento @echo on Makefilen syntaksiin kuuluva \"silent\"-k\u00e4sky. Komento <code>@</code> est\u00e4\u00e4 Makea tulostamasta itse komentoa, mik\u00e4 on echon kanssa hy\u00f6dyllist\u00e4. Kokeile ajaa Makefilea ilman <code>@</code>-merkki\u00e4 ja katso mit\u00e4 tapahtuu.</p>"},{"location":"c_ohjelmointi/modularisointi/#riippuvuudet","title":"Riippuvuudet","text":"<p>Yll\u00e4 olevan Makefilen mukaan <code>file_x</code> riippuu <code>file_a</code>, <code>file_b</code> ja <code>file_c</code>-tiedostoista. Mik\u00e4li t\u00e4m\u00e4n piirt\u00e4\u00e4 graafina, se n\u00e4ytt\u00e4\u00e4 t\u00e4lt\u00e4:</p> <pre><code>graph LR\n    X[file_x] --&gt;|depends on| A[file_a]\n    X --&gt;|depends on| B[file_b]\n    X --&gt;|depends on| C[file_c]</code></pre> <p>Makefile on tavallinen ASCII-tekstitiedosto. Komento <code>make</code> olettaa hakemistosta l\u00f6ytyv\u00e4n sen nimisen tiedoston (vtr. <code>Dockerfile</code>). Sinulla pit\u00e4isi olla  <code>make</code> jo asennettuna: se asentuu tyypillisesti <code>build-essential</code>-pakettiryhm\u00e4n mukana. Kun ajat <code>make</code>-komennon, se lukee <code>Makefile</code>-tiedoston sis\u00e4ll\u00f6n ja suorittaa komennot, mik\u00e4li:</p> <ol> <li><code>file_x</code> on vanhempi kuin <code>file_a</code>, <code>file_b</code> tai <code>file_c</code></li> <li><code>file_x</code> ei ole olemassa</li> </ol> <p>Harjoittele t\u00e4t\u00e4 ajamalla seuraavat komennot ajatuksella:</p> Bash<pre><code># Valmistelut: Luo Makefile\n# Katso sis\u00e4lt\u00f6 ylt\u00e4\n\n# Luo riippuvuudet\n$ touch file_a file_b file_c\n\n# Tarkista mit\u00e4 l\u00f6ytyy.\n$ ls -lAtT | awk '{print $8, $10}'\n  13:39:25 file_c\n  13:39:25 file_b\n  13:39:25 file_a\n  13:35:50 Makefile\n\n# Aja\n$ make\n\n# Tarkista mit\u00e4 l\u00f6ytyy.\n$ ls -lAtT | awk '{print $8, $10}'\n  13:42:22 file_x\n  13:39:25 file_c\n  13:39:25 file_b\n  13:39:25 file_a\n  13:35:50 Makefile\n\n\n# Kokeile ajaa uusiksi\n$ make\n</code></pre> <p>Huomaat, ett\u00e4 viimeinen <code>make</code>-komento ei tee mit\u00e4\u00e4n, koska <code>file_x</code> on jo olemassa ja se on uudempi kuin <code>file_a</code>, <code>file_b</code> ja <code>file_c</code>. Kokeile viel\u00e4 muokata <code>file_a</code>-tiedostoa ja ajaa <code>make</code> uudelleen.</p> Bash<pre><code>$ touch file_a\n$ make\n</code></pre>"},{"location":"c_ohjelmointi/modularisointi/#useampi-target","title":"Useampi target","text":"<p>Jos <code>Makefile</code>-tiedostossa on useampi target, <code>make</code>-komento ajaa aina ensimm\u00e4isen targetin. Voit kuitenkin ajaa muita targetteja seuraavasti:</p> MyFakeMakefile<pre><code>say_hi:\n    @echo \"Hi\"\n\nsay_cheese:\n    @echo \"Cheese\"\n\nsay_goodbye:\n    @echo \"Goodbye\"\n</code></pre> Bash<pre><code># Aja ensimm\u00e4inen target\n$ make -f MyFakeMakefile say_hi\n\n# Aja toinen target\n$ make -f MyFakeMakefile say_cheese\n</code></pre> <p>Warning</p> <p>Huomaa, ett\u00e4 mik\u00e4\u00e4n yll\u00e4 mainituista targeteista ei ole olemassa oleva tiedosto, eik\u00e4 niiden alla oleva komento luo sit\u00e4. N\u00e4m\u00e4 targetit ajetaan siis aina.</p>"},{"location":"c_ohjelmointi/modularisointi/#target-riippuuvuutena","title":"Target riippuuvuutena","text":"<p>Targetit voivat olla toisten targettien riipuuvuuksia. N\u00e4in riippuuvuuksista tulee puuksi kuviteltava riippuvuuspuu (engl. dependency tree).</p> ImprovedMakefile<pre><code>all: say_hi say_cheese say_goodbye\n\nsay_hi:\n    @echo \"Hi\"\n\nsay_cheese:\n    @echo \"Cheese\"\n\nsay_goodbye:\n    @echo \"Goodbye\"\n</code></pre> Bash<pre><code>$ make -f ImprovedMakefile\n</code></pre> <p>Question</p> <p>Tee Makefile-tiedosto, joka k\u00e4\u00e4nt\u00e4\u00e4 <code>app_itself</code>-bin\u00e4\u00e4rin, mik\u00e4li jokin sen dependenssi on muuttunut. Mieti, millaisen puun n\u00e4m\u00e4 riippuvuudet muodostavat:</p> <ul> <li><code>app_itself.c</code></li> <li><code>app_itself.o</code></li> <li><code>headerdemo.c</code></li> <li><code>headerdemo.h</code></li> <li><code>headerdemo.o</code></li> </ul>"},{"location":"c_ohjelmointi/modularisointi/#makefilen-edistyneempi-kaytto","title":"Makefilen edistyneempi k\u00e4ytt\u00f6","text":"<p>Jos tutustuit yll\u00e4 mainittuun Learn Makefile with the tastiest examples-oppaaseen, huomasit, ett\u00e4 Makefilet voivat olla hyvin monimutkaisia. Syntaksi on vaikeasti l\u00e4hestytt\u00e4v\u00e4, mutta sill\u00e4 voi saavuttaa silti n\u00e4pp\u00e4ri\u00e4 etuja. On mahdollista luoda <code>Makefile</code>-tiedosto, joka esimerkiksi:</p> <ul> <li>K\u00e4\u00e4nt\u00e4\u00e4 <code>*.c</code> ja <code>lib/*.c</code>-tiedostot</li> <li>Luo bin\u00e4\u00e4rin poluun <code>bin/softa</code></li> <li>Ajaa bin\u00e4\u00e4rin menness\u00e4\u00e4n, jos <code>make run</code> on ajettuna</li> <li>Tuhota bin\u00e4\u00e4rit <code>make clean</code>-k\u00e4skyll\u00e4</li> </ul> <p>T\u00e4m\u00e4 voi olla hy\u00f6dyllinen C-kielt\u00e4 opetellessa, jos sinulla on useita ohjelmia eri hakemistoissa eri harjoituksiin liittyen, jolloin niiden polut olisivat esimerkiksi:</p> <pre><code>exer01/\n    Makefile\n    app1.c\n    lib/\n        lib1.c\n        lib1.h\n    build/\n        softa\nexer02/\n    Makefile\n    ...\nexer##/\n    Makefile\n    ...\n</code></pre> Yll\u00e4 kuvaillun Makefilen esimerkkitoteutus <pre><code>CC = gcc\nCFLAGS = -Wall -Wextra -Werror -std=c99 -Werror=missing-prototypes\nSRC = $(wildcard *.c lib/*.c)\nTARGET = softa\nBUILD_DIR = build\nBUILD_TARGET = $(BUILD_DIR)/$(TARGET)\n\nall: $(BUILD_DIR) $(BUILD_TARGET)\n\n$(BUILD_DIR):\n    mkdir -p $(BUILD_DIR)\n\n$(BUILD_TARGET): $(SRC)\n    $(CC) $(CFLAGS) -o $(BUILD_TARGET) $(SRC) -lm\n\nrun: all\n    ./$(BUILD_TARGET)\n\nclean:\n    rm -r $(BUILD_DIR)\n\n.PHONY: all clean run\n</code></pre> <p>Huomaa, ett\u00e4 yll\u00e4 mainitun Makefile Tutorialin per\u00e4st\u00e4 l\u00f6ytyy Makefile Cookbook, jossa esitell\u00e4\u00e4n hieman vastaava Makefile, joka hy\u00f6dynt\u00e4\u00e4 my\u00f6s objektitiedostoja, ja sallii C++:n k\u00e4yt\u00f6n.</p>"},{"location":"c_ohjelmointi/muuttujat/","title":"Muuttujat","text":"<p>Huomaa, ett\u00e4 C-kieless\u00e4 ei ole samanlaista yleisp\u00e4tev\u00e4\u00e4 \u00e4\u00e4rett\u00f6m\u00e4lt\u00e4 tuntuvaa \"integer\"-tyyppi\u00e4 kuin Pythonissa. Muuttuja tulee alustaa valitsemallasi tietotyypill\u00e4.</p> etumerkit.c<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n\n    // Char on 1-tavuinen muuttuja: ASCII-merkin koodipiste tai\n    // ihan vain pieni numero (-128...127)\n    signed char num;\n    num = 127;\n    num += 1;\n    printf(\"Num = %d\\n\", num);\n\n    // Unsigned muuttaa vasemmanpuoleisimman bitin negatiivisuuden\n    // merkist\u00e4 luvuksi. T\u00e4m\u00e4 siirt\u00e4\u00e4 lukuavaruuden positiiviseksi (0...255).\n    unsigned char b;\n    b = 127;\n    b += 1;\n    printf(\"Num = %d\\n\", b);\n\n    return 0;\n}\n</code></pre> <p>Alla tyypillisi\u00e4 C-kielen muuttujatyyppej\u00e4 niiden tavum\u00e4\u00e4r\u00e4n sek\u00e4 lukuavaruuden mukaan taulukossa. Huomaa, ett\u00e4 <code>int</code> ja <code>float</code> tyyppien bittisyvyys voi vaihdella prosessoriarkkitehtuurista riippuen. Oletuksena luvut ovat <code>signed</code> eli vasemmanpuolimmaisin bitti m\u00e4\u00e4ritt\u00e4\u00e4, onko luku positiivinen vai negatiivinen. Jos pakotat muuttujasta positiivisen (esim. <code>unsigned int</code>), lukuavaruus alkaa 0:sta ja jatkuu <code>2 ** bittisyvyys</code> asti.</p> Tyyppi Nimi Tavua Lukuavaruus Printf ASCII-kirjain char 1 -128 to 127 %c Kokonaisluku short 2 -32,768 to 32,767 %hd Kokonaisluku int 4 -2.1E+9 to 2.1E+9 %d Kokonaisluku long 8 -9.2E+18 to 9.2E+18 %ld Desimaaliluku float 4 -3.4E+38 to 3.4E+38 %f Desimaaliluku double 8 -1.7E+308 to 1.7E+308 %lf <p>Mik\u00e4li haluat selvitt\u00e4\u00e4 oman prosessoriarkkitehtuurisi mukaisen <code>int</code>- ja <code>float</code>-tyyppien bittisyvyyden, voit tehd\u00e4 sen <code>sizeof()</code> funktiota k\u00e4ytt\u00e4en. K\u00e4\u00e4nn\u00e4 ja aja alla n\u00e4kyv\u00e4 <code>limits.c</code>-tiedoston sis\u00e4lt\u00f6. (Koodi olettaa, ett\u00e4 tavu on tasan 8 bitti\u00e4. Tavun leveys voi vaihdella eri arkkitehtuurien v\u00e4lill\u00e4. \ud83e\udd13)</p> limits.c<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n\n    printf(\"Size of char: %zu bytes (%zu bits)\\n\", sizeof(char), sizeof(char) * 8);\n    printf(\"Size of short: %zu bytes (%zu bits)\\n\", sizeof(short), sizeof(short) * 8);\n    printf(\"Size of int: %zu bytes (%zu bits)\\n\", sizeof(int), sizeof(int) * 8);\n    printf(\"Size of long: %zu bytes (%zu bits)\\n\", sizeof(long), sizeof(long) * 8);\n    printf(\"Size of float: %zu bytes (%zu bits)\\n\", sizeof(float), sizeof(float) * 8);\n    printf(\"Size of double: %zu bytes (%zu bits)\\n\", sizeof(double), sizeof(double) * 8);\n\n    return 0;\n}\n</code></pre>"},{"location":"c_ohjelmointi/muuttujat/#formaatin-maarittely-tulostaessa","title":"Formaatin m\u00e4\u00e4rittely tulostaessa","text":"Placeholder Tulostettava Esimerkki c kirjain <code>printf(\"%c\", 'A')</code> d tai i kokoluku <code>printf(\"%d\", 123)</code> f desimaaliluku <code>printf(\"%f\", 3.14)</code> s merkkijono <code>printf(\"%s\", \"abc\")</code> X tai x numero (heksaksi) <code>printf(\"hex = %02x\", 101)</code> p pointteri <code>printf(\"%p\", &amp;my_integer)</code>"},{"location":"c_ohjelmointi/muuttujat/#muuttujan-castaaminen-toiseksi-tyypiksi","title":"Muuttujan castaaminen toiseksi tyypiksi","text":"<p>Muuttujia voi castata muuttujatyypist\u00e4 toiseen asettamalla haluttu muuttujatyyppi suluissa muuttajan eteen.</p> casting.c<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    float f = 3.14;\n    int i = (int)f;\n\n    printf(\"float %f is %i as int\\n\", f, i);\n    return 0;\n}\n</code></pre>"},{"location":"c_ohjelmointi/pointterit/","title":"Osoittimet","text":"<p>Osoitin (engl. pointer) on muistiosoite. Sen sijaan, ett\u00e4 toimitat funktiolle kopion datasta, voit toimittaa funktiolle pointterin. T\u00e4ll\u00f6in s\u00e4\u00e4styy muistia.</p> <p>Osoitin voidaan alustaa samalla tavalla kuin tyypilliset muuttujat, mutta muuttujan nime\u00e4 edustava t\u00e4hti tekee siit\u00e4 osoittimen eli pointterin. Pointterin <code>int</code>-tyyppim\u00e4\u00e4rittely ei suinkaan tarkoita ett\u00e4 muistiavaruuden osoite olisi kokonaisluku, vaan ett\u00e4 muistiavaruudesta pit\u00e4\u00e4 nimitt\u00e4\u00e4 sellainen lokaatio, johon mahtuu kokonaisluku. Kuten aiemmin opimme, t\u00e4m\u00e4 on todenn\u00e4k\u00f6isimmin sinun j\u00e4rjestelm\u00e4ss\u00e4si 4 tavua eli 32 bitti\u00e4.</p> <pre><code>int* my_pointer;  // N\u00e4in ..\nint *my_pointer;  // Tai n\u00e4in\nint * my_pointer; // .. tai n\u00e4in\n</code></pre> <p>Kaikki muuttujat sis\u00e4lt\u00e4v\u00e4t sek\u00e4 pointterin ett\u00e4 arvon. Kuvitteellisen muuttujan <code>my_num</code> osoitteeseen muistiavaruudessa voidaan viitata liitt\u00e4m\u00e4ll\u00e4 <code>&amp;</code>-symboli sen alkuun.</p> <pre><code>int my_num = 5;\nint* my_pointer = &amp;my_num;\n</code></pre> <p>Huomaa, ett\u00e4 alustettu pointteri, jolle ei ole viel\u00e4 osoitettu sille kuuluvaa arvoa, osoittaa johonkin paikkaan muistiavaruudessa. Minne? Vaikea sanoa. Satunnaiseen muistiavaruuden lokaatioon osoittavan pointterin k\u00e4ytt\u00f6\u00e4 tulisi v\u00e4ltt\u00e4\u00e4.</p> <p>Alla termit taulukkomuodossa.</p> Symboli Nimi &amp; Address of * Dereference <p>Kokeile ajaa alla oleva koodi. Tutki, mit\u00e4 tulostuu.</p> arvo-osoite.c<pre><code>#include &lt;stdio.h&gt;\n\n// Alustetaan kokonaisluvun muuttuja\nint my_num;\n\n// Alustetaan osoittimen muuttuja (osoittaa kokonaislukuun)\nint* my_pointer;\n\nint main() {\n\n    my_num = 5;\n    my_pointer = &amp;my_num;\n\n    printf(\"myNum = %d\\n\", my_num);\n    printf(\"myPointer value = %d\\n\", *my_pointer);\n\n    // %p on formatter pointterin osoitteen tulostamiseen heksana\n    printf(\"myNum address = %p\\n\", &amp;my_num);\n    printf(\"myPointer = %p\\n\", my_pointer);\n}\n</code></pre> <p>Alla viel\u00e4 vaihtoehto, joka saattaa auttaa hahmottamaan, kuinka <code>*</code> ja <code>&amp;</code> k\u00e4ytt\u00e4ytyv\u00e4t:</p> pointer-tulostin.c<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int x = 5;\n    int* p = &amp;x;\n\n    printf(\"x = %d\\n\", x);\n    printf(\"p = %p\\n\", p);\n    printf(\"*p = %d\\n\", *p);\n    printf(\"&amp;x = %p\\n\", &amp;x);\n    printf(\"&amp;p = %p\\n\", &amp;p);\n\n    return 0;\n}\n</code></pre>"},{"location":"c_ohjelmointi/pointterit/#osoittimet-ja-funktiokutsut","title":"Osoittimet ja funktiokutsut","text":"<p>Huomaa, ett\u00e4 jos toimitat funktiolle pointterin, niin muistiosoitteen sis\u00e4lt\u00e4v\u00e4n arvon muokkaaminen muokkaa sit\u00e4 kaikissa niiss\u00e4 muuttujissa, joiden osoitin viittaa tuohon muistiavaruuteen.</p> pointer-funktio.c<pre><code>#include &lt;stdio.h&gt;\n\nvoid add_one(int *x) {\n    puts(\"Increasing x by 1 inside a function.\");\n    *x = *x + 1;\n}\n\nint main() {\n    int x = 5;\n    int* y = &amp;x;\n\n    printf(\"x = %d\\n\", x);\n    printf(\"y = %d\\n\", *y);\n    add_one(&amp;x);\n    printf(\"x = %d\\n\", x);\n    printf(\"y = %d\\n\", *y);\n\n    return 0;\n}\n</code></pre>"},{"location":"c_ohjelmointi/pointterit/#osoittimet-ja-merkkijonot","title":"Osoittimet ja merkkijonot","text":"<p>Luo uusi tiedosto, esimerkiksi <code>strings.c</code>, sis\u00e4ll\u00f6lt\u00e4\u00e4n:</p> strings.c<pre><code>#include &lt;stdio.h&gt;\n\nvoid print_in_function(char word[]) {\n    puts(\"In function:\");\n    printf(\"word: %s (%lu bytes)\\n\", word, sizeof(word));\n    printf(\"Pointer address: %p\\n\", word);\n}\n\nint main() {\n    char word[] = \"Hello world! I am a array of characters.\";\n\n    printf(\"word: %s (%lu bytes)\\n\", word, sizeof(word));\n    printf(\"Pointer address: %p\\n\", word);\n    print_in_function(word);\n\n    return 0;\n}\n</code></pre> <p>Aja koodi n\u00e4in:</p> Bash<pre><code>$ gcc strings.c -o strings -Wno-sizeof-array-argument &amp;&amp; ./strings\n</code></pre> <p>Koodi k\u00e4\u00e4ntyy varoituksesta huolimatta. Tutkitaan hieman tilannetta.</p> <ul> <li>K\u00e4yt\u00e4m\u00e4mme \"merkkijono\" on array merkkej\u00e4 (Char[])</li> <li>GCC tiet\u00e4\u00e4, ett\u00e4 teemme jotain typer\u00e4\u00e4, joten warning on ignoorattu <code>-Wno-sizeof-array-argument</code> parametrilla. Kokeile ajaa koodi my\u00f6s ilman sit\u00e4.</li> <li>Array k\u00e4ytt\u00e4ytyy main funktiossa <code>printf()</code> osalta kuin pointer (<code>%p</code>), mutta on kuitenkin array.</li> <li>Funktiolle sy\u00f6tetty array k\u00e4\u00e4ntyy pointteriksi. Pointterin koko on 64-bittisess\u00e4 j\u00e4rjestelm\u00e4ss\u00e4 8 tavua (<code>8 * 8 = 64</code>).</li> </ul>"},{"location":"c_ohjelmointi/pointterit/#osoittimet-ja-listat","title":"Osoittimet ja listat","text":"<p>Arrayn elementin voi tulostaa samalla tavalla kuin listan elementin Pythonissa eli <code>somethings[index]</code>. Huomaa, ett\u00e4 <code>*nums</code> viittaa arrayn pointteriin eli muistiavaruuden ensimm\u00e4iseen integeriin, joten <code>*nums == 1</code> ja <code>*(nums + 1) == 2</code>.</p> pointer-array.c<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int nums[] = {1, 2, 3, 4, 5};\n\n    printf(\"Pointer address: %p\\n\", nums);\n    puts(\"Different ways of printing the second value:\");\n\n    printf(\"A: %d\\n\", nums[1]);\n    printf(\"B: %d\\n\", *(nums + 1));\n    printf(\"C: %d\\n\", 1[nums]);\n\n    return 0;\n}\n</code></pre> <p>Kokeile, mit\u00e4 tulostuu, jos haet jonkin sellaisen arvon, mik\u00e4 ei todellakaan sis\u00e4ll\u00e4 jotakin sinun m\u00e4\u00e4rittelem\u00e4\u00e4si arvoa? Array <code>nums</code> on <code>5 * 8</code> tavua pitk\u00e4 (64-bittisess\u00e4 j\u00e4rjestelm\u00e4ss\u00e4),  joten <code>nums[0] == 0</code> ja <code>nums[4] == 5</code>. Mutta mit\u00e4 l\u00f6ytyy vaikkapa arvosta <code>nums[5]</code> tai <code>nums[10]</code> tai <code>nums[-4]</code>?</p>"},{"location":"c_ohjelmointi/pointterit/#muistiavaruuden-suojaaminen","title":"Muistiavaruuden suojaaminen","text":"<p>Osoittimien kanssa huomasimme, ett\u00e4 voimme hakea tietoa muistiavaruuksista, jotka eiv\u00e4t kuulu muistiavaruuden dataan. Dataa voi my\u00f6s (yritt\u00e4\u00e4) sijoittaa sinne.</p> <pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    char title[12];\n\n    printf(\"What's your title?: \");\n    scanf(\"%s\", title);\n    printf(\"Hello, %11s!\\n\", title);\n}\n</code></pre> <p>Yll\u00e4 oleva koodi alustaa 12 merkki\u00e4 pitk\u00e4n arrayn. My\u00f6hemmin siit\u00e4 tulostetaan merkit 0-11. Mutta ent\u00e4p\u00e4 jos k\u00e4ytt\u00e4j\u00e4n titteli onkin jokin pitk\u00e4? Kokeile ajaa koodi siten, ett\u00e4 sy\u00f6t\u00e4t titteliksi esimerkiksi apulaiskaupunginjohtaja (23 merkki\u00e4). Syntynyt virhe on buffer overflow, ja k\u00e4ytt\u00f6j\u00e4rjestelm\u00e4 voi vastata siihen esimerkiksi virhenimell\u00e4 segmentation fault tai bus error.</p> <p>Huomaa, ett\u00e4 v\u00e4lily\u00f6nti katkaisee <code>fgets</code>:n parsimisen, joten k\u00e4yt\u00e4th\u00e4n pitk\u00e4\u00e4 yhdyssanaa.</p> <p>Kokeile t\u00e4m\u00e4n j\u00e4lkeen korvata <code>scanf</code> sen turvallisemmalla vastineella <code>fgets</code>:</p> <pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    char title[12];\n\n    printf(\"What's your title?: \");\n    fgets(title, sizeof(title), stdin);\n    printf(\"Hello, %s!\\n\", title);\n}\n</code></pre>"},{"location":"c_ohjelmointi/streams/","title":"Standardivirrat","text":""},{"location":"c_ohjelmointi/streams/#syote-kuin-syote","title":"Sy\u00f6te kuin sy\u00f6te","text":"<p>K\u00e4ytimme Yleist\u00e4-materiaalissa Zorro-peli\u00e4, jolle sy\u00f6timme n\u00e4pp\u00e4imist\u00f6\u00e4 k\u00e4ytt\u00e4en sy\u00f6tteen, kuten \"Z\" ja \"3\". Huomaa, ett\u00e4 sy\u00f6te on sy\u00f6tett\u00e4, tuli se n\u00e4pp\u00e4imist\u00f6lt\u00e4 tai tiedostosta. Tutustutaan t\u00e4h\u00e4n konseptiin hieman:</p> Bash<pre><code># Kokeile sy\u00f6tt\u00e4\u00e4 pelkk\u00e4 Z. Mink\u00e4 arvon \"n\" sai?\n$ echo \"Z\" &gt; zorro_input.txt\n$ cat zorro_input.txt | ./zorro\n\n# Lis\u00e4\u00e4 tiedostoon my\u00f6s numero ja kokeile uusiksi\n$ echo \"3\" &gt;&gt; zorro_input.txt\n$ cat zorro_input.txt | ./zorro\n\n# P.S. Varmista, ett\u00e4 ymm\u00e4rr\u00e4t, mit\u00e4 zorro_input.txt tiedosto sis\u00e4lt\u00e4\u00e4\n#      ja mit\u00e4 cat tulostaa.\n$ cat zorro_input.txt\n</code></pre> <p>Tip</p> <p>Kokeile putkituksen lis\u00e4ksi my\u00f6s sy\u00f6tteen ohjaamista tiedostosta k\u00e4ytt\u00e4en <code>&lt;</code>-merkki\u00e4.</p> Bash<pre><code>$ ./zorro &lt; zorro_input.txt\n</code></pre>"},{"location":"c_ohjelmointi/streams/#syotteen-hakeminen-stdinsta","title":"Sy\u00f6tteen hakeminen stdin:st\u00e4","text":"<p>Tutustu alla n\u00e4kyv\u00e4\u00e4n koodiin (<code>reverser.c</code>). Ennen kuin kokeilet ajaa koodia, yrit\u00e4 p\u00e4\u00e4tell\u00e4 mit\u00e4 se tekee standard inputille, joka on vakiossa <code>stdin</code>, joka on m\u00e4\u00e4ritelty <code>stdio.h</code> kirjastossa.</p> reverser.c<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define MAX_LINE_LENGTH 100\n\nvoid reverse(char str[]) {\n    int length = strlen(str);\n    for (int i = 0; i &lt; length / 2; i++) {\n        char temp = str[i];\n        str[i] = str[length - i - 1];\n        str[length - i - 1] = temp;\n    }\n}\n\nint main() {\n    char line[MAX_LINE_LENGTH];\n    while (fgets(line, MAX_LINE_LENGTH, stdin) != NULL) {\n        reverse(line);\n        printf(\"%s\", line);\n    }\n    return 0;\n}\n</code></pre> <p>Kun olet lukenut koodin huolella, k\u00e4\u00e4nn\u00e4 se bin\u00e4\u00e4ritiedostoksi ja selvit\u00e4, kuinka ohjelmaa k\u00e4ytet\u00e4\u00e4n. Kokeile ainakin seuraavia:</p> Bash<pre><code># Perus ajo. Lopeta CTRL+D tai CTRL+C.\n$ ./reverser\n\n# Heredoc-tyylinen sy\u00f6te. Etsi lis\u00e4tietoa Heredocista omatoimisesti.\n$ ./reverser &lt;&lt;'EOF'\n&gt; kissa\n&gt; koira\n&gt; EOF\n\n# Standard inputin sy\u00f6tt\u00e4minen putkittamalla\n$ ls -1 | ./reverser\n\n# Standard outputin jatkaminen putkittamalla\n$ ls -1 | ./reverser | wc -l\n</code></pre>"},{"location":"c_ohjelmointi/streams/#standard-erroriin-kirjoittaminen","title":"Standard erroriin kirjoittaminen","text":"<p>Funktio <code>printf</code> kirjoittaa aina standard outputiin. Jos haluat kirjoittaa johonkin muualle, kuten standard erroriin tai jopa tiedostoon, voit k\u00e4ytt\u00e4\u00e4 <code>fprintf</code>-funktiota.</p> errors.c<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    fprintf(stdout, \"Olen matkalla Standard Outtiin\\n\");\n    fprintf(stderr, \"Olen matkalla Standard Erroriin.\\n\");\n    return 1;\n}\n</code></pre> Kysymys <p>My\u00f6s <code>fputs</code>-funktio toimii! Kuinka k\u00e4ytt\u00e4isit fputs-funktiota fprintf:n tilalla? Huomaa:</p> <ul> <li>puts ja fputs ovat eri funktioita.</li> <li>printf ja fprintf ovat eri funktioita.</li> </ul> <p>Nyt voimme harjoitella sy\u00f6tteen ohjaamista ja virheilmoitusten k\u00e4sittely\u00e4. Tutki, mit\u00e4 seuraavat tulostavat ja minne:</p> Bash<pre><code># Komento 1\n$ ./errors\n\n# Komento 2\n./errors &gt; /dev/null\n\n# Komento 3\n./errors 2&gt; /dev/null\n\n# Komento 4\n./errors &gt; /dev/null 2&gt;&amp;1\n</code></pre> <p>Tip</p> <p>Jos et ole varma, mit\u00e4 <code>/dev/null</code>:iin p\u00e4\u00e4tyy, kokeile korvata se vaikkapa tiedostolla <code>output.log</code>.</p>"},{"location":"c_ohjelmointi/tiedostot/","title":"Tiedostot","text":"<p>Standardikirjasto sis\u00e4lt\u00e4\u00e4 funktioita, jotka ovat tarpeellisia tiedostojen k\u00e4sittelemiseksi. Alla \u00e4\u00e4rimm\u00e4isen pelkistetty esimerkki, jossa luetaan tiedosto read-only tilassa ja suljetaan se.</p> <pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    FILE *file;\n    file = fopen(\"tiedosto.txt\", \"r\");\n    // T\u00e4ss\u00e4 v\u00e4liss\u00e4 voisit tehd\u00e4 jotakin tiedoston datalla.\n    fclose(file);\n    return 0;\n}\n</code></pre> <p>Olet aiemmin k\u00e4ytt\u00e4nyt <code>fprintf</code> ja <code>fputs</code> funktioita virtaan (<code>stdout</code>, <code>stderr</code>) kirjoittamiseen. Mik\u00e4li kokeilet mouse-overia IDE:ss\u00e4 jomman kumman funktion p\u00e4\u00e4ll\u00e4, huomaat, ett\u00e4 kumpikin haluaa parametrin <code>FILE *</code>-tyyppisest\u00e4 muuttujasta. Voit sijoittaa t\u00e4h\u00e4n my\u00f6s FILE-osoittimen, joka on avattu tiedostoon. T\u00e4m\u00e4 mahdollistaa tiedostosta lukemisen ja tiedostoon kirjoittamisen.</p>"},{"location":"c_ohjelmointi/tiedostot/#muista-sulkea","title":"Muista sulkea","text":"<p>Muista aina sulkea tiedosto, kun olet valmis k\u00e4ytt\u00e4m\u00e4\u00e4n sit\u00e4. T\u00e4m\u00e4 vapauttaa resurssit ja mahdollistaa muiden ohjelmien k\u00e4ytt\u00e4\u00e4 sit\u00e4. Voit kokeilla tiedoston j\u00e4tt\u00e4mist\u00e4 auki ja ohjelman tappamista ennenaikaisesti sleep:n avulla.</p> noclose.c<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt; // &lt;== for sleep\n\nint main() {\n    FILE *file;\n    file = fopen(\"tiedosto.txt\", \"w\");\n    fputs(\"I am a line!\\n\", file);  // &lt;== fputs ei lis\u00e4\u00e4 newlinea automaattisesti\n    // sleep for 10 minutes\n    sleep(600);\n    return 0;\n}\n</code></pre> <p>Aja t\u00e4m\u00e4:</p> Bash<pre><code># Aja taustalla\n$ ./noclose &amp;\n\n# Tarkista, ett\u00e4 tiedosto on auki\n$ lsof tiedosto.txt\n\n# Katso, onko tiedostossa oikeasti mit\u00e4\u00e4n\n$ cat tiedosto.txt\n\n# Tapa ohjelma\n$ kill %1\n\n# Tarkista, sulkiko k\u00e4ytt\u00f6j\u00e4rjestelm\u00e4 tiedoston\n$ lsof tiedosto.txt\n\n# Tarkista, onko tiedostosa viel\u00e4k\u00e4\u00e4n mit\u00e4\u00e4n\n$ cat tiedosto.txt\n</code></pre>"},{"location":"c_ohjelmointi/tiedostot/#esimerkki-datan-lukeminen-ja-kirjoittaminen","title":"Esimerkki: Datan lukeminen ja kirjoittaminen","text":"<p>Alla koodi, joka lukee dataa rivi rivilt\u00e4 yhdest\u00e4 tiedostosta ja kirjoittaa ne toiseen. Toisin sanoen se suorittaa tiedoston kopioinnin.</p> copyer.c<pre><code>#include &lt;stdio.h&gt;\n\n#define MAX_LINE_LENGTH 256\n\nint main(int argc, char *argv[]) {\n    // Check if the correct number of arguments is provided\n    if (argc != 3) {\n        printf(\"Usage: %s &lt;filename_src&gt; &lt;filename_dst&gt;\\n\", argv[0]);\n        return 1;\n    }\n\n    // Open the source file in read-only mode\n    FILE *src_file = fopen(argv[1], \"r\");\n    if (src_file == NULL) {\n        fprintf(stderr, \"Failed to open %s\\n\", argv[1]);\n        return 1;\n    }\n\n    // Open the destination file in write mode\n    FILE *dst_file = fopen(argv[2], \"w\");\n    if (dst_file == NULL) {\n        fprintf(stderr, \"Failed to open %s\\n\", argv[2]);\n        fclose(src_file);\n        return 1;\n    }\n\n    // Read lines from source file and write them to destination file\n    char line[MAX_LINE_LENGTH];\n    while (fgets(line, sizeof(line), src_file) != NULL) {\n        fputs(line, dst_file);\n    }\n\n    // Close the files\n    fclose(src_file);\n    fclose(dst_file);\n\n    printf(\"File copied successfully.\\n\");\n\n    return 0;\n}\n</code></pre> <p>K\u00e4\u00e4nn\u00e4 ja aja ohjelma seuraavasti:</p> Bash<pre><code># Kopioi ja katso mit\u00e4 sis\u00e4lt\u00e4\u00e4\n$ echo \"Kissa\" &gt; src.txt\n$ ./copyer src.txt dest.txt\n$ cat dest.txt\n\n# Lis\u00e4\u00e4 rivi ja toista\n$ echo \"Koira\" &gt;&gt; src.txt\n$ ./copyer src.txt dest.txt\n$ cat dest.txt\n</code></pre>"},{"location":"c_ohjelmointi/yleista/","title":"Yleist\u00e4","text":"<p>Warning</p> <p>T\u00e4m\u00e4 C-ohjelmointi -osio ei sis\u00e4ll\u00e4 teht\u00e4v\u00e4pakettia ja on kehitys/odotustilassa; sit\u00e4 jatketaan, jos sille tulee tarve jossakin toteutuksessa. Voit kuitenkin tutustua t\u00e4h\u00e4n raakileeseen vapaasti.</p> <p>T\u00e4m\u00e4 materiaali ei ole C-ohjelmointikielen kurssi, muttta C-kielen kirjoittaminen ja k\u00e4\u00e4nt\u00e4minen esitell\u00e4\u00e4n kurssilla Linuxin n\u00e4k\u00f6kulmasta. On oletus, ett\u00e4 osaat ohjelmointia jo jollakin kielell\u00e4!</p> <p>Mik\u00e4li funktiot ja kontrollirakenteet ja niihin liittyv\u00e4t k\u00e4skyt (if, while, for, break, continue) eiv\u00e4t ole tuoreessa muistissa, t\u00e4m\u00e4 materiaali toimii hyv\u00e4n\u00e4 muistinvirkist\u00e4j\u00e4n\u00e4 samalla. C-kieli on matalan abstraktiotason kieli, joten siin\u00e4 pit\u00e4\u00e4 l\u00e4hes kaikki se koodata itse (tai k\u00e4ytt\u00e4\u00e4 kirjaston implementointia), mik\u00e4 on korkeamman tason kieless\u00e4 (esim. Pythonissa) built-in ominaisuus.</p> <p>Materiaalin tukena voi k\u00e4ytt\u00e4\u00e4 esimerkiksi seuraavia l\u00e4hteit\u00e4:</p> <ul> <li>Online-tutoriaalit:<ul> <li>W3Schools: C Tutorial</li> <li>Ohjelmointiputka: C-ohjelmointi</li> </ul> </li> <li>Kirjat<ul> <li>C for Python Programmers (HTML, 2011)</li> <li>Modern C (PDF, 2019 painos on saatavilla ilmaiseksi.)</li> <li>... ja monet muut kirjat EbookFoundation free-programming-books-listalla</li> </ul> </li> <li>Haasteita ja teht\u00e4vi\u00e4<ul> <li>Computer Science by Example</li> <li>Exercism: C</li> <li>LeetCode: C</li> </ul> </li> </ul>"},{"location":"c_ohjelmointi/yleista/#lahdekoodi","title":"L\u00e4hdekoodi","text":"<p>C-kielen l\u00e4hdekoodi on tavallinen tekstitiedosto. Sen voit luoda Linuxissa esim. <code>nano</code> tai <code>vim</code> cli-tekstieditoreilla tai vaikkapa Visual Studio Code:lla. Tyypillisesti tiedostop\u00e4\u00e4te on <code>.c</code>.</p> hello.c<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    puts(\"Hello, world!\");\n    return 0;\n}\n</code></pre> <p>Question</p> <p>Tutustu siihen, mik\u00e4 stdio.h on. Saat siit\u00e4 lis\u00e4\u00e4 tietoa lukemalla <code>man 3 stdio</code> sivun tai vastaavan sivun Internetist\u00e4 esimerkiksi Die.net: stdio-sivustolta.</p>"},{"location":"c_ohjelmointi/yleista/#kaantaja","title":"K\u00e4\u00e4nt\u00e4j\u00e4","text":"<p>Toisin kuin tulkattavat kielet (kuten Python ja JavaScript), C tulee k\u00e4\u00e4nt\u00e4\u00e4 bin\u00e4\u00e4ritiedostoksi. T\u00e4t\u00e4 varten tarvitset k\u00e4\u00e4nt\u00e4j\u00e4n. Linuxissa k\u00e4\u00e4nt\u00e4j\u00e4 on tyypillisesti GNU <code>gcc</code>, mutta my\u00f6s muita vaihtoehtoja, kuten <code>clang</code> l\u00f6ytyy. Windowsissa tarvitset MinGW:n (Minimalistic GNU for Windows), jotta sinulla on k\u00e4yt\u00f6ss\u00e4si <code>gcc</code>. Vaihtoehtoisesti voisit k\u00e4ytt\u00e4\u00e4 Microsoftin kaupallista C/C++-k\u00e4\u00e4nt\u00e4j\u00e4\u00e4, joka asennetaan tyypillisesti Visual Studion mukana. Huomaa, ett\u00e4 Visual Studio ja Visual Studio Code ovat eri ohjelmia.</p> Bash<pre><code># K\u00e4\u00e4nn\u00e4 hello.c-tiedosto hello bin\u00e4\u00e4riksi\n$ gcc -o hello hello.c\n</code></pre> <p>Tip</p> <p>Gcc:n optio <code>-o &lt;tiedostonimi&gt;</code> antaa sinun asettaa tiedostolle nimen. Windowsissa executable eli ajettava tiedosto olisi tyypillisesti p\u00e4\u00e4tteelt\u00e4\u00e4n <code>.exe</code>, mutta Linuxissa executable tunnistaa tiedosto-oikeuksista. Kokeile, mik\u00e4 tiedostonimeksi tulee, jos j\u00e4t\u00e4t tiedostonimen kokonaan m\u00e4\u00e4rittelem\u00e4tt\u00e4 eli ajat <code>gcc hello.c</code>.</p>"},{"location":"c_ohjelmointi/yleista/#binaarin-ajaminen","title":"Bin\u00e4\u00e4rin ajaminen","text":"<p>K\u00e4\u00e4nt\u00e4j\u00e4 luo ajettavan tiedoston. Voit tarkistaa t\u00e4m\u00e4n <code>ls -l tiedostonnimi</code> komennolla. Huomaat, mill\u00e4 k\u00e4ytt\u00e4j\u00e4tyypeill\u00e4 on <code>x</code>-oikeus tiedostoon. Tiedoston ajaminen itsess\u00e4\u00e4n on helppoa. Kuten kurssin muissa materiaaleissa on opetettu, sinun tulee antaa absoluuttinen tai relatiivinen polku bin\u00e4\u00e4riin, ellei tiedosto l\u00f6ydy <code>$PATH</code>:sta. Meid\u00e4n nykyinen kansio ei oletettavasti ole PATH-ymp\u00e4rist\u00f6muuttujan kansioiden listassa, joten koodin voi ajaa relatiivisella polulla n\u00e4in:</p> Bash<pre><code>$ ./hello\n</code></pre> <p>Tip</p> <p>Huomaa, ett\u00e4 <code>./</code>-merkint\u00e4 tarkoittaa nykyist\u00e4 kansioa. Voit ajaa toisessa hakemistossa olevan bin\u00e4\u00e4rin antamalla absoluuttisen tai relatiivisen polun bin\u00e4\u00e4riin.</p> Bash<pre><code># Absoluuttinen polku\n$ /home/kayttaja/ohjelmat/hello\n\n# Relatiivinen polku\n$ ../toinenkansio/hello\n</code></pre>"},{"location":"c_ohjelmointi/yleista/#syntaksiin-tutustuminen","title":"Syntaksiin tutustuminen","text":"zorro.c<pre><code>/*\n* Arvaa Zorron etunimen ensimm\u00e4inen kirjain ja voitat pelin haluamasi m\u00e4\u00e4r\u00e4n kertoja.\n*/\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid zorro(int n)\n{\n    for (int i = 0; i &lt; n; i++)\n    {\n        printf(\"Zorro voitti %d. kerran!\\n\", i + 1);\n    }\n}\n\nint main()\n{\n    char kirjain[2];\n    char maara[3];\n    int n;\n\n    puts(\"Anna kirjain (vihje Z): \");\n    scanf(\"%s\", kirjain);\n\n\n    if (kirjain[0] == 'Z')\n    {\n        puts(\"Kuinka monta kertaa haluat voittaa?: \");\n        scanf(\"%s\", maara);\n\n        n = atoi(maara);\n        if (n &lt; 1)\n        {\n            printf(\"Ep\u00e4sopiva m\u00e4\u00e4r\u00e4 (%d)! Zorron pit\u00e4\u00e4 voittaa \", n);\n            puts(\"v\u00e4hint\u00e4\u00e4n kerran. Yrit\u00e4 uudelleen.\");\n            return EXIT_FAILURE;\n        }\n        zorro(n);\n    }\n    else\n    {\n        puts(\"Game over! Zorro h\u00e4visi.\");\n    }\n\n    return 0;\n}\n</code></pre> <p>Question</p> <p>Etsi koodista:</p> <ol> <li>Funktion <code>main</code> return type eli palautuvan muuttujan tietotyyppi</li> <li>Funktion <code>zorro</code> return type.</li> <li>Muuttujan <code>kirjain</code> tyyppi.</li> <li>Miksi kirjaimen per\u00e4ss\u00e4 on <code>[2]</code>? Miksei <code>[1]</code>? Vihjesana: sentinel.</li> <li>Muuttujan <code>maara</code> tyyppi.</li> <li>Mit\u00e4 atoi() funktio tekee ja miss\u00e4 se on m\u00e4\u00e4ritelty? Voit etsi\u00e4 C-kielen dokumentaatiota DevDocs sivustolla.</li> <li>Muuttujan <code>n</code> mahdollinen maksimiarvo k\u00e4ytt\u00e4j\u00e4sy\u00f6tteen perusteella.</li> <li>Loopin <code>if</code> ehto</li> <li>Kuinka <code>puts</code> ja <code>printf</code> eroavat toisistaan? Miss\u00e4 funktiot on m\u00e4\u00e4ritelty?</li> <li>Mik\u00e4 on <code>EXIT_FAILURE</code>-muuttuja? Miss\u00e4 se on m\u00e4\u00e4ritelty? Mik\u00e4 sen arvo on numerona?</li> </ol> <p>Kun olet suorittanut yll\u00e4 olevan teht\u00e4v\u00e4n, kokeile ajaa yll\u00e4 oleva koodi siten, ett\u00e4 ohjelma suoritetaan <code>return EXIT_FAILURE;</code> riviin. Kuinka ohjelma k\u00e4ytt\u00e4ytyy kun ajat sit\u00e4? Kokeila alla olevia komentoja:</p> Bash<pre><code># H\u00e4vi\u00e4 peli tarkoituksella ep\u00e4sopivaan m\u00e4\u00e4r\u00e4\u00e4n\n$ ./zorro\nAnna kirjain (vihje Z): &lt;anna oikea kirjain&gt;\nKuinka monta kertaa haluat voittaa?: &lt;keksi ep\u00e4sopiva vastaus&gt;\n\n# Katso, mit\u00e4 t\u00e4m\u00e4 ymp\u00e4rist\u00f6muuttuja sis\u00e4lt\u00e4\u00e4.\n$ echo $?\n\n# Vertaa t\u00e4t\u00e4 johonkin tutun applikaatioon vikatilanteessa (esim. ls)\n$ ls /foldernotexists\n$ echo $?\n</code></pre>"},{"location":"cli/standardivirrat/","title":"Standardivirrat","text":"<p>Tyypillinen ohjelma ottaa sy\u00f6tteens\u00e4 n\u00e4pp\u00e4imist\u00f6lt\u00e4 tai tiedostosta ja tulostaa palautuvan virran n\u00e4yt\u00f6lle. T\u00e4h\u00e4n ty\u00f6h\u00f6n osallistuu kolme eri standardivirtaa:  standardisy\u00f6te (stdin), standardituloste (stdout) ja standardivirhe (stderr). N\u00e4it\u00e4 striimej\u00e4 edustavat luvut 0, 1 ja 2 samassa j\u00e4rjestyksess\u00e4.</p> <pre><code>flowchart\n\n    subgraph exec\n        ohjelma\n    end\n\n    subgraph prompt\n        n\u00e4pp\u00e4imist\u00f6\n        n\u00e4ytt\u00f6\n    end\n    n\u00e4pp\u00e4imist\u00f6 --&gt;|stdin| ohjelma\n    ohjelma --&gt; |stdout|n\u00e4ytt\u00f6\n    ohjelma .-&gt; |stderr|n\u00e4ytt\u00f6</code></pre>"},{"location":"cli/standardivirrat/#muita-lahteita","title":"Muita l\u00e4hteit\u00e4","text":"<p>T\u00e4m\u00e4n luvun lis\u00e4ksi sinua saattavat auttaa oppimisessa erilaiset cheat sheetit, kuten:</p> <ul> <li>PDF: Bash Redirections Cheat Sheet</li> <li>Bash One-Liners Explained, Part III: All about redirections</li> </ul>"},{"location":"cli/standardivirrat/#uudelleenohjaus","title":"Uudelleenohjaus","text":"<p>Standardivirtaa voi uudelleenohjata tiedostoihin tai tiedostoista. Kohdetiedosto luodaan jos sit\u00e4 ei ole olemassa.</p> Operaattori <code>&gt;</code> tai <code>1&gt;</code> Ohjaa stdoutin tiedostoon. <code>2&gt;</code> Ohjaa stderrorin tiedostoon <code>&amp;&gt;</code> Ohjaa kummatkin tiedostoon <code>&gt;&gt;</code> Tekee saman kuin mik\u00e4 tahansa aiempi <code>&gt;</code>, mutta ei kirjoita tiedostoa alusta alkaen vaan jatkaa (eng. append) tiedostoa. <code>&lt;</code> Tuo stdinputin tiedostosta. T\u00e4ll\u00f6in syntaksi olisi <code>command &lt; input.txt &gt; output.txt</code>, mik\u00e4 on tosin useimmiten sama kuin <code>command input.txt &gt; output.txt</code> <code>2&gt;&amp;1</code> Hieman outolintu, joka ohjaa stderrorin sis\u00e4ll\u00f6n stdoutputtiin. Stdoutput sis\u00e4lt\u00e4\u00e4 jatkossa kummatkin. <code>&gt;&amp;2</code> Ohjaa stdoutin stderroriin. N\u00e4pp\u00e4r\u00e4 tapa tulostaa virhestriimiin skriptiss\u00e4. <p>K\u00e4yt\u00e4nn\u00f6ss\u00e4 t\u00e4m\u00e4 mahdollista muun muassa komennon ajamisen siten, ett\u00e4 onnistunut output kirjoitetaan yhteen tiedostoon, errorit toiseen:</p> Bash<pre><code># Stdout ja Stderr eri tiedostoihin\nsomecommand &gt; success.output 2&gt; errors.log\n\n# Stderr bittiavaruuteen\nfind / -name \".bashrc\" 2&gt; /dev/null\n</code></pre>"},{"location":"cli/standardivirrat/#putket","title":"Putket","text":"<p>Standardivirran voi my\u00f6hemmin p\u00e4\u00e4tt\u00e4\u00e4 putkittaa (<code>piping</code>) k\u00e4ytt\u00e4en putkisymbolia (<code>|</code>) seuraavalle ohjelmalle. Tarkkaile, mit\u00e4 alla oleva liuta komentoja tekee:</p> Bash<pre><code>$ echo \"c\" &gt; myfile   # Ylikirjoita\n$ echo \"b\" &gt;&gt; myfile  # Jatka\n$ echo \"a\" &gt;&gt; myfile  # Jatka\n$ cat myfile          # Tulosta\nc\nb\na\n\n$ cat myfile | sort | tr [:lower:] [:upper:] # J\u00e4rjest\u00e4 ja kapitalisoi\nA\nB\nC\n</code></pre> <p>Yll\u00e4 oleva esimerkki ajaa komennon <code>cat</code>, jonka standard output siirtyy <code>sort</code> ohjelman inputiksi, jonka standard output siirtyy <code>tr</code>-ohjelman inputiksi, ja lopulta sen tuloste palautuu takaisin k\u00e4ytt\u00e4j\u00e4lle. Lopputuloksena on alkuper\u00e4inen sy\u00f6te aakkosj\u00e4rjestyksess\u00e4, kirjaimet vaihdettuna suuriin kirjaimiin. Lis\u00e4\u00e4 esimerkkej\u00e4 l\u00f6ytyy suomeksi t\u00e4\u00e4lt\u00e4: Standardivirrat \u2013 Linux.fi.</p> <p>Alla sama graafisena:</p> <pre><code>flowchart\n\n    subgraph exec\n        cat --&gt; |stdout|sort\n        cat .-&gt; |stderr|sort\n        sort --&gt;|stdout|tr\n        sort .-&gt;|stderr|tr\n    end\n\n    subgraph prompt\n        n\u00e4pp\u00e4imist\u00f6\n        n\u00e4ytt\u00f6\n    end\n    myfile --&gt;|stdin|cat\n    n\u00e4pp\u00e4imist\u00f6 --&gt;|run| cat\n    tr --&gt; |stdout|n\u00e4ytt\u00f6\n    tr .-&gt; |stderr|n\u00e4ytt\u00f6</code></pre>"},{"location":"cli/standardivirrat/#here-document","title":"Here document","text":"<p>Here document on tapa sy\u00f6tt\u00e4\u00e4 useita rivej\u00e4 komentoriville. T\u00e4m\u00e4 on hy\u00f6dyllist\u00e4 esimerkiksi silloin, kun haluat luoda tiedoston sis\u00e4ll\u00f6n komentorivilt\u00e4. T\u00e4m\u00e4 onnistuu esimerkiksi seuraavasti:</p> Bash<pre><code>$ cat &gt; tiedosto.txt &lt;&lt; EOF\n&gt; T\u00e4m\u00e4 on ensimm\u00e4inen rivi.\n&gt; T\u00e4m\u00e4 on toinen rivi.\n&gt; EOF\n</code></pre> <p>Lue aiheesta lis\u00e4\u00e4 esimerkiksi Wikipedia: Here document.</p>"},{"location":"cli/standardivirrat/#tehtavat","title":"Teht\u00e4v\u00e4t","text":"<p>Teht\u00e4v\u00e4: tee</p> <p>Selvit\u00e4, mit\u00e4 komento <code>tee</code> tekee. Se liittyy standardivirtoihin, mutta kuinka?</p> <p>Teht\u00e4v\u00e4: Ohjaa stdout tiedostoon</p> <p>Aja valitsemasi komento siten, ett\u00e4 sen stdout kirjoitetaan tiedostoon. Kenties <code>ls</code>, <code>diff</code> tai <code>grep</code>?</p> <p>Voit esimerkiksi kirjoittaa <code>ls</code>-komennon tulosteen <code>list-of-my-downloads.txt</code>-tiedostoon. Mit\u00e4 <code>ls</code>-komennon argumentteja kannattaa k\u00e4ytt\u00e4\u00e4, jotta tulosta ei sis\u00e4ll\u00e4 muuta kuin tiedostojen nimet <code>~/Downloads/</code> hakemistossa?</p> <p>Teht\u00e4v\u00e4: Ohjaa stderr tiedostoon</p> <p>Aja valitsemasi komento siten, ett\u00e4 se tuottaa virheit\u00e4. Kirjoita virheet tiedostoon.</p> <p>Esimerkiksi voit k\u00e4ytt\u00e4\u00e4 komentoa <code>find</code> ja etsi\u00e4 tiedostoja jostakin lokaatiosta, mihin sinulla ei ole oikeuksia.</p> <p>Teht\u00e4v\u00e4: PATH ja putket</p> <p>Tutustu ymp\u00e4rist\u00f6muuttujan PATH sis\u00e4lt\u00f6\u00f6n. T\u00e4m\u00e4 ymp\u00e4rist\u00f6muuttuja tulee tuntea niin Linux kuin Windows-ymp\u00e4rist\u00f6ss\u00e4. Tavallisesti se on kaksoispisteell\u00e4 erotettu lista. Tulosta PATH muuttujan siten, ett\u00e4 k\u00e4yt\u00e4t putkia ja <code>tr</code> sek\u00e4 <code>nl</code>-ohjelmia. Haluttu tulos on esimerkiksi:</p> <pre><code> 1 /home/you/.local/bin\n 2 /opt/homebrew/bin\n...\n12 /usr/local/bin\n</code></pre>"},{"location":"cli/startup/","title":"Startup-tiedostot","text":"<p>T\u00e4ss\u00e4 luvussa k\u00e4sittelemme shellin startup-tiedostoja (engl. startup files, initialization files). N\u00e4m\u00e4 tiedostot m\u00e4\u00e4ritt\u00e4v\u00e4t ymp\u00e4rist\u00f6n, jossa shell k\u00e4ynnistyy. </p> <p>Tip</p> <p>Olet jo itse asiassa muokannut n\u00e4it\u00e4! Aiemmassa luvussa Ubuntu opiskelukuntoon muokkasit tiedostoa <code>~/.bashrc</code> useassakin eri kohtaa. Selkein muutos on <code>.bashrc</code>-tiedostoon tehdyt muutokset pyenv-ohjelman asennuksen yhteydess\u00e4.</p> <p>Alla kertauksen vuoksi:</p> Bash (kertausta!)<pre><code>echo 'export PYENV_ROOT=\"$HOME/.pyenv\"' &gt;&gt; ~/.bashrc\necho 'command -v pyenv &gt;/dev/null || export PATH=\"$PYENV_ROOT/bin:$PATH\"' &gt;&gt; ~/.bashrc\necho 'eval \"$(pyenv init -)\"' &gt;&gt; ~/.bashrc\n</code></pre> <p>Aiemmat luvut ovat esitelleen sinulle perusteet Bash-komennoista, tiedostoista ja terminaalista, joten on sopiva aika tutustua l\u00e4hemmin shelliin. Emme k\u00e4sittele shelli\u00e4 erityisen yleismaailmallisesti vaan keskitymme l\u00e4hinn\u00e4 startup-tiedostoihin, koska n\u00e4iden muokkaaminen on hyvinkin Linux perusteet -tason taito.</p> <p>Warning</p> <p>T\u00e4ss\u00e4 luvussa mainittujen tiedostojen muokkaamisen kanssa kannattaa olla tarkkana. Jos aiheutat tiedostoon ikuisen tai syktaksivirheest\u00e4 johtuvan muun ongelman, voi olla, ett\u00e4 et saa esimerkiksi Terminaali-sovellusta auki, koska se ajaa startup-tiedostot. T\u00e4ll\u00f6in joudut k\u00e4ytt\u00e4m\u00e4\u00e4n virtuaaliterminaalia, joka on k\u00e4ytett\u00e4viss\u00e4 painamalla <code>ctrl+alt+F3</code> ja kirjautumalla sis\u00e4\u00e4n.</p> <p>Jos et p\u00e4\u00e4se edes t\u00e4h\u00e4n, saatat joutua k\u00e4ytt\u00e4\u00e4 Live-USB:lt\u00e4 k\u00e4ynnistetty\u00e4 Linuxia tai Recovery Modea.</p>"},{"location":"cli/startup/#eri-shellit","title":"Eri shellit","text":"<p>Shellin startup-tiedostot vaihtelevat k\u00e4ytetyn shellin mukaan. T\u00e4ss\u00e4 dokumentissa tutustutaan rinnakkain kahteen suosituimpaan shelliin: bash ja zsh. Bash on oletusshelli useimmissa Linux-jakeluissa. Bash on t\u00e4st\u00e4 syyst\u00e4 t\u00e4m\u00e4n dokumentin keski\u00f6ss\u00e4, mutta sivussa k\u00e4sitell\u00e4\u00e4n my\u00f6s Z-shelli\u00e4.</p>"},{"location":"cli/startup/#ohjekirjat","title":"Ohjekirjat","text":"<p>Tulet tarvitsemaan avuksi n\u00e4iden kummankin ohjekirjat. Alla on linkit n\u00e4iden PDF-versioihin. Kummastakin l\u00f6ytyy my\u00f6s HTML-versiot, jos kyseinen formaatti on sinulle sopivampi.</p> <ul> <li>PDF: Bash Reference Manual</li> <li>PDF: A User's Guide to the Z-Shell</li> </ul>"},{"location":"cli/startup/#eri-tiedostot","title":"Eri tiedostot","text":"<p>Se, mit\u00e4 startup-tiedostoja ajetaan, riippuu siit\u00e4, kuinka Bash tai Zsh on k\u00e4ynnistetty. Kaksi t\u00e4rkeint\u00e4 tekij\u00e4\u00e4 ovat se, onko shell k\u00e4ynnistetty \"login shellin\u00e4\" ja onko se \"interaktiivinen\". Tiivistetty selitys n\u00e4ist\u00e4 on:</p> <ul> <li>Login shell: Bash on k\u00e4ynnistynyt login-prosessin yhteydess\u00e4. T\u00e4m\u00e4 tapahtuu esimerkiksi, kun kirjaudut sis\u00e4\u00e4n terminaaliin. T\u00e4m\u00e4 on helpointa tehd\u00e4 painamalla ++ctrl+alt+F3++ ja kirjautumalla sis\u00e4\u00e4n. Huomaa, ett\u00e4 gnome-terminal ei tyypillisesti k\u00e4ynnist\u00e4 Bashia login-shellin\u00e4: GNOME on jo itsess\u00e4\u00e4n suorittanut loginin, ja pseudoterminaali on sen child-prosessi.</li> <li>Interactive shell: Shell on k\u00e4ynnistetty niin, ett\u00e4 k\u00e4ytt\u00e4j\u00e4 voi sy\u00f6tt\u00e4\u00e4 komentoja eli sen stdin, stdout ja stderr ovat kiinnitetty terminaaliin.</li> </ul> <p>N\u00e4ihin tutustutaan alla tarkemmin.</p>"},{"location":"cli/startup/#asetusten-kaivaminen-esille","title":"Asetusten kaivaminen esille","text":"<p>Selvitet\u00e4\u00e4n shell-komentojen avulla, onko nykyinen istuntosi login ett\u00e4 onko se interaktiivinen.</p>"},{"location":"cli/startup/#interaktiivinen","title":"Interaktiivinen?","text":"<p>Muuttuja <code>-</code> kertoo, onko shell interaktiivinen. Voit tarkistaa sen seuraavalla komennolla:</p> Bash tai Zsh<pre><code>echo $-\n</code></pre> <p>Ymp\u00e4rist\u00f6st\u00e4 riippuen t\u00e4m\u00e4 voi palauttaa eri arvoja. Alla on tuoreen Ubuntu 24.04:n tuloste sek\u00e4 macOS:n Zsh:n tuloste siten, ett\u00e4 Zsh:ll\u00e4 on Oh My Zsh -lis\u00e4osa asennettuna.</p> BashZsh stdout<pre><code>himBHs\n</code></pre> stdout<pre><code>569JNRXZghiklms\n</code></pre> <p>Lista on pitk\u00e4 ja reilusti t\u00e4m\u00e4n kurssin skoopin ulkopuolella. T\u00e4ss\u00e4 materiaalissa keskitymme l\u00e4hinn\u00e4 yhteen: <code>i</code>-kirjain tarkoittaa, ett\u00e4 shell on interaktiivinen. Ja kumpikin n\u00e4ist\u00e4 on, mink\u00e4 voisi my\u00f6s arvata siit\u00e4, ett\u00e4 k\u00e4yt\u00e4t sit\u00e4 interaktiivisesti terminaalissa.</p>"},{"location":"cli/startup/#login","title":"Login?","text":"<p>Z-shellin tapauksessa me tiet\u00e4isimme t\u00e4m\u00e4n jo. Yll\u00e4 olevassa esimerkiss\u00e4 Zsh on k\u00e4ynnistetty login-shellin\u00e4, koska <code>l</code>-kirjain on mukana. Vaihtoehtoisesti voit ajaa t\u00e4m\u00e4n komennon, joka l\u00f6ytyy Z-shellin manuaalista:</p> Zsh<pre><code>if [[ -o login ]]; then; print yes; else; print no; fi\n</code></pre> stdout<pre><code>yes\n</code></pre> <p>Bash ei ilmoita \"login\"-tietoa l-kirjaimella, joten sit\u00e4 pit\u00e4\u00e4 kaivaa v\u00e4h\u00e4n kauempaa. Se l\u00f6ytyy muun muassa ymp\u00e4rist\u00f6muuttujasta BASHOPTS:</p> Bash<pre><code>echo $BASHOPTS | tr \":\" \"\\n\"\n</code></pre> <p>Jos kokeilet yll\u00e4 olevaa komentoa virtuaaliterminaalissa (esim. Ctrl+Alt+F3 ), saat tulosteen, josta l\u00f6ytyy my\u00f6s <code>login_shell</code>.</p> <p>Warning</p> <p>Huomaa, ett\u00e4 login-shellin voi k\u00e4ynnist\u00e4\u00e4 my\u00f6s mik\u00e4 tahansa prosessi, mik\u00e4 k\u00e4ynnist\u00e4\u00e4 shellin. Esimerkiksi jokin terminaalisovellus voi antaa shellille <code>--login</code>-argumentin, jolloin se k\u00e4ynnistyy login-shellin\u00e4.</p>"},{"location":"cli/startup/#mita-ajetaan-milloin","title":"Mit\u00e4 ajetaan milloin?","text":""},{"location":"cli/startup/#bash","title":"Bash","text":"<p>Nyt kun ymm\u00e4rr\u00e4mme, mik\u00e4 on login shell ja interaktiivinen shell, voimme tarkastella, mit\u00e4 startup-tiedostoja Bash lukee miss\u00e4kin tilanteessa. T\u00e4h\u00e4n auttaa yll\u00e4 mainitun manuaalin luku 6.2, joka k\u00e4sittelee Bashin k\u00e4ynnistyst\u00e4.</p> <ul> <li>Login shell, interaktiivinen: <ul> <li>Ensin ajetaan: <code>/etc/profile</code></li> <li>Sitten ajetaan, jos l\u00f6ytyy: <code>.bash_profile</code></li> <li>... jos ei l\u00f6ytynyt:  <code>.bash_login</code></li> <li>... jos ei l\u00f6ytynyt: <code>.profile</code></li> </ul> </li> <li>Non-login shell, interaktiivinen:<ul> <li>Ensin ajetaan: <code>.bashrc</code></li> </ul> </li> <li>Non-login shell, ei interaktiivinen:<ul> <li>Ei ajeta mit\u00e4\u00e4n startup-tiedostoja.</li> </ul> </li> </ul> <p>Jos mietit, miss\u00e4 tilanteessa sinulla on non-login ei-interaktiivinen shell, niin se on esimerkiksi silloin, kun annat sille tiedoston tai komennon inputtina. Tyypillisin tilanne on Bash-skriptin ajaminen.</p> <p>Tip</p> <p>Olet ainakin kerran jo ajanut scriptin! Ubuntu opiskeluk\u00e4ytt\u00f6\u00f6n ohjeesta l\u00f6ytyy seuraava rivi:</p> Bash<pre><code># Run installation script\ncurl https://pyenv.run | bash\n</code></pre> <p>Olet my\u00f6s saattanut ajaa skriptin harhoitust\u00f6iden ohessa, kuten:</p> Bash<pre><code># Make it executable\nchmod +x script_given_by_teacher.sh\n# Run it like this:\n./script_given_by_teacher.sh\n# Or like this:\nbash script_given_by_teacher.sh\n</code></pre>"},{"location":"cli/startup/#zsh","title":"Zsh","text":"<p>Aivan kuten Bashin kanssa, my\u00f6s Z-shellin kohdalla manuaalin lukeminen auttaa. Luvun 2, What to put in your startup files, alla on selitetty, mit\u00e4 tiedostoja Zsh lukee. Tarkastellaan t\u00e4t\u00e4 taulukkona, jossa vasen sarake on login shell ja oikea sarake on interaktiivinen shell. Skriptit ajetaan ylh\u00e4\u00e4lt\u00e4 alas j\u00e4rjestyksess\u00e4 sen mukaan, l\u00f6ytyyk\u00f6 niit\u00e4 vai ei.</p> Script Login Interactive <code>/etc/zshenv</code> X X <code>~/.zshenv</code> X X <code>/etc/zprofile</code> X <code>~/.zprofile</code> X <code>/etc/zshrc</code> X <code>~/.zshrc</code> X <code>/etc/zlogin</code> X <code>~/.zlogin</code> X"},{"location":"cli/startup/#yhteenveto","title":"Yhteenveto","text":"<p>Mik\u00e4 siis kuuluu minne? Jos tarvitset jotakin pysyv\u00e4\u00e4, joka on saatavilla my\u00f6s virtuaaliterminaalissa (eli GNOME:n ulkopuolella), laita se:</p> <ul> <li>Bash: <code>.bash_profile</code> tai <code>.bash_login</code> tai <code>.profile</code></li> <li>Zsh: <code>.zprofile</code> tai <code>.zlogin</code></li> </ul> <p>Jos tarvitset jotakin, joka on saatavilla ainakin pseudoterminaalissa, laita se:</p> <ul> <li>Bash: <code>.bashrc</code></li> <li>Zsh: <code>.zshrc</code></li> </ul> <p>Z-shellin tapauksessa voit my\u00f6s k\u00e4ytt\u00e4\u00e4 <code>.zshenv</code>-tiedostoa, joka ajetaan aina, kun Zsh k\u00e4ynnistyy. T\u00e4m\u00e4 on hyv\u00e4 paikka asettaa ymp\u00e4rist\u00f6muuttujia, jotka ovat k\u00e4ytett\u00e4viss\u00e4 kaikissa Zsh-sessioissa. T\u00e4m\u00e4n k\u00e4ytt\u00f6 ei kuitenkaan ole mill\u00e4\u00e4n tavoin pakollista.</p>"},{"location":"cli/startup/#tehtavat","title":"Teht\u00e4v\u00e4t","text":"<p>Teht\u00e4v\u00e4: Hello world</p> <p>Lis\u00e4\u00e4 tiedostoon <code>.bashrc</code> rivi, joka tulostaa \"Hello world! I am , child of \" joka kerta, kun avaat uuden Bash-terminaalin. Komennossa PID on process ID, joihin tutustutaan my\u00f6hemmin t\u00e4ll\u00e4 kurssilla. <p>Lis\u00e4tt\u00e4v\u00e4 rivi on:</p> <pre><code>echo \"Hello world! I am $$ child of $PPID\"\n</code></pre> <p>Warning</p> <p>Ole varovainen typojen kanssa. T\u00e4m\u00e4n tiedoston muokkaaminen voi tehd\u00e4 Terminaalin avaamisen vaikeaksi. Jos et saa jatkossa Terminaalia auki, k\u00e4y muokkaamassa tiedostoa tekstieditorilla kuten Visual Studio Code.</p> <p>Teht\u00e4v\u00e4: Asenna Oh My Zsh</p> <p>Mene Oh My Zsh -sivulle ja seuraa sielt\u00e4 l\u00f6ytyvi\u00e4 ohjeita. Sinun tulee ajaa yksi komento, joka asentaa Oh My Zsh:n. Lue komennon tuloste tarkkaan, sill\u00e4 se saattaa sis\u00e4lt\u00e4\u00e4 ohjeita, jotka sinun tulee suorittaa. Yksi n\u00e4ist\u00e4 on t\u00e4ss\u00e4:</p> <pre><code>Time to change your default shell to zsh:\nDo you want to change your default shell to zsh? [Y/n]\n</code></pre> <p>Paina Y ja enter, jonka j\u00e4lkeen sinun default shell on zsh eli <code>/usr/bin/zsh</code>. Voit varmistaa t\u00e4m\u00e4n ajamalla <code>grep $USER /etc/passwd</code>.</p> <p>Teht\u00e4v\u00e4: Vaihda Oh My Zsh teema</p> <p>Oh My Zsh tulee oletuksena bobbyrussell teeman kanssa. Voit vaihtaa teemaa muokkaamalla tiedostoa <code>~/.zshrc</code>. Tutustu tiedoston sis\u00e4lt\u00f6\u00f6n: se sis\u00e4lt\u00e4\u00e4 linkkej\u00e4 ja ohjeita, kuinka voit vaihtaa teemaa tai asentaa plugineita. Vaihda v\u00e4hint\u00e4\u00e4n teemaa, mutta voit kokeilla my\u00f6s plugineita.</p> <p>Teht\u00e4v\u00e4: Vaihda Bashiin (ja halutessasi takaisin)</p> Bash<pre><code># Vaihda\nchsh -s $(which bash)\n\n# Tarkista\ngrep $USER /etc/passwd\n</code></pre> <p>Huomaa, ett\u00e4 muutos ei ole v\u00e4litt\u00f6m\u00e4sti t\u00e4ysin k\u00e4yt\u00f6ss\u00e4. T\u00e4m\u00e4 siksi, ett\u00e4 default shell muutokset astuvat voimaan seuraavan loginin yhteydess\u00e4. Loggaa Ubuntusta ulos ja takaisin sis\u00e4\u00e4n tai k\u00e4ynnist\u00e4 koko tietokone uusiksi. Mik\u00e4li kerkesit jo tyk\u00e4sty\u00e4 Zsh:iin, voit vaihtaa takaisin ajamalla saman komennon uusiksi siten, ett\u00e4 <code>bash</code> korvataan <code>zsh</code>:lla. Jos alat k\u00e4ytt\u00e4\u00e4 Zsh:aa, kannattaa tutustua ainakin pintapuoleisesti ArchWiki: Zsh-sivuun, joka sis\u00e4lt\u00e4\u00e4 tiiviin tietopaketin Zsh:sta ja sen k\u00e4yt\u00f6st\u00e4.</p>"},{"location":"cli/terminaali/","title":"Terminaali","text":""},{"location":"cli/terminaali/#terminologiaa","title":"Terminologiaa","text":"<p>Linuxia voi k\u00e4ytt\u00e4\u00e4 usealla eri k\u00e4ytt\u00f6liittym\u00e4ll\u00e4. Termist\u00f6 tulee yll\u00e4tt\u00e4v\u00e4nkin kaukaa historiasta, lue koko tarina t\u00e4\u00e4lt\u00e4: A Guide to the Terminal, Console, and Shell (thevaluable.dev). Alla sama aihe lyhyemmin suomeksi. </p> <p>Kaukokirjoitin (eng. teleprinter), suurimpana valmistaja teletype (<code>=&gt; tty</code>), oli fyysinen laite, joka koostui n\u00e4pp\u00e4imist\u00f6st\u00e4 ja tulostimesta, ja joka l\u00e4hetti viestin vastaanottajalle esimerkiksi puhelinlankoja pitkin. Viesti tulostettiin paperille. N\u00e4it\u00e4 k\u00e4ytettiin jo 1800-luvun lopulla. My\u00f6hemmin, tietokoneiden aikakaudella eli 1900-luvun puoliv\u00e4lin tienoilla, kaukokirjoittimia (<code>muista: tty</code>) k\u00e4ytettiin l\u00e4hett\u00e4m\u00e4\u00e4n viestej\u00e4 keskustietokoneisiin (eng. mainframe).</p> <p>1960-luvulla tulostaminen korvattiin n\u00e4yt\u00f6ill\u00e4, ja n\u00e4in syntyi videoterminaali, josta k\u00e4ytettiin my\u00f6s termi\u00e4 <code>console</code> tai lyhyesti <code>terminal</code>.</p> <p>1970-luvulla kaukokirjoittimella tai terminaalilla pystyi l\u00e4hett\u00e4m\u00e4\u00e4n viestej\u00e4 UNIX-k\u00e4ytt\u00f6j\u00e4rjestelm\u00e4\u00e4n. L\u00e4hetetyt viestit kirjoitettiin <code>/dev/tty0</code> (tai <code>tty1</code> - <code>tty63</code>) tiedostoon. Jokaista l\u00e4hett\u00e4j\u00e4\u00e4 varten oli oma, juoksevalla numerolla numeroitu tiedosto. T\u00e4m\u00e4 tiedosto toimi rajapintana UNIX:n p\u00e4\u00e4n ohjelmille, jotka pystyiv\u00e4t k\u00e4sittelem\u00e4\u00e4n t\u00e4t\u00e4 tiedostoa (tai laitetta) tavallisella ASCII-merkist\u00f6ll\u00e4.</p> <p>Ohjelma, joka tulkitsee <code>/dev/tty</code>:n sis\u00e4lt\u00f6\u00e4, on shell. Alunperin t\u00e4m\u00e4 oli UNIX-j\u00e4rjestelmiss\u00e4 <code>Bourne shell</code>, mutta avoimen l\u00e4hdekoodin GNU/Linuxissa se on yleisimmin Bash (<code>Bourne-again shell</code>). UNIX-tyylisiss\u00e4 j\u00e4rjestelmiss\u00e4 komentirivipohjainen shell on jossain m\u00e4\u00e4rin my\u00f6s ohjelmointikieli, ja se toteuttaa tietyt built-in ohjelmat kuten <code>cd</code>, <code>break</code>, <code>continue</code>, <code>exec</code> ja <code>kill</code>, kuten GNU Bashin oma dokumentaatio kertoo.  Kotitietokoneet alkoivat yleisty\u00e4, ja kotitietokoneen kanssa fyysisesti erillinen konsoli eli terminaali ei ole tarpeen, joten se emuloitiin (<code>terminal emulator</code>). N\u00e4ist\u00e4 emuloiduista terminaaleista k\u00e4ytet\u00e4\u00e4n yh\u00e4 termi\u00e4 <code>TTY device</code>. Komentoja tulkkaava shell, kuten <code>bash</code>, lukee t\u00e4m\u00e4n virtuaalisen konsolin sy\u00f6tett\u00e4 <code>/dev/tty</code>-tiedostosta.</p> Termi M\u00e4\u00e4ritelm\u00e4 Shell Ohjelma, joka toimii ihmiselle k\u00e4ytt\u00f6liittym\u00e4n\u00e4. Mik\u00e4li k\u00e4yt\u00e4t GNOME 3 -ty\u00f6p\u00f6yt\u00e4ymp\u00e4rist\u00f6\u00e4, sinun shell on GNOME Shell. Mik\u00e4li kirjaudut Linuxiin ilman graafista shelli\u00e4, sinun shell on todenn\u00e4k\u00f6isimmin GNU Bash. Komentotulkki Englanniksi command language interpreter tai command-line interface, lyhenteelt\u00e4\u00e4n CLI. GNU Bash on sek\u00e4 shell ett\u00e4 CLI. Graafinen k\u00e4ytt\u00f6liittym\u00e4 Englanniksi graphical user interface, lyhenteelt\u00e4\u00e4n GUI. GNOME Shell on sek\u00e4 shell ett\u00e4 GUI. Terminaali Terminaali on kone - tai yleisemmin virtuaaliterminaali eli ohjelma - jossa shell ajetaan. Konsoli on k\u00e4yt\u00e4nn\u00f6ss\u00e4 sama asia. Pseudoterminaali Ohjelma, jota k\u00e4ytt\u00e4j\u00e4 ajaa graafisessa k\u00e4ytt\u00f6liittym\u00e4ss\u00e4, ja joka emuloi terminaalia. K\u00e4yt\u00e4t pseudoterminaalia, kun olet graafisessa k\u00e4ytt\u00f6liittym\u00e4ss\u00e4 ja etsit jostakin kuvakkeen \"Terminal\"."},{"location":"cli/terminaali/#eri-sortin-terminaaleja","title":"Eri sortin terminaaleja","text":""},{"location":"cli/terminaali/#virtuaaliterminaalit","title":"Virtuaaliterminaalit","text":"<p>Et todenn\u00e4k\u00f6isesti ole kirjautunut suoraan virtuaaliterminaaliin Bashill\u00e4 juuri nyt. Mik\u00e4li olisit, sinulla ei olisi graafista ty\u00f6p\u00f6yt\u00e4ymp\u00e4rist\u00f6\u00e4 vaan Bash aivan koko ruudun leveydelt\u00e4\u00e4n. T\u00e4ll\u00f6in voisit tarkistaa <code>tty</code>-komennolla, mik\u00e4 on k\u00e4ytt\u00e4m\u00e4si virtuaaliterminaalin numero.</p> Bash<pre><code>$ tty\n/dev/tty3\n\n$ echo $TERM\nlinux\n</code></pre>"},{"location":"cli/terminaali/#pseudoterminaalit","title":"Pseudoterminaalit","text":"<p>Olet mit\u00e4 todenn\u00e4k\u00f6isemmin GNOME-ty\u00f6p\u00f6yd\u00e4ll\u00e4, joka on siis johonkin <code>tty#</code>:\u00e4\u00e4n kiinnittynyt <code>GNOME Shell</code>. Sinun varsinainen shell on siis graafinen k\u00e4ytt\u00f6liittym\u00e4. Jos avaat Terminal-sovelluksen, eli <code>gnome-terminal</code>, aukeaa pseudoterminaali, joka emuloi terminaalia. T\u00e4ss\u00e4 tapauksessa <code>tty</code>-komennon tuloste voi olla pettymyksellinen.</p> Bash<pre><code>$ tty\n/dev/pts/0\n\n$ echo $TERM\nxterm-256color\n</code></pre>"},{"location":"cli/terminaali/#virtuaaliterminaaliin-ja-takaisin","title":"Virtuaaliterminaaliin ja takaisin","text":"<p>Oletetaan, ett\u00e4 olet GNOME-ty\u00f6p\u00f6yd\u00e4ss\u00e4. Haluat k\u00e4yd\u00e4 virtuaaliymp\u00e4rist\u00f6ss\u00e4 - ja mielell\u00e4\u00e4n l\u00f6yt\u00e4\u00e4 viel\u00e4 takaisinkin. Vaihtoehtoja on kaksi:</p> <ul> <li>K\u00e4yt\u00e4 pikan\u00e4pp\u00e4int\u00e4 Ctrl+Alt+F4. (tai jokin muu F-n\u00e4pp\u00e4in)</li> <li>K\u00e4yt\u00e4 komentoa <code>chvt</code>.</li> </ul> <p>Ennen kuin teet kumpaakaan, tarkista, mit\u00e4 sessioneita on jo olemassa:</p> Bash<pre><code>loginctl\n</code></pre> stdout<pre><code>SESSION  UID USER     SEAT  TTY  STATE  IDLE SINCE\n      2 1000 opettaja seat0 tty2 active no   -    \n</code></pre> <p>T\u00e4ss\u00e4 esimerkiss\u00e4 on vain yksi sessio, joka on aktiivinen - ja n\u00e4inh\u00e4n on oletettavaa, jos min\u00e4 olen ainut koneeseen kirjautunut henkil\u00f6. Kyseinen sessio (2) on kiinnitetty tty2:een ja on aktiivinen. Kyseisess\u00e4 virtuaaliterminaalissa on kiinnittyneen\u00e4 siis nykyinen GNOME Shell ty\u00f6p\u00f6ytineen. Kokeillaan vaihtaa johonkin toiseen virtuaaliterminaaliin; t\u00e4ll\u00f6in terminaalissa k\u00e4ynnistyy k\u00e4ytt\u00e4j\u00e4n vakioshell eli yleens\u00e4 Bash. K\u00e4yt\u00e4 vaihtamiseen harkintasi mukaan joko pikan\u00e4pp\u00e4inyhdistelm\u00e4\u00e4 tai <code>chvt</code>-komentoa. Luethan ensin <code>man chvt</code>-ohjeet. Ohjeista p\u00e4\u00e4set pois painamalla <code>q</code>-n\u00e4pp\u00e4int\u00e4.</p> Bash<pre><code>$ sudo chvt 4  # tai paina ctrl+alt+f4\n\n# HOX! T\u00e4ss\u00e4 v\u00e4liss\u00e4 ruutu muuttuu mustaksi ja sinulle n\u00e4kyy kirjautumisn\u00e4ytt\u00f6.\n# Kirjoita k\u00e4ytt\u00e4j\u00e4tunnus ja sitten salasana.\n# Sitten:\n\n$ tty        # Tarkista, olisiko t\u00e4m\u00e4 kenties /dev/tty4\n$ loginctl   # Tarkista, onko uusi sessio listalla\n</code></pre> <p>P\u00e4\u00e4set takaisin alkuper\u00e4iseen istuntoon joko Ctrl+Alt+F2 tai <code>chvt 2</code>-komennolla, olettaen, ett\u00e4 tty:n numero on 2 kuten minun esimerkiss\u00e4ni. Jos vaihdat johonkin toiseen, luot uusia istuntoja. Huomaa, ett\u00e4 jos yrit\u00e4t jatkossa sammuttaa tietokoneen, niin Ubuntu varoittaa, ett\u00e4 muita k\u00e4ytt\u00e4ji\u00e4 on j\u00e4rjestelm\u00e4\u00e4n kirjautuneena:</p> <p></p> <p>Kuvio 1. Varoitus Other users are logged in ilmaantuu, jos yrit\u00e4t sammuttaa tietokoneen.</p> <p>Tip</p> <p>Voit sulkea sessioita <code>loginctl</code>-komennolla. Esimerkiksi <code>loginctl terminate-session 3</code> sulkee session 3. Ja kuten ehk\u00e4 arvaat, voit tarkistaa <code>loginctl</code>-komennolla sarakkeesta <code>SESSION</code>, mik\u00e4 on mink\u00e4kin sessionin ID.</p>"},{"location":"cli/terminaali/#bashin-peruskaytto","title":"Bashin perusk\u00e4ytt\u00f6","text":""},{"location":"cli/terminaali/#tunnistaminen","title":"Tunnistaminen","text":"<p>Huomaa, ett\u00e4 k\u00e4ytt\u00e4m\u00e4si shell voi olla jokin muu kuin Bash. Voit selvitt\u00e4\u00e4 yleens\u00e4 jollain seuraavista komennoista. Komennon k\u00e4ytt\u00f6 on simppeli\u00e4: kirjoita se ja paina Enter.</p> Bash<pre><code>$ echo $0\nbash\n\n$ echo $SHELL\n/bin/bash\n\n$ cat /etc/passwd | grep opettaja  # Korvaa omalla k\u00e4ytt\u00e4j\u00e4nimell\u00e4\nopettaja:x:1000:1000:Ope Opettaja,,,:/home/opettaja:/bin/bash\n</code></pre> <p>Bashin k\u00e4ytt\u00f6ohjeen l\u00f6yd\u00e4t joko distribuution sivuilta Ubuntu Manpage: bash - GNU Bourne-Again SHell tai komennolla:</p> Bash<pre><code>$ man 1 bash # Bashin manuaali (1)\n$ man man    # Manuaalin manuaali\n</code></pre> <ol> <li>Komento <code>man</code> avaa ohjeet pitki\u00e4 tekstitiedostoja sivuttavassa ohjelmassa nimelt\u00e4\u00e4n <code>pager</code>. Lue ohjeet ohjelman tulosteen eli ruudun alalaidasta. </li> </ol>"},{"location":"cli/terminaali/#napparat-pikanappaimet","title":"N\u00e4pp\u00e4r\u00e4t pikan\u00e4pp\u00e4imet","text":"<p>Alla olevat pikan\u00e4pp\u00e4imet toimivat tyypillisesti Bash:ss\u00e4 ja sit\u00e4 vastaavissa shelleiss\u00e4.</p> Klikattavat n\u00e4pp\u00e4imet Toiminto Ctrl+L Tyhjent\u00e4\u00e4 ruudun. Sama kuin komento <code>clear</code>. Tab Automaattinen t\u00e4ydennys. Tunnistaa sek\u00e4 kansion tiedostoja ett\u00e4 PATH:ssa olevia ohjelmia. Tab+Tab Tuplaklikkaus. Automaattinen t\u00e4ydennys, joka n\u00e4ytt\u00e4\u00e4 useammat vaihtoehdot. Ctrl+U Poistaa kaikki merkit kirjaisimesta vasemmalle. N\u00e4pp\u00e4r\u00e4 tapa tyhjent\u00e4\u00e4 rivi pl\u00f6r\u00f6st\u00e4. Up Down Historian kelaaminen. Voit pl\u00e4r\u00e4t vanhoja komentoja. Ctrl+LeftCtrl+Right Sanojen hyppiminen vasemmalle ja oikealle. My\u00f6s Alt+B ja Alt+F tekev\u00e4t saman."},{"location":"cli/terminaali/#vaarallisemmat-pikanappaimet","title":"Vaarallisemmat pikan\u00e4pp\u00e4imet","text":"Pikan\u00e4pp\u00e4in Toiminto Ctrl+D Virallisesti EOF. Sill\u00e4 p\u00e4\u00e4see esimerkiksi <code>cat</code>-sovelluksesta ulos, mutta <code>bash</code>:ss\u00e4 k\u00e4ytettyn\u00e4 se on sama kuin kirjoittaisi <code>exit</code>. Ctrl+C Interrupt-signaali (SIGINT). Lopettaa ohjelman, mill\u00e4 voi pyrki\u00e4 tappamaan jumiin j\u00e4\u00e4neen sovelluksen. Ctrl+Z Pys\u00e4ytt\u00e4\u00e4 sovelluksen ja siirt\u00e4\u00e4 sen taka-alalle. Ohjelman toistoa voi jatkaa komennolla <code>fg</code>. Vaihtoehtoisesti sen voi k\u00e4yd\u00e4 my\u00f6hemmin tappamassa <code>kill</code>-komennolla, mik\u00e4li se oli jumissa, eik\u00e4 siit\u00e4 p\u00e4\u00e4se eroon yll\u00e4 olevalla SIGINT:ll\u00e4."},{"location":"cli/terminaali/#tehtavat","title":"Teht\u00e4v\u00e4t","text":"<p>Teht\u00e4v\u00e4: tty</p> <ol> <li>Aja komento <code>tty</code> onnistuneesti pseudoterminaalissa.</li> <li>Aja komento <code>tty</code> onnistuneesti virtuaaliterminaalissa.</li> </ol> <p>T\u00e4t\u00e4 varten sinun tarvitsee joko k\u00e4ytt\u00e4\u00e4 Ctrl+Alt+F3 -tyylisi\u00e4 n\u00e4pp\u00e4inkomentoja tai <code>chvt</code>-komentoa. Dokumentoi prosessi ja selit\u00e4 omin sanoinesi (mutta l\u00e4hteiden avulla), mit\u00e4 oikeastaan teit.</p> <p>Teht\u00e4v\u00e4: Z-Shellin asennus</p> <p>Ubuntu 24.04:ss\u00e4 saat Zsh:n n\u00e4in asennetuksi:</p> <pre><code># Update\nsudo apt update &amp;&amp; sudo apt upgrade -y\n\n# Install \nsudo apt install zsh\n</code></pre> <p>T\u00e4m\u00e4n j\u00e4lkeen voit k\u00e4ynnist\u00e4\u00e4 Z-shellin. Ensimm\u00e4isell\u00e4 ajokerralla k\u00e4ynnistyy konfiguraatio-ohjelma, joka n\u00e4kyy kuvassa alla. K\u00e4ynnist\u00e4 Z-Shell se komennolla <code>zsh</code>.</p> <p></p> <p>Kuvio 1: *Ohjelma <code>zsh-newuser-install</code> luo sinulle k\u00e4ynnistystiedostot. Valitse <code>0</code> eli tyhj\u00e4 konfiguraatio.</p> <p>Tip</p> <p>Huomaa, ett\u00e4 Zsh ei k\u00e4ynnistyess\u00e4\u00e4n ajaa <code>.bashrc</code>-tiedostoa. Jos sinulla on yh\u00e4 \"Hello, world!\" -tuloste kyseisess\u00e4 tiedostossa, et n\u00e4e sit\u00e4 t\u00e4ss\u00e4 shelliss\u00e4.</p> <p>Tip</p> <p>Huomaa, ett\u00e4 Zsh ei ole sinun vakioshell. T\u00e4m\u00e4n voit todentaa komennolla <code>grep $USER /etc/passwd</code>. Opit my\u00f6hemmin t\u00e4ll\u00e4 kurssilla, miten vaihdat vakioshellisi.</p>"},{"location":"etakaytto/ssh/","title":"SSH","text":"<p>T\u00e4ss\u00e4 materiaalissa esitell\u00e4\u00e4n Linuxin k\u00e4ytt\u00f6 et\u00e4n\u00e4 joko ilman graafista k\u00e4ytt\u00f6liittym\u00e4\u00e4 tai sen kanssa. </p> <p>Et\u00e4k\u00e4ytt\u00f6 ilman graafista k\u00e4ytt\u00f6liittym\u00e4\u00e4 suoritetaan Linux-ymp\u00e4rist\u00f6ss\u00e4 l\u00e4hes poikkeuksetta Secure Shell eli SSH-protokollalla, joka on Linuxin kernelin tapaan suomalaisl\u00e4ht\u00f6inen keksint\u00f6. Alunperin 1990-luvun puoliv\u00e4liss\u00e4 kehitetty SSH korvasi aiemmat merkitt\u00e4v\u00e4sti v\u00e4hemm\u00e4n turvalliset et\u00e4k\u00e4ytt\u00f6protokollat kuten Telnetin. SSH on my\u00f6hemmin lis\u00e4tty RFC-standardiksi ja kuuluu TCP/IP-protokollaperheeseen.</p> <p>Mik\u00e4li tarvitset graafisen k\u00e4ytt\u00f6liittym\u00e4n, niin kohdetietokoneessa tulee olla asennettuna jokin graafinen k\u00e4ytt\u00f6liittym\u00e4, kuten GNOME tai KDE, usein X Window Systemin p\u00e4\u00e4lle. T\u00e4ll\u00f6in grafiikkaa voi siirt\u00e4\u00e4 alkeellisimmilla tavoilla kuten X11-forwardingilla, mutta koko ty\u00f6p\u00f6yt\u00e4n\u00e4kym\u00e4n siirt\u00e4minen vaatii jonkin muun ohjelmiston, kuten RealVNC:n, TeamViewerin tai Chrome Remote Desktopin k\u00e4ytt\u00f6\u00e4. GNOME itsess\u00e4\u00e4n tarjoaa helpon vaihtoehdon: GNOME Remote Desktop. Sen voi k\u00e4yd\u00e4 klikkaamassa p\u00e4\u00e4lle GNOME-asetuksista. T\u00e4ll\u00f6in kommunikointiin k\u00e4ytet\u00e4\u00e4n Microsoftin kehitt\u00e4m\u00e4\u00e4 RDP-protokollaa.</p> <p>Mik\u00e4li tietokoneesi on julkiverkossa eli Internetiss\u00e4 kiinni, varmista ett\u00e4 tietokoneesi ja verkon v\u00e4liss\u00e4 on palomuuri. T\u00e4ss\u00e4 materiaalissa esitell\u00e4\u00e4n yksinkertaisen Uncomplicated Firewallin (UFW) k\u00e4ytt\u00f6\u00f6notto ja SSH-palvelimen suojaaminen UFW:ll\u00e4. Tietoturvallisuus ei kuitenkaan ole t\u00e4m\u00e4n kurssin fokus, joten t\u00e4t\u00e4 k\u00e4sitell\u00e4\u00e4n vain pintapuolisesti.</p>"},{"location":"etakaytto/ssh/#ufw","title":"UFW","text":"<p>UFW on yksinkertainen palomuurisovellus, joka on Debian-pohjaisissa distribuutioissa usein valmiiksi asennettuna. Eth\u00e4n asenna samaan tietokoneeseen useita eri palomuureja. Huomaa, ett\u00e4 palomuurisovellus k\u00e4ytt\u00e4\u00e4 alla olevaa low-level palomuuria system call -tasolla eli varsinaisesta palomuurista vastaa Linuxin kernel. Eri sovellukset eri tasoilla ovat:</p> <ul> <li>High level:<ul> <li>UFW (Debian)</li> <li>Firewalld (Red Hat)</li> </ul> </li> <li>Lower level:<ul> <li>nftables (Nouseva korvaaja)</li> <li>iptables (Legacy)</li> </ul> </li> <li>Kernel level:<ul> <li>netfilter</li> </ul> </li> </ul> <p>K\u00e4yt\u00e4nn\u00f6ss\u00e4 voit siis k\u00e4ytt\u00e4\u00e4 suoraan nftables- tai iptables-komentoja, mutta UFW ja Firewalld tarjoavat helpomman k\u00e4ytt\u00f6liittym\u00e4t.</p>"},{"location":"etakaytto/ssh/#asennus","title":"Asennus","text":"<p>Tee t\u00e4m\u00e4 sill\u00e4 koneella, johon aiot yhdist\u00e4\u00e4 - eli \"serverill\u00e4\". Tarkista alkuun, onko UFW asennettuna, aktivoituna ja k\u00e4ynniss\u00e4:</p> Bash<pre><code># Onhan aktivoitu?\n$ systemctl status ufw\n# tai\n$ sudo ufw status\n\n# Voit aktivoida sen n\u00e4in\n$ sudo ufw enable\n\n# Tarkista viel\u00e4 status\n$ sudo ufw status\n</code></pre> UFW:n asennus <p>Mik\u00e4li UFW ei ole asennettuna, asenna se:</p> Bash<pre><code># Asenna UFW\n$ sudo apt update\n$ sudo apt install ufw\n\n# Aktivoi UFW\n$ sudo ufw enable\n</code></pre>"},{"location":"etakaytto/ssh/#saantojen-lisays","title":"S\u00e4\u00e4nt\u00f6jen lis\u00e4ys","text":"<p>Lis\u00e4\u00e4 palomuuriin s\u00e4\u00e4nn\u00f6t, joiden kuvaus on:</p> <ul> <li>Defaulttina kiell\u00e4 kaikki sis\u00e4\u00e4ntulevat yhteydet</li> <li>Defaulttina salli kaikki ulosp\u00e4in menev\u00e4t yhteydet</li> <li>Salli sis\u00e4\u00e4ntulevat IPv4 TCP-paketit SSH-porttiin 22 sinun l\u00e4hiverkostasi</li> <li>Salli sis\u00e4\u00e4ntulevat IPv4 TCP- ja UDP- paketit RDP-porttiin 3389 sinun l\u00e4hiverkostasi</li> </ul> <p>Warning</p> <p>Huomaa, ett\u00e4 alla oletetaan sinun l\u00e4hiverkostosi olevan <code>192.168.0.0/24</code>. Jos se ei ole, korvaa t\u00e4m\u00e4 oikealla verkko-osoitteellasi. Esimerkiksi AVM FritzBoxin oletusverkko on <code>192.168.178.0/24</code>. Sinulla voi yht\u00e4 hyvin olla l\u00e4hiverkkona my\u00f6s <code>10.0.0.0/8</code>. Selvit\u00e4 t\u00e4m\u00e4 komennolla <code>ip route</code> tai <code>ip addr</code>. Jos et ole varma komennon tulosteesta, kysy esimerkiksi ChatGTP:t\u00e4 tulkkaamaan se sinulle. T\u00e4m\u00e4n pit\u00e4isi kuitenkin olla kertausta aiemmista kursseista, joilla on k\u00e4sitelty tietoliikenneverkkoja.</p> Bash<pre><code># Defaulttina kiell\u00e4 saapuvat yhteydet (ingress)\n$ sudo ufw default deny incoming\n\n# Defaulttina salli l\u00e4htev\u00e4t yhteydet (egress)\n$ sudo ufw default allow outgoing\n\n# Salli saapuvat TCP-paketit SSH-porttiin 22 sinun l\u00e4hiverkostasi\n$ sudo ufw allow from 192.168.0.0/24 to any port ssh\n</code></pre> <p>Mist\u00e4 se tiet\u00e4\u00e4 mik\u00e4 on ssh?</p> <p>K\u00e4y kurkkaamassa tiedoston <code>/etc/services</code> sis\u00e4lt\u00f6\u00e4. T\u00e4m\u00e4 tiedosto sis\u00e4lt\u00e4\u00e4 palveluiden nimet ja niiden portit.</p> <p>Lis\u00e4t\u00e4\u00e4n my\u00f6s RDP-portti:</p> Bash<pre><code># Salli saapuvat TCP ja UDP paketit porttiin 3389 sinun l\u00e4hiverkostasi\n$ sudo ufw allow from 192.168.0.0/24 to any port 3389\n</code></pre> <p>Ufw:\u00e4\u00e4 voi k\u00e4ytt\u00e4\u00e4 my\u00f6s rate limit -toimintoon, joka vaikeuttaa brute-force hy\u00f6kk\u00e4yksi\u00e4. Ufw rajoittaa yhteydenottojen m\u00e4\u00e4r\u00e4\u00e4 tiettyyn porttiin tietyn ajan sis\u00e4ll\u00e4. Jos salasanatunnistautuminen on pois p\u00e4\u00e4lt\u00e4, brute-force hy\u00f6kk\u00e4ykset eiv\u00e4t onnistu, mutta on silti hyv\u00e4 idea ottaa t\u00e4m\u00e4 k\u00e4ytt\u00f6\u00f6n SSH:lle:</p> Bash<pre><code># Ota k\u00e4ytt\u00f6\u00f6n rate limiting SSH:lle\n$ sudo ufw limit ssh/tcp comment 'Rate limit for SSH'\n</code></pre> <p>Aloita alusta?</p> <p>Jos olet tyystin sotkenut palomuurin s\u00e4\u00e4nn\u00f6t, voit aloittaa alusta komennolla:</p> Bash<pre><code>$ sudo ufw reset\n</code></pre> <p>Se disabloi UFW:n ja poistaa kaikki s\u00e4\u00e4nn\u00f6t.</p>"},{"location":"etakaytto/ssh/#ssh_1","title":"SSH","text":""},{"location":"etakaytto/ssh/#ssh-daemon-asennus","title":"SSH Daemon asennus","text":"<p>Tee t\u00e4m\u00e4 osio sill\u00e4 koneella, johon aiot yhdist\u00e4\u00e4. Asenna daemon:</p> Bash<pre><code># Asenna SSH-palvelin\n$ sudo apt install openssh-server\n\n# K\u00e4ynnist\u00e4 palvelin\n$ sudo systemctl start ssh\n\n# Aktivoi palvelin k\u00e4ynnistym\u00e4\u00e4n bootissa\n$ sudo systemctl enable ssh\n</code></pre>"},{"location":"etakaytto/ssh/#ssh-client-ensimmainen-yhteys","title":"SSH Client ensimm\u00e4inen yhteys","text":"<p>Ensimm\u00e4isell\u00e4 yhteyskerralla siirr\u00e4mme client-koneen julkisen avaimen serverille. T\u00e4m\u00e4 tapahtuu komennolla <code>ssh-copy-id</code>. T\u00e4m\u00e4 komento kopioi client-koneen julkisen avaimen serverille ja lis\u00e4\u00e4 sen <code>~/.ssh/authorized_keys</code>-tiedostoon. T\u00e4m\u00e4n j\u00e4lkeen voit yhdist\u00e4\u00e4 serverille ilman salasanaa.</p> Bash<pre><code># Kopioi client-koneen julkinen avain serverille\n$ ssh-copy-id user@server\n</code></pre> <p>Esimerkkej\u00e4</p> <p>K\u00e4yt\u00e4 oikeita k\u00e4ytt\u00e4j\u00e4nimi\u00e4 ja IP-osoitteita. Voit k\u00e4ytt\u00e4\u00e4 my\u00f6s nimipalvelua, jos reititinmodeemisi tukee sit\u00e4. Jos serverisi IP-osoite on <code>192.168.0.42</code> ja k\u00e4ytt\u00e4j\u00e4nimesi <code>akuankka</code>, niin komento on:</p> Bash<pre><code>$ ssh-copy-id akuankka@192.168.0.42\n</code></pre> <p>Yll\u00e4 olevassa komennossa on se \u00e4rsytt\u00e4v\u00e4 puoli, ett\u00e4 tietokoneen IP-osoite voi vaihtua. Jotta IP-osoitetta ei tarvitse aina selvitt\u00e4\u00e4, voit joko vaihtaa reititinmodeemissasi k\u00e4ytt\u00f6\u00f6n staattisen IP-osoitteen tai voit k\u00e4ytt\u00e4\u00e4 reititinmodeemin sis\u00e4\u00e4nrakennettua nimipalvelua, jos reititinmodeemisi tukee sit\u00e4. Esimerkiksi Kajaanissa yleinen kaapelimodeemi AVM FritzBox tukee DNS-palvelinta. T\u00e4ll\u00f6in voit k\u00e4ytt\u00e4\u00e4 esimerkiksi seuraavaa komentoa:</p> Bash<pre><code>$ ssh-copy-id akuankka@tietokoneen-nimi.fritz.box\n</code></pre> <p>Komento kysyy serverin k\u00e4ytt\u00e4j\u00e4n salasanaa. Sy\u00f6t\u00e4 se ja odota, ett\u00e4 komento suoritetaan loppuun. T\u00e4m\u00e4n j\u00e4lkeen voit yhdist\u00e4\u00e4 serverille ilman salasanaa. Tunnistautumiseen k\u00e4ytet\u00e4\u00e4n avainparia.</p> <p>Vaihtoehtoinen tapa</p> <p>Huomaa, ett\u00e4 kyseess\u00e4 on julkinen avain. Komennon <code>ssh-copy-id</code> sijasta avain voisi siis yht\u00e4 hyvin olla hostattuna verkossa, mist\u00e4 noutaisit sen. Jos haluaisit sallia opettajan kirjautuvan sinun koneellesi, voisit lis\u00e4t\u00e4 sen osoitteesta <code>https://github.com/sourander.keys</code>. T\u00e4m\u00e4 tapahtuu seuraavasti:</p> Bash<pre><code># Jos Github\n$ ssh-import-id gh:githubusername\n\n# Jos jokin muu URL\n$ ssh-import-id url:https://example.com/mykey.pub\n</code></pre> <p>T\u00e4m\u00e4 komento pit\u00e4isi luonnollisesti ajaa serverill\u00e4 eik\u00e4 client-koneella. Komento kirjoittaa avaimen <code>~/.ssh/authorized_keys</code>-tiedostoon.</p>"},{"location":"etakaytto/ssh/#ssh-daemon-salasanan-kayton-kieltaminen","title":"SSH Daemon salasanan k\u00e4yt\u00f6n kielt\u00e4minen","text":"<p>Nyt kun yhteys on testattu, voit palata takaisin serverin puolelle ja muokata SSH-daemonin asetustiedostoa. T\u00e4m\u00e4 tiedosto sijaitsee <code>/etc/ssh/sshd_config</code>. Huomaa, ett\u00e4 voit halutessasi tehd\u00e4 muutokset drop-in -tiedostoon, joka sijaitsee <code>/etc/ssh/sshd_config.d/</code>. T\u00e4m\u00e4 on jopa suositeltavaa.</p> <p>Salasanan k\u00e4ytt\u00f6 on l\u00e4ht\u00f6kohtaisesti ep\u00e4suositeltua. Voit kielt\u00e4\u00e4 salasanan k\u00e4yt\u00f6n muokkaamalla SSH-daemonin asetustiedostoa. Varmista, ett\u00e4 seuraava komento on asetettuna alla n\u00e4kyv\u00e4ll\u00e4 tavalla. Huomaa, ett\u00e4 rivi ei saa alkaa <code>#</code>-merkill\u00e4; t\u00e4ll\u00f6in se olisi kommentti eik\u00e4 aktiivinen konfiguraatio:</p> <pre><code>PasswordAuthentication no\n</code></pre> <p>Mik\u00e4li haluat lis\u00e4t\u00e4 turvallisuutta entisest\u00e4\u00e4n, voit kytke\u00e4 <code>no</code>-tilaan my\u00f6s asetukset: PermitRootLogin, ChallengeResponseAuthentication, UsePAM. Voit tutustua n\u00e4ihin asetuksiin <code>man 5 sshd_config</code>-ohjeen avulla.</p> <p>T\u00e4m\u00e4n j\u00e4lkeen sinun tulee k\u00e4ynnist\u00e4\u00e4 SSH-palvelin uudelleen, jotta muutokset tulevat voimaan:</p> Bash<pre><code># K\u00e4ynnist\u00e4 SSH-palvelin uudelleen\n$ sudo systemctl restart ssh\n# tai\n$ sudo systemctl reload sshd.service\n\n# Voit tarkistaa palvelimen asetukset komennolla\n$ sudo sshd -T\n</code></pre>"},{"location":"etakaytto/ssh/#ssh-client-ilman-salasanaa","title":"SSH Client ilman salasanaa","text":"<p>Yhteyden pit\u00e4isi yh\u00e4 pelata, eik\u00e4 sen pit\u00e4isi en\u00e4\u00e4 kysy\u00e4 salasanaa. Testaa yhteys:</p> Bash<pre><code># Korvaa user ja server oikeilla arvoilla\n$ ssh user@server\n</code></pre> <p>Tip</p> <p>Joskus SSH-yhteyden rivitys voi menn\u00e4 sekaisin. T\u00e4m\u00e4n voit korjata komennolla: <code>stty sane</code> tai <code>reset</code>.</p>"},{"location":"etakaytto/ssh/#rdp","title":"RDP","text":""},{"location":"etakaytto/ssh/#daemon","title":"Daemon","text":"<p>Ubuntu 24.04:ss\u00e4 RDP-serverin luominen on \u00e4\u00e4rimm\u00e4isen helppoa.</p> <p></p> <p>Kuvio 1. GNOME Remote Desktop l\u00f6ytyy Settings &gt; System &gt; Remote Desktop. Aktivoi se ja anna sille uniikki salasana.</p>"},{"location":"etakaytto/ssh/#client","title":"Client","text":"<p>Teoriassa mink\u00e4 tahansa RDP clientin pit\u00e4isi toimia, mutta ainakin macOS:ll\u00e4 Microsoftin oma Remote Desktop -sovellus ei suostunut yhdist\u00e4m\u00e4\u00e4n. Client ja server olivat eri mielt\u00e4 yhteyden k\u00e4ttelyss\u00e4 turva-asetuksista. Sen sijaan Thincast Remote Desktop Client toimi moitteettomasti.</p> <p>Muita vaihtoehtojakin l\u00f6ytyy, kuten: Remmina (Linux) tai RustDesk (Linux, macOS, Windows).</p>"},{"location":"etakaytto/ssh/#tehtavat","title":"Teht\u00e4v\u00e4t","text":"<p>Teht\u00e4v\u00e4: SSH yhteys</p> <p>Tee yll\u00e4 n\u00e4kyv\u00e4t step, eli:</p> <ul> <li>Aktivoi OpenSSH server ja tarkista asetukset</li> <li>Salli palomuurilla SSH vain ja ainoastaan l\u00e4hiverkosta</li> <li>Ota SSH-yhteys koneeseen toisesta koneesta</li> </ul> <p>Mik\u00e4li kursilla k\u00e4ytt\u00e4m\u00e4si Linux-kone on virtuaalikone, saatat joutua tutustumaan valitun hypervisorin port forwarding -asetuksiin. T\u00e4h\u00e4n l\u00f6ytyy kuitenkin hyvi\u00e4 ohjeita. Kokeile vaikka hakusanoja: <code>virtualbox how to port forwards ssh</code>.</p> <p>Lis\u00e4haaste</p> <p>Jos SSH osoittautui helpoksi teht\u00e4v\u00e4ksi, niin ota kohdekoneeseen yhteys my\u00f6s Ruskdesk:n avulla! Julkiverkon yli yhdist\u00e4ess\u00e4 sinulla tulisi olla Relay Server asennettuna esimerkiksi DC-labran julkiseen IP-osoitteeseen, mutta jos/kun sek\u00e4 server ett\u00e4 client ovat samassa LAN-verkossa, voit yhdist\u00e4\u00e4 suoraan IP-osoitteella.</p> <p>Huomaa, ett\u00e4 t\u00e4m\u00e4 mahdollistaa et\u00e4k\u00e4yt\u00f6n macOS-Windows-Linux \u2013trion k\u00e4ytt\u00f6j\u00e4rjestelmien v\u00e4lill\u00e4.</p> <p>T\u00e4h\u00e4n l\u00f6ytyy ohjeita, kuten NetworkChuck:n video YouTube: Your Remote Desktop SUCKS!! Try this instead (FREE + Open Source).</p>"},{"location":"etakaytto/tmux/","title":"Tmux","text":"<p>T\u00e4m\u00e4 ohje on tarkoitettu SSH-yhteytt\u00e4 k\u00e4ytt\u00e4ville, jotka haluavat ratkaista seuraavia ongelmia:</p> <ul> <li>Pitk\u00e4\u00e4n ajettava ohjelma katkeaa kun SSH-yhteys katkeaa.</li> <li>Haluat ajaa useaa ohjelmaa rinnakkain tai jopa split screen -tilassa.</li> <li>Haluat voida jatkaa ensi kerralla siit\u00e4, mihin j\u00e4it.</li> </ul> <p>T\u00e4h\u00e4n l\u00f6ytyy ratkaisuja kuten <code>tmux</code> ja <code>screen</code>. K\u00e4yt\u00e4nn\u00f6n tasolla n\u00e4m\u00e4 ohjelmat multiplexaavat terminaalia, jolloin voit ajaa useita ohjelmia rinnakkain ja palata niihin my\u00f6hemmin. Multipleksaus on termi, jolla yhteen striimiin voidaan sis\u00e4llytt\u00e4\u00e4 useita eri signaaleja (esimerkiksi DVD-levyss\u00e4 on useita \u00e4\u00e4niraitoja ja tekstityksi\u00e4).</p> <p>T\u00e4ss\u00e4 ohjeessa k\u00e4yd\u00e4\u00e4n l\u00e4pi <code>tmux</code>-ohjelman k\u00e4ytt\u00f6\u00f6notto ja perusk\u00e4ytt\u00f6.</p> <p>Tip</p> <p>Voit k\u00e4ytt\u00e4\u00e4 tmuxia joko lokaalisti GNOME Terminaalissa tai SSH-yhteyden l\u00e4pi.</p>"},{"location":"etakaytto/tmux/#asennus","title":"Asennus","text":"<p>Asenna <code>tmux</code> paketinhallinnan kautta:</p> <pre><code>$ sudo apt update\n$ sudo apt install tmux\n</code></pre>"},{"location":"etakaytto/tmux/#peruskaytto","title":"Perusk\u00e4ytt\u00f6","text":"<p>K\u00e4ynnist\u00e4 <code>tmux</code>-sessio komennolla <code>tmux</code>:</p> <pre><code>$ tmux\n</code></pre> <p>Nyt olet <code>tmux</code>-sessiossa. Tunnistat sen vihre\u00e4st\u00e4 palkista alhaalla. Voit ajaa komentoja kuten normaalissakin terminaalissa, mutta sinulla on apuna useita n\u00e4pp\u00e4inkomentoja.</p>"},{"location":"etakaytto/tmux/#prefix-nappain","title":"Prefix-n\u00e4pp\u00e4in","text":"<p><code>tmux</code>-sessiossa ehdottomasti t\u00e4rkein n\u00e4pp\u00e4inyhdistelm\u00e4 on Ctrl+B. Kyseess\u00e4 on <code>tmux</code> prefix, joka tarkoittaa, ett\u00e4 seuraava klikattu n\u00e4pp\u00e4in on <code>tmux</code>:lle tarkoitettu komento eik\u00e4 shellille ammuttava n\u00e4pp\u00e4inpainallus.</p>"},{"location":"etakaytto/tmux/#kokeillaan-irroittautua-sessiosta-ja-liittya-takaisin","title":"Kokeillaan irroittautua sessiosta ja liitty\u00e4 takaisin","text":"<p>Tyypillinen workflow on se, ett\u00e4 luot sinulle session, johon palaat aina takaisin. Et siis suinkaan lue miljoonaa rinnakkaista sessiota, vaan palaat takaisin aiemmin luomaasi.</p> <ol> <li>Olet <code>tmux</code>-sessiossa, jos ajoit aiemmin komennon <code>tmux</code>.</li> <li>Paina Ctrl+B ja sen j\u00e4lkeen <code>d</code> tai vaihtoehtoisesti kirjoita <code>tmux detach</code>.</li> </ol> stdout<pre><code>[detached (from session 0)]\n</code></pre> <p>Nyt olet palannut pois <code>tmux</code>-sessiosta. Voit listata kaikki sessiot seuraavalla tavalla:</p> Bash<pre><code>$ tmux ls\n</code></pre> stdout<pre><code>0: 1 windows (created Wed Sep 18 10:44:00 2024)\n</code></pre> <p>Nyt voit liitty\u00e4 takaisin sessioon:</p> Bash<pre><code># Liity viimeisimp\u00e4\u00e4n sessioon\n$ tmux attach\n\n# Tai pidemm\u00e4ll\u00e4 komennolla\n$ tmux attach-session\n\n# Tai eksplisiittisesti\n$ tmux attach -t 0\n</code></pre>"},{"location":"etakaytto/tmux/#sessionin-tuhoaminen","title":"Sessionin tuhoaminen","text":"<p>Voit tuhota sessiot seuraavalla tavalla:</p> Bash<pre><code># Listaa kaikki\n$ tmux ls\n\n# Tuhotaan sessio\n$ tmux kill-session -t 0\n</code></pre>"},{"location":"etakaytto/tmux/#nimetyn-sessionin-luominen","title":"Nimetyn sessionin luominen","text":"<p>Voit luoda nimetyn session seuraavalla tavalla:</p> Bash<pre><code>$ tmux new -s mysession\n</code></pre> <p>Jatkossa t\u00e4h\u00e4n liityt\u00e4\u00e4n komennolla</p> Bash<pre><code># Eksplisiittisesti\n$ tmux attach -t mysession\n\n# Tai edelliseen\n$ tmux attach\n</code></pre>"},{"location":"etakaytto/tmux/#asetustiedosto","title":"Asetustiedosto","text":"<p>Jos haluat muokata <code>tmux</code>-asetuksia, voit tehd\u00e4 sen tiedostossa <code>~/.tmux.conf</code>. Vakiona tiedostoa ei ole, joten voit luoda sen itse. T\u00e4m\u00e4 on kurssin skoopin ulkopuolella, mutta voit halutesssasi tutustua esimerkiksi Make tmux Pretty and Usable - A Guide to Custom\u00adizing your tmux.conf ohjeeseen.</p>"},{"location":"etakaytto/tmux/#ikkunat","title":"Ikkunat","text":"<p>Session on jaettu ikkunoihin. Voit luoda uuden ikkunan painamalla Ctrl+B ja sen j\u00e4lkeen <code>c</code>. Voit vaihtaa ikkunaa painamalla Ctrl+B ja sen j\u00e4lkeen <code>n</code> tai <code>p</code> (next, previous). Vaihtoehtoisesti voit navigoida ikkunaan sen indeksi\u00e4 k\u00e4ytt\u00e4en, esim. Ctrl+B ja sen j\u00e4lkeen <code>0</code>.</p>"},{"location":"etakaytto/tmux/#jatko-ohjeet","title":"Jatko-ohjeet","text":"<p>T\u00e4ss\u00e4 ohjeessa k\u00e4ytiin l\u00e4pi <code>tmux</code>-ohjelman perusk\u00e4ytt\u00f6. Mik\u00e4li haluat syvent\u00e4\u00e4 osaamistasi, voit tutustua <code>man tmux</code>-ohjeeseen tai tmux Wikiin tai esimerkiksi k\u00e4ytt\u00e4jien luomiin tmux cheat sheet-tyyliisiin pikaohjeisiin.</p>"},{"location":"etakaytto/tmux/#tehtavat","title":"Teht\u00e4v\u00e4t","text":"<p>Teht\u00e4v\u00e4: tmuxin k\u00e4ytt\u00f6</p> <p>Asenna tmux. Luo istunto (engl. session), ja splittaa istunnon ikkuna horisontaalisesti kahdeksi ruuduksi (engl. panes). T\u00e4h\u00e4n l\u00f6ytyy netist\u00e4 rutkasti ohjeita, kuten yll\u00e4 mainittu cheat sheet. Otsikon \"Managing split panes\" alta l\u00f6ytyy tarvittavat ohjeet.</p> <p>Todista luomasi kokonaisuus kuvakaappauksin, aivan kuten edellisiss\u00e4kin teht\u00e4viss\u00e4 olet tehnyt.</p>"},{"location":"linux/kernel/","title":"Kernel","text":"<p>Ydin eli kernel on C-kielell\u00e4 ja pieniss\u00e4 m\u00e4\u00e4rin assemblyll\u00e4 \u2013 nykyisin my\u00f6s Rustilla \u2013 kirjoitettu, k\u00e4ytt\u00e4m\u00e4llesi prosessorille sopivaksi bin\u00e4\u00e4riksi k\u00e4\u00e4nnetty ohjelma, joka ladataan muistiin tietokoneen k\u00e4ynnistyess\u00e4. Ensimm\u00e4isen kernelin on kirjoittanut Linus Torvals, joka yh\u00e4 hallinnoi Linuxin ytimen kehityst\u00e4. Ytimen ensisijaiset teht\u00e4v\u00e4t ovat kommunikoida raudan kanssa ja tarjota muille prosesseille p\u00e4\u00e4sy n\u00e4ihin rajapintojen kautta sek\u00e4 luoda ymp\u00e4rist\u00f6, jossa n\u00e4it\u00e4 muita ohjelmia voidaan ajaa. Sulautettu j\u00e4rjestelm\u00e4, jossa py\u00f6rii vain yksi ohjelma, ei tarvitse k\u00e4ytt\u00f6j\u00e4rjestelm\u00e4\u00e4 laisinkaan. Termit \"k\u00e4ytt\u00f6j\u00e4rjestelm\u00e4\" ja \"kernel\" voidaan k\u00e4yt\u00e4nn\u00f6ss\u00e4 n\u00e4hd\u00e4 synonyymeina.</p> <p>Kernel hallitsee muun muassa seuraavia asioita:</p> <ul> <li>Prosessit</li> <li>Muisti</li> <li>Laiteajurit</li> <li>System calls</li> </ul> <p>Ydin on avointa l\u00e4hdekoodia ja sen voi ladata kernel.org-sivustolta. Huomaathan, ett\u00e4 eli distribuutiot voivat halutessaan muokata ydint\u00e4. Esimerkiksi Ubuntun ytimen koodin voi ladata komennolla <code>sudo apt install linux-source</code>. Se tallentuu lokaatioon <code>/usr/src/</code> tarballina.</p> <p>Kun ajossa oleva ohjelma (eli prosessi) haluaa kommunikoida raudan kanssa, se luo ytimen m\u00e4\u00e4rittelem\u00e4n rajapinnan mukaisen pyynn\u00f6n, ja ydin joko sallii tai est\u00e4\u00e4 p\u00e4\u00e4syn. T\u00e4m\u00e4 rajapinta on <code>syscall</code> eli <code>system call</code> ja rajapinta k\u00e4ytt\u00e4\u00e4 assembly-kielt\u00e4 (ks. <code>man 2 intro</code>). Tyypillisesti ohjelmat kuitenkin k\u00e4ytt\u00e4v\u00e4t C Standard Library\u00e4 (ks. <code>man 3 intro</code>), joka on abstraktio ytimen rajapinnasta. Jos ydin sallii p\u00e4\u00e4syn, ydin kommunikoi raudan kanssa ja palauttaa vastauksen prosessille rajapinnan mukaisesti. Ydin siis piilottaa kaiken low-level toteutuksen taakseen eli abstrahoi sen.</p> <p>Alla n\u00e4kyy kartta ytimen sisuksista jaettuna ulkoisten rajapintojen mukaisiin kaistoihin.</p> <p></p> <p>Kuvio 1: Kartta Linuxin kernelist\u00e4. Alkuper\u00e4inen, interaktiivinen kuva l\u00f6ytyy: Interactive map of Linux kernel (makelinux.github.io). Kuva tallennettu kurssimateriaaliin saatavuuden varmistamiseksi.</p> <p>Mik\u00e4li haluat n\u00e4hd\u00e4, mit\u00e4 Standard C-libraryn kutsuja jokin komento kutsuu, voit tehd\u00e4 sen <code>ltrace</code>-ohjelmalla. Jos sen sijaan haluat n\u00e4hd\u00e4, mit\u00e4 alemman rajapinnan eli syscallin kutsuja komento kutsuu, voit tehd\u00e4 sen <code>strace</code>-ohjelmalla.</p> Bash<pre><code># Kokeile\n$ ltrace ls\n\n# Kokeile my\u00f6s\n$ strace ls\n\n# ...ja kenties\n$ strace python3 -c 'print(\"Hello\")'\n</code></pre> <p>Vaihtoehtoisesti voit listata object dependencyt komennolla <code>ldd</code>.</p> Bash<pre><code># Kokeile\n$ ldd /usr/bin/ls\n</code></pre>"},{"location":"linux/kernel/#kuka-sita-kirjoittaa","title":"Kuka sit\u00e4 kirjoittaa?","text":"<p>Linuxin kehityksest\u00e4 vastaa Linus Torvals, mutta h\u00e4n ei suinkaan kirjoita koko ydint\u00e4 yksin. Ydin on avointa l\u00e4hdekoodia, ja kuka tahansa voi osallistua kehitykseen. K\u00e4yt\u00e4nn\u00f6ss\u00e4 merkitt\u00e4v\u00e4 osa koodista on eri yritysten ja organisaatioiden kehitt\u00e4m\u00e4\u00e4. Sivusto LWN.net julkaisee kernel-versioista ajoittain tilastoja, joissa on pyritty yhdist\u00e4m\u00e4\u00e4n henkil\u00f6t heid\u00e4n ty\u00f6nantajiinsa. Ne l\u00f6yt\u00e4\u00e4 koostetusti sivulta kernelnewbies.org/DevelopmentStatistics. Kirjoitushetkell\u00e4 tuoreimman Ubuntu 25.04:n kernel-versio on 6.14, ja sen tilastot l\u00f6ytyv\u00e4t Development statistics for 6.14. Alla top 15 rivimuutosten mukaan laskettuna:</p> # Ty\u00f6nantaja Prosentti 1 Intel 8.9% 2 Google 8.6% 3 (Unknown) 8.5% 4 Qualcomm 8.4% 5 AMD 7.3% 6 Red Hat 5.9% 7 (None) 5.0% 8 Cirrus Logic 3.6% 9 Linaro 3.6% 10 Oracle 3.0% 11 Meta 2.7% 12 Cisco 2.0% 13 Microsoft 1.9% 14 NVIDIA 1.8% 15 Bootlin 1.5% <p>Huomaa, ett\u00e4 osuudet vaihtelevat jonkin verran eri kernel-versioiden v\u00e4lill\u00e4. Tutustu ihmeess\u00e4 tuoreimman version tilastoihin \u2013 se on tuskin 6.14 kun luet t\u00e4t\u00e4.</p>"},{"location":"linux/kernel/#ytimen-ja-kayttajan-avaruus","title":"Ytimen ja k\u00e4ytt\u00e4j\u00e4n avaruus","text":"<p>Ydin itsess\u00e4\u00e4n py\u00f6rii omana prosessina, joka luo k\u00e4ytt\u00e4j\u00e4n avaruuden eli \"User spacen\". K\u00e4ytt\u00e4j\u00e4n avaruudessa suoritetaan ohjelmat, jotka n\u00e4kyv\u00e4t tavalla tai toiselle k\u00e4ytt\u00e4j\u00e4lle. Osa n\u00e4kyy ilmiselv\u00e4sti, kuten graafinen ty\u00f6p\u00f6yt\u00e4, osa n\u00e4kyy esimerkiksi komennon <code>ps aux</code> avulla. Huomaa, ett\u00e4 vaikka avaruuden nimess\u00e4 on termi k\u00e4ytt\u00e4j\u00e4, se ei tarkoita, ett\u00e4 ohjelmat ovat nimenomaan ihmisk\u00e4ytt\u00e4j\u00e4n k\u00e4ynnist\u00e4mi\u00e4 ja k\u00e4ytt\u00e4mi\u00e4. My\u00f6s vailla interaktiivista shelli\u00e4 ohjelmia ajava Linux-palvelin suorittaa ohjelmat k\u00e4ytt\u00e4j\u00e4avaruudessa.</p> <p>Ohjelmat, jotka suoritetaan ytimen avaruudessa, suoritetaan todella laajoilla k\u00e4ytt\u00f6oikeuksilla, ja ohjelmilla on l\u00e4hes rajaton p\u00e4\u00e4sy tietokoneen resursseihin. K\u00e4ytt\u00e4j\u00e4n avaruudessa suoritettavat ohjelmat ajetaan sen sijaan ytimen niille antamilla ehdoilla. Ohjelman p\u00e4\u00e4sy\u00e4 muistiin, massamuistiin, prosessoriaikaa, ja muita resursseja voidaan rajata. K\u00e4ytt\u00e4j\u00e4n n\u00e4k\u00f6kulmasta rinnakkain ajettavat ohjelmat ajetaan \"yht\u00e4 aikaa\", mutta k\u00e4yt\u00e4nn\u00f6ss\u00e4 ohjelmat vuorottelevat CPU:n ytimen tai useiden ytimien laskenta-ajasta. My\u00f6s itse ydin tarvitsee CPU-aikaa ja muistia, luonnollisesti.</p> <p></p> <p>Kuvio 2: K\u00e4ytt\u00e4j\u00e4n avaruuden, ytimen avaruuden ja raudan kerrokset.</p>"},{"location":"linux/kernel/#laiteajurit","title":"Laiteajurit","text":"<p>Laitteisiin on suora p\u00e4\u00e4sy vain ytimen avaruudessa ajettavilla ohjelmilla. Laiteajurit itsess\u00e4\u00e4n ajetaan t\u00e4ten ytimen avaruudessa. Ajuri on joukko ytimen funktioita tai k\u00e4skyj\u00e4, jotka tarjoavat ulosp\u00e4in rajapinnan, joka noudattaa Virtual File System:n mukaisia k\u00e4skyj\u00e4 (open, read, lseek jne.). Laitet itsess\u00e4\u00e4n voi olla joko fyyinen laite tai virtuaalinen laite kuten pseudoterminaali. Osa laiteajureista on k\u00e4\u00e4nnetty staattisesti kerneliin (eng. <code>statically compiled</code>), osa lis\u00e4t\u00e4\u00e4n my\u00f6hemmin moduuleina (ks. <code>insmod</code>, <code>modprobe</code>), ja moduulit voidaan my\u00f6s poistaa muistista.</p> <p>Moduulit l\u00f6ytyv\u00e4t polusta <code>/lib/modules/&lt;kernel-versio-t\u00e4h\u00e4n&gt;/kernel/drivers/</code>. Kerneliin ladatujen moduuleiden statuksen voi listata <code>lsmod</code>-komennolla.</p> Bash<pre><code># Etsi jokin moduuli\n$ lsmod\n\n# Tsekkaa tiedot moduulista\n$ modinfo &lt;moduulin-nimi&gt;\n</code></pre> <p>Moduulien parametrej\u00e4 (ks. modinfo output) voi muuttaa <code>modprobe</code>-komennolla runtime-ajossa. Pysyv\u00e4sti parametrej\u00e4 voi muuttaa <code>/etc/modprobe.d/</code>-kansiossa.</p> Bash<pre><code># K\u00e4y katsomassa l\u00f6ytyyk\u00f6\n$ sudo ls /etc/modprobe.d/*.conf\n\n# Ent\u00e4p\u00e4 t\u00e4\u00e4lt\u00e4\n$ sudo ls /etc/module/*/parameters/\n</code></pre> <p>Laiteajureiden mukana saatetaan asentaa my\u00f6s k\u00e4ytt\u00e4j\u00e4n avaruuteen ohjelmia. NVidian ajureiden mukana tulee esimerkiksi <code>nvidia-settings</code>-bin\u00e4\u00e4ri, joka asennetaan tuttuun <code>/usr/bin</code>-lokaatioon.</p> <p>Tyypillisesti ajureihin ei kuitenkaan tarvitse k\u00e4ytt\u00e4j\u00e4n puuttua, ja tarvittavat ajurit voi asentaa paketinhallintaohjelmistoa k\u00e4ytt\u00e4en, joskin niit\u00e4 varten voi joutua lis\u00e4\u00e4m\u00e4\u00e4n uuden repositoryn.</p>"},{"location":"linux/kernel/#proc","title":"Proc","text":"<p><code>/proc</code> on virtuaalinen tiedostoj\u00e4rjestelm\u00e4, joka tarjoaa k\u00e4ytt\u00e4j\u00e4lle ja ohjelmille tiedon ytimen tilasta. Tiedostoj\u00e4rjestelm\u00e4 on virtuaalinen, koska se ei ole tallennettu massamuistiin. Tiedostojen koko on siis 0 KB. Kernel vastaa tiedostojen sis\u00e4lt\u00e4m\u00e4n informaation ajantasaisuudesta.</p> Bash<pre><code># Listaa tiedostot. Nuemerot ovat prosessien PIDej\u00e4. N\u00e4ihin tutustut my\u00f6hemmiss\u00e4 luvuissa.\n$ ls /proc\n\n# Kurkkaa jonkin tiedoston sis\u00e4lt\u00f6\u00e4. Alla pari esimerkki\u00e4.\n$ cat /proc/version\n$ cat /proc/cmdline\n$ cat /proc/cpuinfo\n$ cat /proc/meminfo\n</code></pre> <p>Hakemisto <code>/proc/sys/</code> sis\u00e4lt\u00e4\u00e4 tiedostoja, joilla voi muuttaa ytimen asetuksia. Tiedostot ovat tavallisia tekstitiedostoja, joiden sis\u00e4lt\u00f6\u00e4 voi muuttaa. Muutokset eiv\u00e4t kuitenkaan ole pysyvi\u00e4, vaan ne katoavat, kun tietokone k\u00e4ynnistet\u00e4\u00e4n uudelleen.</p> Bash<pre><code># Katso IP forwarding asetus (\"reititys\")\n$ cat /proc/sys/net/ipv4/ip_forward\n\n# Katso se my\u00f6s sysctl ohjelmalla\n$ sysctl net.ipv4.ip_forward\n</code></pre>"},{"location":"linux/kernel/#tehtavat","title":"Teht\u00e4v\u00e4t","text":"<p>Teht\u00e4v\u00e4: Kernelin teht\u00e4v\u00e4t</p> <p>Selvit\u00e4 ja kerro omin sanoinesi (l\u00e4hteisiin nojaten), mitk\u00e4 ovat Linux kernelin t\u00e4rkeimm\u00e4t teht\u00e4v\u00e4t.</p> <p>Vinkki: kokeile googlettaa: <code>linux kernel site:medium.com</code></p>"},{"location":"linux/os/","title":"OS","text":""},{"location":"linux/os/#unixista-bsdn-kautta-gnulinuxiin","title":"Unixista BSD:n kautta GNU/Linuxiin","text":"<p>Unix on er\u00e4\u00e4nlainen Linuxin esi-is\u00e4, joka oli olemassa jo keskustietokoneiden (engl. mainframe) aikakaudella, kauan ennen kotikoneen (engl. PC, personal computer) yleistymist\u00e4.</p> <p></p> <p>Kuvio 1: Unix-like j\u00e4rjestelmien aikajana. Kuva lainattu Wikipediasta.</p>"},{"location":"linux/os/#attn-unix","title":"AT&amp;T:n UNIX","text":"<p>AT&amp;T Bell Labs'n UNIX-k\u00e4ytt\u00f6liittym\u00e4n l\u00e4hdekoodi oli saatavilla Unixin alkuaikoina, mik\u00e4 mahdollisti tutkijoiden lis\u00e4t\u00e4 siihen toiminnallisuuksia, ja n\u00e4in Berkeleyn yliopiston tutkijat tekiv\u00e4tkin. T\u00e4m\u00e4 lis\u00e4mausteilla varustettu k\u00e4ytt\u00f6j\u00e4rjestelm\u00e4 kasvoi omaksi yliopistojen k\u00e4ytt\u00e4m\u00e4ksi Berkeley Software Distributioniksi (BSD). Unix:n koodi oli kuitenkin AT&amp;T:n omaisuutta, joten yliopistojen oli pakko maksaa lisenssinmukaisia maksuja AT&amp;T:lle. Ongelma ratkaistiin korvaamalla UNIX-kernel BSD-kernelill\u00e4, joka oli AT&amp;T:n kernelin kaltainen, mutta ilman AT&amp;T:n omistusoikeutta \u2014 eli siis klooni. BSD:n kaupalliseksi versioksi tarkoitettua BSDI:t\u00e4 alettiin myyd\u00e4 99 % alennuksella (verrattuna System V Unixiin.) T\u00e4st\u00e4 seurasi oikeusjuttu, jossa AT&amp;T syytti BSDI:t\u00e4 UNIXin l\u00e4hdekoodin varastamisesta. Oikeusjutun aikana BSD:n kohtalo oli ep\u00e4varmalla pohjalla, mik\u00e4 tarjosi hyv\u00e4n kasvualustan uusille k\u00e4ytt\u00f6j\u00e4rjestelmille, joilla ei ollut suoraa UNIX-taakkaa.</p> <p></p> <p>Kuvio 2: Ote UNIX Programmer Manualista (man13.pdf) sek\u00e4 Ubuntu 22.04 <code>man rm</code></p>"},{"location":"linux/os/#linux-kernel","title":"Linux kernel","text":"<p>Linus Torvalds kirjoitti kernelin, jonka tarkoitus oli olla UNIX:n kaltainen, mutta ilmainen k\u00e4ytt\u00f6j\u00e4rjestelm\u00e4. Sen esikuvana toimi Andrew Tanenbaumin MINIX-k\u00e4ytt\u00f6j\u00e4rjestelm\u00e4, jonka Tanenbaum kirjoitti akateemisiin tarkoituksiin. Torvalds opiskeli tuolloin Helsingin yliopistossa, ja h\u00e4n kirjoitti kernelin opiskeluprojektina. Torvalds kirjoitti kernelin aluksi Intel 386-prosessorille, joka oli tuolloin yleinen PC-koneissa (\"AT-kloonikoneissa\"). Kernel on p\u00e4\u00e4osin C-kielt\u00e4 ja Assembly\u00e4 ja se k\u00e4\u00e4nnettiin GNU GCC:ll\u00e4.</p> <p>Linus Torvalds, 1991, Usenet group comp.os.minix</p> <p>I'm doing a (free) operating system (just a hobby, won't be big and professional like gnu) for 386(486) AT clones.  This has been brewing since april, and is starting to get ready.  I'd like any feedback on things people like/dislike in minix, as my OS resembles it somewhat (same physical layout of the file-system (due to practical reasons) among other things).</p> <p>I've currently ported bash(1.08) and gcc(1.40), and things seem to work. This implies that I'll get something practical within a few months, and I'd like to know what features most people would want.  Any suggestions are welcome, but I won't promise I'll implement them :-)</p> <p>Linus Torvalds ja Andrew Tanenbaum suosivat erilaisia arkkitehtuurisia ratkaisuja. Linus suosi monoliittist\u00e4 kerneli\u00e4, Tanenbaum mikrokerneli\u00e4. Jos t\u00e4h\u00e4n liittyv\u00e4 debaatti kiinnostaa, voit tutustua esimerkiksi Linus Torvaldsin el\u00e4m\u00e4nkerran Just for Fun kautta, jonka todenn\u00e4k\u00f6isesti l\u00f6yd\u00e4t netist\u00e4 tai kirjastosta ilmaiseksi. Tanenbaumin n\u00e4kemykseen voi tutustua esimerkiksi Vrije Universiteit: Andrew S. Tanenbaum's Home Page-saitin kautta, kuten kirjoitukseen Tanenbaum-Torvalds Debate Part II. My\u00f6s wikipedian artikkelin kautta l\u00f6ytyy linkkej\u00e4 l\u00e4hteisiin: Tanenbaum\u2013Torvalds debate.</p>"},{"location":"linux/os/#gnulinux","title":"GNU/Linux","text":"<p>GNU sen sijaan on Richard Stallmanin perustama projekti, joka pyrki luomaan UNIX-tyylisen k\u00e4ytt\u00f6j\u00e4rjestelm\u00e4n, joka olisi t\u00e4ysin vapaa. GNU:n Hurd-kernel ei ottanut tuulta alleen, mutta GNU-ty\u00f6kalut olivat jo valmiita, joten Torvalds p\u00e4\u00e4tti k\u00e4ytt\u00e4\u00e4 niit\u00e4. N\u00e4in Linux syntyi GNU/Linuxiksi.</p> <p>The kernel is an essential part of an operating system, but useless by itself; it can only function in the context of a complete operating system. Linux is normally used in combination with the GNU operating system: the whole system is basically GNU with Linux added, or GNU/Linux. All the so-called \u201cLinux\u201d distributions are really distributions of GNU/Linux. - Richard Stallman, Linux and the GNU System</p>"},{"location":"linux/os/#linuxin-komponentit","title":"Linuxin komponentit","text":"<p>Linux-ytimen p\u00e4\u00e4lle rakennetun k\u00e4ytt\u00f6j\u00e4rjestelm\u00e4n voidaan n\u00e4hd\u00e4 koostuvan useasta kerroksesta. Monenlaiset jaottelut tai granulariteetit ovat mahdollisia. Alla on esitelty yksi mahdollinen jako, jossa GNU-sovellukset esitell\u00e4\u00e4n omana kerroksenaan:</p> <ol> <li>Linux kernel</li> <li>GNU utilities</li> <li>Shell (Graafinen tai tekstipohjainen)</li> <li>Ohjelmat (eng. application software)</li> </ol>"},{"location":"linux/os/#graafisen-kayttoliittyman-komponentit","title":"Graafisen k\u00e4ytt\u00f6liittym\u00e4n komponentit","text":"<p>Graafinen k\u00e4ytt\u00f6liittym\u00e4 ei ole pakollinen osa Linux-jakelua ja usein Linuxia ajetaankin palvelinymp\u00e4rist\u00f6ss\u00e4 ilman n\u00e4it\u00e4 raskaita komponentteja. K\u00e4yt\u00e4mme t\u00e4ll\u00e4 kurssilla Ubuntu Desktop -asennusta, joka hy\u00f6dynt\u00e4\u00e4 vakiona graafista shelli\u00e4, joten meid\u00e4n on syyt\u00e4 tutustua hieman graafisen ymp\u00e4rist\u00f6n komponentteihin.</p> <pre><code>flowchart TD\n    DE[Desktop Environment]\n    DM[Display Manager]\n    WM[Window Manager or Compositor]\n    DS[Display Server or Compositor]\n    K[Kernel]\n\n    DE &lt;--&gt; DM &lt;--&gt; DS\n    DE o--o WM &lt;--&gt; DS\n    DS &lt;--&gt; K\n</code></pre> <p>Kuvio 3: Graafiseen k\u00e4ytt\u00f6liittym\u00e4\u00e4n tyypillisesti liittyv\u00e4t komponentit. Ty\u00f6p\u00f6yt\u00e4ymp\u00e4rst\u00f6n ja ikkunointiohjelman v\u00e4lill\u00e4 on erilainen nuoli, koska ne voivat olla toisistaan riippumattomia tai hyvinkin toisiinsa integroituja.</p> <ul> <li>Desktop Environment (suom. ty\u00f6p\u00f6yt\u00e4ymp\u00e4rist\u00f6)<ul> <li>GNOME, KDE, Xfce, Cinammon ja monet muut.</li> <li>K\u00e4ytt\u00f6liittym\u00e4, joka sis\u00e4lt\u00e4\u00e4 ikonit, paneelit, widgetit, taustakuvat ynn\u00e4 muut.</li> <li>Se UI/UX-kokonaisuus, jota k\u00e4yt\u00e4t tyypillisimmin.</li> </ul> </li> <li>Window Manager (suom. ikkunointiohjelma, n\u00e4yt\u00f6nj\u00e4rjestin)<ul> <li>Hallinnoi ikkunoiden sijaintia ruudulla.</li> <li>Mutter (for GNOME Shell), i3, Hyprland, Sway, jne.</li> <li>Osa ty\u00f6p\u00f6yt\u00e4ymp\u00e4rist\u00f6\u00e4 tai itsen\u00e4inen ohjelma.</li> <li>Waylandin kohdalla t\u00e4m\u00e4 on osa Compositoria.</li> </ul> </li> <li>Display Manager (suom. n\u00e4yt\u00f6nhallintaohjelma)<ul> <li>GNOME Display Manager (GDM), SDDM, jne.</li> <li>Graafinen kirjautumisn\u00e4ytt\u00f6. N\u00e4et t\u00e4m\u00e4n p\u00e4ivitt\u00e4in.</li> <li>Hallitsee sessioiden k\u00e4ynnist\u00e4mist\u00e4 ja lopettamista.</li> </ul> </li> <li>Display Server (suom. n\u00e4yt\u00f6nhallintaj\u00e4rjestelm\u00e4)<ul> <li>J\u00e4rjestelm\u00e4t: X, Wayland tai Mir.</li> <li>Protokollat: X11, Wayland, Mir.</li> <li>Waylandin kohdalla t\u00e4m\u00e4 on osa Compositoria.</li> </ul> </li> <li>Kernel (suom. ydin)<ul> <li>Ydin esitell\u00e4\u00e4n ensi luvussa.</li> <li>Hiiri ja n\u00e4pp\u00e4imist\u00f6 keskustelevat kernelin kautta Display Serverin kanssa.</li> </ul> </li> </ul> <p>Yll\u00e4 oleva listaus pyrkii olemaan jossain m\u00e4\u00e4rin p\u00e4tev\u00e4, vaikka X ja Wayland toimivat eri tavoin. Waylandiss\u00e4 sek\u00e4 Display Server ett\u00e4 Window Manager ovat Compositor. X:ss\u00e4 Compositor on irrallinen ohjelma, joka puuttuu yll\u00e4 olevasta graafista ja listauksesta. T\u00e4rke\u00e4\u00e4 on kuitenkin muistaa, ett\u00e4 Linuxin ty\u00f6p\u00f6yt\u00e4ymp\u00e4rist\u00f6 ei ole yksitt\u00e4inen ohjelma vaan useista komponenteista koostuva kokonaisuus, jotka ovat jossain m\u00e4\u00e4rin vaihdettavissa, jossain m\u00e4\u00e4rin toisiinsa integroituja. Jos X:n ja Waylandin ero kiinnostaa, lue Waylandin sivuilta Wayland Architecture. Kyseisess\u00e4 artikkelissa kuvataan yksitt\u00e4isen sy\u00f6tt\u00f6laitteen (esim. n\u00e4pp\u00e4imist\u00f6n) eventin (esim. painallus) kulkua Kernelist\u00e4 n\u00e4yt\u00f6lle X:n ja Waylandin kohdalla.</p> <p>Tip</p> <p>Linux ei ole ehk\u00e4 yleisin ty\u00f6p\u00f6yt\u00e4k\u00e4ytt\u00f6j\u00e4rjestelm\u00e4, mutta se on huomattavan yleinen palvelimissa, sulautetuissa j\u00e4rjestelmiss\u00e4 ja mobiililaitteissa, pilvialustojen taustalla sek\u00e4 supertietokoneissa.  T\u00e4ll\u00e4 kurssilla Linuxia k\u00e4ytet\u00e4\u00e4n graafisena k\u00e4ytt\u00f6j\u00e4rjestelm\u00e4n\u00e4, jotta siihen voi tutustua t\u00e4ysin l\u00e4pikotaisesti - sinun ei tarvitse ajaa esimerkiksi Visual Studio Codea jossain muualla ja tyyty\u00e4 k\u00e4ytt\u00e4m\u00e4\u00e4n Linuxia kontissa/virtuaalikoneessa. Kenties voit korvata opiskeluk\u00e4yt\u00f6ss\u00e4 Windowsin kokonaan Linuxilla?</p>"},{"location":"linux/os/#wsl-komponentit","title":"WSL komponentit","text":"<p>WSL eli Windows Subsystem for Linux on Windowsin komponentti, joka mahdollistaa Linuxin ajamisen Windowsissa. </p> <p>K\u00e4yt\u00e4mme t\u00e4ll\u00e4 kurssilla mieluiten suoraan raudan p\u00e4\u00e4lle asennettua Linuxia, jotta v\u00e4ltymme ylim\u00e4\u00e4r\u00e4iselt\u00e4 monimutkaisuudelta, jonka eri k\u00e4ytt\u00f6j\u00e4rjestelmien yhteispeli luo. Tulevaisuuden kannalta on hyv\u00e4 tiet\u00e4\u00e4, ett\u00e4 Linuxia voi ajaa my\u00f6s Windowsista k\u00e4sin. Kenties haluat t\u00e4m\u00e4n kurssin j\u00e4lkeen siirty\u00e4 hybridimalliin, jossa Windows on  p\u00e4\u00e4k\u00e4ytt\u00f6j\u00e4rjestelm\u00e4si, mutta suoritat ohjelmistonkehityksen Linuxissa... jolle Windows on GUI!</p> <p>Koska t\u00e4m\u00e4 on t\u00e4m\u00e4n kurssin suhteen tulevaisuusasiaa, niin loppu teksti on admonition-infolaatikossa alla:</p> <p>WSL</p> <p>Kun luet t\u00e4t\u00e4 infolaatikkoa, on suositeltavaa avata arkkitehtuurikuvaajat auki selvent\u00e4m\u00e4\u00e4n tilannetta. Kirjoitushetkell\u00e4 kenties parhaat kuvaajat ovat: </p> <ul> <li>wsl.dev: WLS Overview, </li> <li>code: Developing in WSL </li> <li>gh:wslg: WSLg Architecture Overview.</li> </ul> <p>Windows Subsystem for Linux (WSL) on Windowsin komponentti, joka mahdollistaa Linux-virtuaalikoneen ajamisen Windowsin rinnalla hyvinkin l\u00e4hell\u00e4 rautaa. Jos sinulla on Windowsissa Docker Desktop asennettuna, sinulla on jo mit\u00e4 varmemmin WSL 2.0 asennettuna ja sinulta l\u00f6ytyy jakelu nimelt\u00e4\u00e4n <code>docker-desktop</code>. Windowsissa ajettavat Linux-kontit ajetaan siis virtuaalikoneessa, toisin kuin t\u00e4ll\u00e4 kurssilla esitellyt Linuxissa natiivisti ajettavat kontitetut prosessit (esim. Dockerin avulla).</p> <p>Koska t\u00e4m\u00e4 on Linux-kurssi, on aiheellista pohtia, mit\u00e4 WSL:n konepellin alla oikeastaan tapahtuu. Kaiken pohjalla on Microsoftin Virtual Machine Platform, joka py\u00f6ritt\u00e4\u00e4 Microsoft Linux kerneli\u00e4. Kutakin asennettua jakelua varten ei asenneta uutta virtuaalikonetta, vaan eri virtuaalikoneet hy\u00f6dynt\u00e4v\u00e4t samaa kerneli\u00e4. Windowsin p\u00e4\u00e4ss\u00e4 suoritetaan keskeisen\u00e4 palveluna WslService, joka hallinnoi istuntoja. N\u00e4it\u00e4 jakeluita voivat olla esimerkiksi::</p> <ul> <li>K\u00e4ytt\u00e4j\u00e4n asentamat distrot:<ul> <li>esim. Storesta asennettu Ubuntu</li> <li>esim. PowerShellist\u00e4 asennettu Fedora</li> <li>esim. Docker Desktopin asentama Ubuntu (nimelt\u00e4\u00e4n <code>docker-desktop</code>)</li> </ul> </li> <li>N\u00e4kym\u00e4t\u00f6n servicetaso:<ul> <li>WSLg (CBL Mariner Linux)</li> </ul> </li> </ul> <p>Microsoft CBL-Mariner Linux on Azuresta tuttu jakelu, jossa ajetaan t\u00e4ss\u00e4 tapauksessa Wayland- ja PulseAudio-servereit\u00e4. T\u00e4m\u00e4 mahdollistaa graafisten Linux-sovellusten ajamisen Windows-n\u00e4kym\u00e4st\u00e4 k\u00e4sin. On siis t\u00e4ysin mahdollista ajaa <code>Ubuntu for Windows</code>:ssa komento <code>sudo apt install nautilus</code> ja avata jatkossa Nautilus Windowsin Windowsin aloitusvalikosta. Nautilus on GNOME-ty\u00f6p\u00f6yt\u00e4ymp\u00e4rist\u00f6n tiedostonhallintaohjelma, mik\u00e4 tulee sinulle tutuksi kurssin aikana \u2013 eli siis Ubuntussa tavallinen tiedostonhallintaohjelma, jolla navigoit hakemistoissa ja avaat tiedostoja.</p> <p>My\u00f6s tiedostop\u00e4\u00e4sy toimii ristiin:</p> <ul> <li>Windowsista k\u00e4sin Linux-tiedostot n\u00e4kyv\u00e4t osoitteessa <code>\\\\wsl$\\</code> (esim. <code>\\\\wsl$\\docker-desktop\\home\\user\\</code>) ja voit k\u00e4ytt\u00e4\u00e4 niit\u00e4 Windowsin tiedostonhallinnassa.</li> <li>Linuxista k\u00e4sin Windows-tiedostot n\u00e4kyv\u00e4t <code>/mnt/c/</code>-hakemistossa (esim. <code>/mnt/c/Users/user/Documents/</code>).</li> </ul> <p>T\u00e4st\u00e4 tiedostojen ristiin toiminnasta vastaa Plan 9 -serveri Linuxin puolella. Mik\u00e4li kirjoitat Linuxista tiedostoja <code>/mnt/c/</code>-hakemistoon, ne n\u00e4kyv\u00e4t Windowsin puolella <code>C:\\</code>-hakemistossa. Kirjoitus- ja lukuoperaatiot k\u00e4ytt\u00e4v\u00e4t 9P-protokollaa, mik\u00e4 luonnollisesti hidastaa tiedostojen k\u00e4sittely\u00e4 verrattuna natiiviin p\u00e4\u00e4syyn.</p> <p>T\u00e4m\u00e4n infolaatikon lukemisen j\u00e4lkeen sinulla on toivottavasti ajatus, ett\u00e4 Linuxia opetellessa t\u00e4m\u00e4 kahden j\u00e4rjestelm\u00e4n rinnakkaiselo on monimutkainen lis\u00e4, jonka vuoksi on suositeltavaa k\u00e4ytt\u00e4\u00e4 Linuxia natiivisti ainakin aluksi. Kun Linuxin perusteet ovat hallussa, valitse sinulle jatkossa sopivin ty\u00f6skentelytapa.</p>"},{"location":"linux/os/#linux-ja-distribuutiot-tanaan","title":"Linux ja distribuutiot t\u00e4n\u00e4\u00e4n","text":"<p>Linux on nyky\u00e4\u00e4n yksi maailman suosituimmista k\u00e4ytt\u00f6j\u00e4rjestelmist\u00e4 \u2014 ellei suosituin. Se on tyypillinen k\u00e4ytt\u00f6j\u00e4rjestelm\u00e4 palvelimissa, mobiililaitteissa ja monissa sulautetuissa j\u00e4rjestelmiss\u00e4. Tyypillisesti asennat Linuxin (tai GNU/Linuxin) k\u00e4ytt\u00e4en jotakin distribuution asennusohjelmaa, joka kopioidaan asennusmediaan (esim. USB-tikku tai CD-ROM). Jos mobiililaitteet (Android) unohdetaan, niin suurimmat pelurit Linuxin distribuutioiden markkinoilla ovat Debian ja Red Hat. N\u00e4it\u00e4 sanotaan perheiksi, joihin kuuluu useita jakeluita, jotka perustuvat yhteiseen alkuper\u00e4iseen jakeluun (eli \"yhteinen upstream\").</p> <ul> <li>Debian<ul> <li>Debian on itsen\u00e4inen Linux-jakelu ja Debian-perheeseen kuuluu Canonicalin Ubuntu ja sen perilliset (Linux Mint, Zorin OS, Pop!_OS jne.)</li> </ul> </li> <li>Red Hat<ul> <li>Red Hat -perheeseen kuuluu itsen\u00e4inen jakelu Fedora ja sen perilliset sek\u00e4 perillisten perilliset (RHEL, CentOS Stream, Rocky jne.)</li> </ul> </li> </ul> <p>Tip</p> <p>Red Hat Enterprise Linux (RHEL) on maksullinen, mutta jos haluat tutustua siihen, saat ilmaisen lisenssin Red Hat Developer -sivustolta ei-kaupalliseen k\u00e4ytt\u00f6\u00f6n. Mik\u00e4li t\u00e4m\u00e4 kiinnostaa, voit k\u00e4yt\u00e4 my\u00f6s Red Hat Academyn kursseja. Ota yhteys opettajaan: h\u00e4n voi avata sinulle p\u00e4\u00e4syn n\u00e4ihin kursseihin.</p> <p>Muitakin itsen\u00e4isi\u00e4 jakeluita l\u00f6ytyy, kuten Slackware, Gentoo, Arch Linux, openSUSE. Tutustu n\u00e4ihin joko heid\u00e4n omilla sivuillaan tai DistroWatch-sivustolla. Ty\u00f6el\u00e4m\u00e4ss\u00e4 k\u00e4yt\u00e4t suurella todenn\u00e4k\u00f6isyydell\u00e4 joko Red Hat -perheen tai Debian-perheen jakelua. N\u00e4ihin voit tutustua esimerkiksi asentamalla CentOS Stream:n ja Ubuntun virtuaalikoneisiin - kuten t\u00e4ll\u00e4 kurssilla tehd\u00e4\u00e4n. Huomaa, ett\u00e4 edes DistroWatch ei sis\u00e4ll\u00e4 kaikkia olemassa olevia jakeluita, koska niiden lis\u00e4\u00e4minen sivuilla on vapaaehtoista. Esimerkiksi Opinsys Oy:n jakelu Puavo OS puuttuu kirjoitushetkell\u00e4 DistroWatchista. Puavo OS on Debian-pohjainen jakelu, joka on kehitetty erityisesti koulumaailman tarpeisiin. Tutustu ihmeess\u00e4 heid\u00e4n verkkosivuihin.</p> <p>Quote</p> <p>More than 60 percent of customer cores in Azure run Linux workloads. Choose from popular Linux distributions including Red Hat, SUSE, Ubuntu, CentOS, Debian, and CoreOS. - Microsoft Azure</p> <p>Konttien ja Dockerin my\u00f6t\u00e4 Linux on yleistynyt my\u00f6s ohjelmistonkehitt\u00e4jien Windows ja macOS ty\u00f6asemissa. T\u00e4ll\u00f6in kehitt\u00e4jill\u00e4 on Windows/mac-ty\u00f6asema, jossa py\u00f6rii Linux-virtuaalikone, jossa py\u00f6rii Docker-kontteja. Docker siis k\u00e4yt\u00e4nn\u00f6ss\u00e4 vaatii Linuxin - joko ihan oikean asennuksen tai esimerkiksi WSL:n (Windows Subsystem for Linux). Huomaathan, ett\u00e4 Docker ei kuitenkaan ole ainut peluri konttien maailmassa, vaan esimerkiksi Podman on Dockerin vaihtoehto. T\u00e4m\u00e4 on yleisempi Red Hat -perheen jakeluissa.</p> <p></p> <p>Kuvio 3: Linuxin k\u00e4ytt\u00f6 supertietokoneissa. (By Benedikt.Seidl - Eigenes Werk (own work) / source top500.org, Public Domain, https://commons.wikimedia.org/w/index.php?curid=5932978).</p>"},{"location":"linux/os/#tehtavat","title":"Teht\u00e4v\u00e4t","text":"<p>Teht\u00e4v\u00e4: K\u00e4ytt\u00f6j\u00e4rjestelm\u00e4n tarve</p> <p>Selvit\u00e4, mihin k\u00e4ytt\u00f6j\u00e4rjestelm\u00e4\u00e4 ylip\u00e4\u00e4t\u00e4ns\u00e4 tarvitaan. Onko se v\u00e4ltt\u00e4m\u00e4t\u00f6n osa tietokonetta? Olisiko tietokone nopeampi vai hitaampi ilman k\u00e4ytt\u00f6j\u00e4rjestelm\u00e4\u00e4? Mit\u00e4 k\u00e4ytt\u00f6j\u00e4rjestelm\u00e4 tuo tietokoneelle tai sen k\u00e4ytt\u00e4j\u00e4lle, jota ei ilman sit\u00e4 voisi saavuttaa? Oliko esimerkiksi 8-bittisess\u00e4 NES:ss\u00e4 (Nintendo Entertainment System) k\u00e4ytt\u00f6j\u00e4rjestelm\u00e4\u00e4?</p> <p>Teht\u00e4v\u00e4: Graafinen k\u00e4ytt\u00f6liittym\u00e4</p> <p>Tutustu asentamasi Linux-distribuution graafiseen k\u00e4ytt\u00f6liittym\u00e4\u00e4n. Mit\u00e4 n\u00e4yt\u00f6nhallintaj\u00e4rjestelm\u00e4\u00e4 se k\u00e4ytt\u00e4\u00e4? Mit\u00e4 ty\u00f6p\u00f6yt\u00e4ymp\u00e4rist\u00f6\u00e4 (tai ikkunointij\u00e4rjestelm\u00e4n)? Vastauksia l\u00f6yd\u00e4t distribuution omilta sivuilta tai esimerkiksi DistroWatch-sivustolta, mutta kokeile my\u00f6s, l\u00f6ytyyko vastaus Terminaalin avulla. Terminaalin k\u00e4ytt\u00f6 neuvotaan vasta my\u00f6hemmin, mutta voit kokeilla jo nyt ajaa l\u00f6yt\u00e4mi\u00e4si komentoja. </p> <p>Teht\u00e4v\u00e4: Wayland vs X11</p> <p>Wayland on korvaamassa/korvannut X11:n. Tutustu Waylandiin ja sen eroihin X11:een esimerkiksi lukemalla artikkelin Wayland Architecture. Miksi Wayland on kehitetty? Mit\u00e4 eroja Waylandilla on X11:een verrattuna?</p> <p>Teht\u00e4v\u00e4: Suositellut jakelut</p> <p>T\u00e4ll\u00e4 kurssilla suositellaan Ubuntu-jakelua (eng. distribution). Etsi internetist\u00e4 suositeltujen distribuutioiden listoja - erityisesti aloittelijoille, mutta miksei my\u00f6s eri k\u00e4ytt\u00f6ihin. Mit\u00e4 distribuutioita l\u00f6yd\u00e4t listoilta?</p> <p>Teht\u00e4v\u00e4: LTS-lyhenne</p> <p>Ubuntun version 24.04 yhteydess\u00e4 esiintyy LTS-lyhenne. Mit\u00e4 LTS tarkoittaa?</p>"},{"location":"paketinhallinta/cross-distro/","title":"Cross-distro","text":"<p>Kuvio 1: Ubuntu Software store. Useimmat ohjelmat, kuten Text Editor, voi asentaa Snap Storesta. Joskus vaihtoehtona n\u00e4kyy ATP, kuten kuvakaappauksessa (ubuntu-jammy-main, joka viittaa apt repositorioon main, versioon jammy eli t\u00e4ss\u00e4 tapauksessa 22.04)</p> <p>Aiemmin mainittujen, tiettyyn distribuutioon (tai sen j\u00e4lkil\u00e4isiin) sidottujen paketinhallintaj\u00e4rjestelmien lis\u00e4ksi on olemassa my\u00f6s j\u00e4rjestelmi\u00e4, jotka toimivat useissa eri distribuutioissa. N\u00e4ist\u00e4 esitell\u00e4\u00e4n lyhyesti alla kolme: Flatpak, AppImage ja Snap, joista j\u00e4lkimm\u00e4iseen viitataan my\u00f6s yll\u00e4 n\u00e4kyv\u00e4ss\u00e4 Kuvio 1:ss\u00e4. Helpon asennuksen lis\u00e4ksi useimmat n\u00e4ist\u00e4 pyrkiv\u00e4t tarjoamaan turvallisuuteen liittyvi\u00e4 ominaisuuksia joko siten, ett\u00e4 ohjelma voidaan asentaa ja ajaa lokaalisti k\u00e4ytt\u00e4j\u00e4n omilla tunnuksilla ja oikeuksilla, tai siten, ett\u00e4 ohjelma ajetaan konttia muistuttavassa sandbox-ymp\u00e4rist\u00f6ss\u00e4.</p>"},{"location":"paketinhallinta/cross-distro/#appimage","title":"AppImage","text":"<p>AppImage on \u00e4\u00e4rimm\u00e4isen yksinkertainen paketti k\u00e4ytt\u00e4\u00e4. Toisin kuin muut t\u00e4ss\u00e4 dokumentissa mainitut paketinhallintaj\u00e4rjestelm\u00e4t, AppImage ei asenna mit\u00e4\u00e4n minnek\u00e4\u00e4n, eik\u00e4 paketinhallinta itsess\u00e4\u00e4n vaadi mink\u00e4\u00e4n sortin asentamista.</p> <p>Vaiheet ovat n\u00e4inkin simppelit:</p> <ol> <li>Etsi haluamasi sovellus AppImageHubista, kuten vaikkapa e-kirjojen lukemiseen soveltuva Calibre.</li> <li>Lataa tuore versio ohjelmisto .</li> </ol> Bash<pre><code># Navigoi kotikansiosi lokaalien sovellusten hakemistoon\n$ cd ~/.local/bin/\n\n# Siirr\u00e4 tiedosto latauskansiosta\n$ mv ~/Downloads/Calibre-x86-64-20230918202913.AppImage calibre.AppImage\n\n# Tee tiedostosta ajettava ja aja se\n$ chmod u+x calibre.AppImage\n$ ./calibre.AppImage\n</code></pre> <p>Sovellusvalikoima on kuitenkin AppImagessa ainakin kirjoitushetkell\u00e4 huomattavasti suppeampi kuin kilpailijoissa, ja lis\u00e4ksi ARM-prosessorille soveltuvia sovelluksia on merkitt\u00e4v\u00e4sti v\u00e4hemm\u00e4n kuin <code>x84_64</code>:lle.</p>"},{"location":"paketinhallinta/cross-distro/#flatpak","title":"Flatpak","text":"<p>Flatpakin itsens\u00e4 voi asentaa Ubuntuun Flatpakin ohjeiden mukaisesti komennolla:</p> Bash<pre><code>$ sudo apt install flatpak\n</code></pre> <p>Flatpakin avulla asennettavia ohjelmia voi etsi\u00e4 Flathub:sta. Repositorion itsens\u00e4 ja ohjelmat voi asentaa joko k\u00e4ytt\u00e4j\u00e4n omiin hakemistoihin tai j\u00e4rjestelm\u00e4nlaajuisesti. T\u00e4m\u00e4 asetetaan <code>--user</code>- tai <code>--system</code>-flagilla. N\u00e4ist\u00e4 j\u00e4lkimm\u00e4inen on default, ja se vaatii sudo-oikeudet.</p> <p>Esimerkiksi HandBrake CLI:n, jolla voi muun muassa enkoodata videotiedostoja, voi asentaa ilman sudo-oikeuksia n\u00e4in:</p> Bash<pre><code># Lis\u00e4\u00e4 Flatpak repo\n$ flatpak --user remote-add \\\n--if-not-exists flathub \\\nhttps://dl.flathub.org/repo/flathub.flatpakrepo\n\n# Lokaalista tiedostosta\n$ flatpak --user install HandBrakeCLI-1.4.2-x86_64.flatpak\n</code></pre> <p>Tai kenties haluat eroon Snapin hallitsemasta Firefoxista ja siirty\u00e4 Flatpakin asentamaan ja hallitsemaan chromiumiin?</p> Bash<pre><code># Poista Snap koko j\u00e4rjestelm\u00e4st\u00e4. Eth\u00e4n tee t\u00e4t\u00e4 koneilla, joilla muut k\u00e4ytt\u00e4j\u00e4t saattavat haluta k\u00e4ytt\u00e4\u00e4 Firefoxia. Se oikeasti poistuu.\n$ sudo snap remove firefox\n\n# Asenna Chromium\n$ sudo flatpak install flathub org.chromium.Chromium\n</code></pre> <p>Warning</p> <p>Saatat joutua lis\u00e4\u00e4m\u00e4\u00e4n <code>remote-add</code>:ll\u00e4 repositorion erikseen system-wide. P\u00e4\u00e4ttele, mill\u00e4 komennolla t\u00e4m\u00e4 hoituu k\u00e4ytt\u00e4en yll\u00e4 n\u00e4kyv\u00e4\u00e4 user-wide esimerkki\u00e4.</p> <p>Yll\u00e4 olevan komennon j\u00e4lkeen sinun pit\u00e4\u00e4 logata ulos ja sis\u00e4\u00e4n Gnomesta (tai muusta ty\u00f6p\u00f6yt\u00e4ymp\u00e4rist\u00f6st\u00e4.) T\u00e4m\u00e4n j\u00e4lkeen voit painaa Win (tai Cmd) n\u00e4pp\u00e4int\u00e4, etsi\u00e4 Chromiumin, ja joko k\u00e4ynnist\u00e4\u00e4 sen tai lis\u00e4t\u00e4 sen hiiren oikealla korvalla Favoritesiin, miss\u00e4 Firefox todenn\u00e4k\u00f6isesti aiemmin oli.</p> <p>Flatpak erist\u00e4\u00e4 sovellukset muusta k\u00e4ytt\u00f6j\u00e4rjestelm\u00e4st\u00e4 omiin sandboxeihin. Lue lis\u00e4\u00e4 siit\u00e4, kuinka Flatpak toimii konepellin alla: Under the Hood \u2014 Flatpak documentation</p>"},{"location":"paketinhallinta/cross-distro/#snap","title":"Snap","text":"<p>Snap-ohjelmaan liittyv\u00e4t seuraavat termit:</p> Termi Selitys Snap Applikaatio-bundle, joka sis\u00e4lt\u00e4\u00e4 kaikki tarvittavat riippuvuudet. Snapd Taustalla ajettava daemon eli service, joka huolehtii asennetuista snapeista. Snap Store Alusta tai katalogi, joka l\u00f6ytyy verkosta, ja johon snapit l\u00e4hetet\u00e4\u00e4n k\u00e4ytt\u00e4jien ladattaviksi. Snapcraft Ajettavan komennon ja frameworkin nimi. <p>Snap erist\u00e4\u00e4 ohjelmat muusta k\u00e4ytt\u00f6j\u00e4rjestelm\u00e4st\u00e4 omiin sandboxeihin:</p> <p>To support this, each package is sandboxed so that it runs in a constrained environment, isolated from the rest of the system \u2013 this is achieved via a combination of AppArmor, seccomp, mount namespaces, cgroups and traditional UNIX permissions. -- Ubuntu.com</p> <p>Canonical on sek\u00e4 Snapcraftin ett\u00e4 Ubuntun takana. Siisp\u00e4 ei liene liene yll\u00e4tys, ett\u00e4 snap on Ubuntussa valmiiksi asennettuna. Mik\u00e4li k\u00e4yt\u00e4t jotakin toista distribuutiota, jossa snap ei ole vakiona asennettuna, etsi ohje mieluiten suoraan ty\u00f6kalun omasta dokumentaatiosta, kuten: Installing the daemon. Ohjelmien listaaminen ja asentaminen on helppoa, katso komennot alta:</p> Bash<pre><code># Listaa asennetut\n$ snap list\n\n# Asenna ohjelma\n$ sudo snap install &lt;program&gt;\n</code></pre> <p>Tip</p> <p>Huomaa, ett\u00e4 paketit asennetaan <code>/snap</code>-hakemistoon eik\u00e4 tyypilliseen <code>/usr/bin</code>-hakemistoon. Esimerkiksi firefoxin l\u00f6yt\u00e4\u00e4 <code>/snap/bin/firefox</code>-polusta. Tiedosto <code>/usr/bin/firefox</code> l\u00f6ytyy $PATH:sta, mutta jos ajat komennon <code>file /usr/bin/firefox</code>, n\u00e4et, ett\u00e4 se on ihan vain ASCII shell script. Tiedosto itsess\u00e4\u00e4n ajaa <code>/snap/bin/firefox</code>-tiedoston. T\u00e4m\u00e4 sen sijaan on symbolinen linkki <code>/usr/bin/snap</code>-tiedostoon, joka on itse asiassa bin\u00e4\u00e4ri. T\u00e4m\u00e4 bin\u00e4\u00e4ri nuuhkii argumentit (<code>$0</code>) ja suorittaa oikean ohjelman.</p> <p>Ohjelmia ei ole tarpeellista p\u00e4ivitt\u00e4\u00e4 k\u00e4sin. Ne voi p\u00e4ivitt\u00e4\u00e4 <code>sudo snap refresh</code>-komennolla, mutta snap tekee t\u00e4m\u00e4n automaattisesti vakiona 6 tunnin v\u00e4lein.</p> <p>Huomaa, ett\u00e4 t\u00e4m\u00e4 lyhyt ohje on todellakin vain lyhyt ohje. Snapin k\u00e4ytt\u00f6\u00f6n liittyy paljon muutakin, kuten esimerkiksi oikeuksien hallinta, joka on toteutettu k\u00e4ytt\u00e4m\u00e4ll\u00e4 interfaces, tai snapshots, joka sallii ohjelmien palauttamisen aiempaan tilaan. Lis\u00e4ksi snap:ll\u00e4 asennetut palvelut ovat hallittavissa services-komennolla. N\u00e4ihin toiminnallisuuksiin voit tutustua Snap how-to guides-sivulla.</p>"},{"location":"paketinhallinta/cross-distro/#tehtavat","title":"Teht\u00e4v\u00e4t","text":"<p>Teht\u00e4v\u00e4: Asenna snap:ll\u00e4</p> <p>K\u00e4ytt\u00e4en komentorivi\u00e4, asenna valitsemasi ohjelma Canonicalin \"app storesta\" eli SnapCraftista.</p> <p>Teht\u00e4v\u00e4: Snap-sovellusten lokaatio</p> <p>Selvit\u00e4, miss\u00e4 hakemistossa asentamasi snap-sovellus sijaitsee.</p> <p>Teht\u00e4v\u00e4: Asenna Flatpakilla</p> <p>Asenna Flatpak. Tutustu Flatpakin tarjontaan ja valitse sinua kiinnostava ohjelma. Asenna se k\u00e4ytt\u00e4en Flatpakia.</p> <p>Huomaa, ett\u00e4 monet ohjelmat voi asentaa useasta eri l\u00e4hteest\u00e4. Esimerkiksi OBS Studio on saatavilla sek\u00e4 Flathubista ett\u00e4 Snapcraftista ett\u00e4 PPA:sta, joka on sinulle tuttu aiemmista teht\u00e4vist\u00e4.</p> <p>Apua valintaan?</p> <p>Jos et osaa yht\u00e4\u00e4n p\u00e4\u00e4tt\u00e4\u00e4, mit\u00e4 asentaisit, kenties jokin n\u00e4ist\u00e4 kiinnostaa sinua:</p> <ul> <li>GPU Screen Recorder. Hy\u00f6dyllinen, yksinkertainen ohjelma, joka tekee saman kuin OBS Studio, mutta hy\u00f6dynt\u00e4en Nvidia, AMD tai Intel GPU:ta. T\u00e4m\u00e4 voi kiinnostaa sinua, jos sinulla on oikean raudan p\u00e4\u00e4lle asennettu Linux.</li> <li>Picocrypt. Ohjelma, joka salaa ja purkaa tiedostoja. Hy\u00f6dyllinen, jos haluat pit\u00e4\u00e4 tiedostosi turvassa.</li> <li>Vieb. Minimalistinen selain.</li> <li>Ignition. Ohjelma, joka mahdollistaa ohjelmien tai skriptien ajamisen loginin yhteydess\u00e4 yksikertaisen UI:n kautta.</li> <li>Gaia Sky. Ohjelma, joka visualisoi galaksin ja sen sis\u00e4ll\u00f6n. P\u00e4\u00e4set lentelem\u00e4\u00e4n pitkin linnunrataa 3D:n\u00e4.</li> <li>PySoIFC. Yli 1300 erilaista korttipeli\u00e4 yhdess\u00e4 ohjelmassa.</li> <li>Darktable. RAW-kuvien k\u00e4sittelyyn tarkoitettu digitaalinen pimi\u00f6. Kilpailija siis Lightroomille tai Capture Onelle.</li> <li>Tangram. Selain, joka keskitty Web Appien erist\u00e4miseen toisistaan, joka helpottaa esim. Gmail tai Teams:n Web Appien k\u00e4ytt\u00f6\u00e4, jos sinulla on useita eri tilej\u00e4.</li> </ul> <p>Ohjelmat on valittu Linux Format lehden April 2025 numerosta (Hot Picks -osiosta).</p> <p>Teht\u00e4v\u00e4: Flatpak-sovellusten lokaatio</p> <p>Selvit\u00e4, miss\u00e4 hakemistossa asentamasi Flatpak-sovellus sijaitsee.</p> <p>Teht\u00e4v\u00e4: Asenna Go</p> <p>Joidenkin ohjelmien tyypillinen asennustapa on purkaa bin\u00e4\u00e4rit suoraan oikeaan lokaatioon. FSH:n mukaan t\u00e4h\u00e4n sopii <code>/usr/local/bin</code>-hakemisto. Yksi n\u00e4in asennettavista ohjelmista on Go. Kyseess\u00e4 on Googlen kehitt\u00e4m\u00e4 ohjelmointikieli ja siihen liittyv\u00e4 Go Tool CLI-ty\u00f6kalu. Kielt\u00e4 hy\u00f6dynt\u00e4v\u00e4t Googlen lis\u00e4ksi Meta, Dropbox, Paypal ja monet muut. </p> <p>Asenna Go Download and install-sivuston ohjeiden mukaisesti.</p> <p>Vinkki: Huomaa, ett\u00e4 <code>&amp;&amp;</code>-komentojen j\u00e4lkeen alkaa uusi komento. Jos k\u00e4yt\u00e4t <code>sudo</code>-komentoa, seuraava komento saattaa vaatia uuden <code>sudo</code>-kutsun.</p> <p>Vinkki: Mihin tiedostoon <code>PATH</code>-ymp\u00e4rist\u00f6muuttujan lis\u00e4ys kannattaa tehd\u00e4, jos sinulla ei olekaan Bash k\u00e4yt\u00f6ss\u00e4 vaan Zsh? Tarkista Startup-tiedostot-tunnin materiaaleista, mik\u00e4 kotikansion tiedosto on nimenomaan Z-shellin ENV:i\u00e4 varten.</p> <p>Kun olet saanut Go:n asennettua onnistuneesti, kannattaa tehd\u00e4 se, mik\u00e4 tehd\u00e4\u00e4n aina uuden ohjelmointikielen \u00e4\u00e4rell\u00e4: hello world -ohjelma! T\u00e4m\u00e4 onnistuu seuraavanlaisesti. Luo alkuun tiedosto, joka sis\u00e4lt\u00e4\u00e4 go-kielist\u00e4 l\u00e4hdekoodia:</p> hello.go<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Println(\"Hello, World!\")\n}\n</code></pre> <p>T\u00e4m\u00e4n j\u00e4lkeen aja tiedosto komentorivilt\u00e4:</p> Bash<pre><code>go run hello.go\n</code></pre> <p>Nyt voit aloittaa uuden ohjelmointikielen opiskelun. Fantastista, eik\u00f6? \ud83c\udf89</p>"},{"location":"paketinhallinta/ohjelmapaketit/","title":"Ohjelmapaketit","text":"<p>Kuten aiemmassa luvussa todettiin, applikaatiot jaellaan perinteisesti ohjelmapaketteina (eng. package). Tyypillisesti paketit ovat joitakin seuraavista:</p> Tiedostop\u00e4\u00e4te Kuvaus .deb Debian-pohjaisten distribuutioiden k\u00e4ytt\u00e4m\u00e4 formaatti. .rpm Red Hat  -pohjaisten distribuutioiden k\u00e4ytt\u00e4m\u00e4 formaatti. .pkg.tar.zst Arch Linuxin pacmanin k\u00e4ytt\u00e4m\u00e4 formaatti. .apk Alpine:n apk:n k\u00e4ytt\u00e4m\u00e4 formaatti. .ebuild Gentoo:n Portagen k\u00e4ytt\u00e4m\u00e4 formaatti. .tar, .tar.gz, tar.bz2 Ei varsinaisesti oma formaatti paketeille, mutta osa ohjelmistoista levitet\u00e4\u00e4n pakattuina tar-paketteina (tarball), ja macOS:n ekosysteemist\u00e4 tuttu HomeBrew k\u00e4ytt\u00e4\u00e4 t\u00e4t\u00e4 formaattia konepellin alla. <p>Warning</p> <p>Jos jokin ohjelma k\u00e4skee asentamaan itsens\u00e4 tarballista (<code>.tar.gz</code> tai <code>.tar</code>), yleens\u00e4 sis\u00e4lt\u00e4en vaiheita <code>./configure</code>, <code>make</code> ja <code>sudo make install</code>, ohjelma asennetaan Linuxiin siten, ett\u00e4 se ja sen riippuvuudet eiv\u00e4t kuulu paketinhallinnan piiriin. Ohjelma ja sen riippuvuudet voi olla huomattavan vaikea poistaa, joskin komento <code>sudo make uninstall</code> saattaa toimia. L\u00e4ht\u00f6kohtaisesti kannattaa v\u00e4ltell\u00e4 <code>tarball</code>-tyylist\u00e4 l\u00e4hestymistapaa, mik\u00e4li ohjelman voi asentaa jollakin muulla tavalla kuten <code>apt-get</code> tai <code>yum</code>:n avulla. Debian-pohjaissa j\u00e4rjestelmiss\u00e4 on mahdollista luoda l\u00e4hdekoodista <code>.deb</code>-paketti k\u00e4ytt\u00e4en CheckInstall):ia <code>sudo make install</code>:n sijasta. N\u00e4in asennetut ohjelmat kuuluvat paketinhallinnan piiriin ja ne voidaan poistaa <code>apt-get</code>-komentojen avulla.</p>"},{"location":"paketinhallinta/ohjelmapaketit/#paketinhallintaohjelmisto","title":"Paketinhallintaohjelmisto","text":"<p>Paketteja (<code>.deb</code> ja <code>.rpm</code> ynn\u00e4 muita) ei ole tarkoitettu ajettavaksi sin\u00e4ll\u00e4\u00e4n, vaan ne asennetaan paketinhallintaohjelmiston avulla (eng. package manager). Paketinhallintaohjelmisto tiet\u00e4\u00e4 k\u00e4ytt\u00e4m\u00e4ns\u00e4 paketin skeeman: mist\u00e4 l\u00f6ytyy konfiguraatiot, kuinka niit\u00e4 luetaan, mihin ohjelma kuuluu asentaa, kuinka ohjelma kuuluu asentaa, ja niin edelleen.</p> <p>On hyvin todenn\u00e4k\u00f6ist\u00e4, ett\u00e4 olet t\u00e4ll\u00e4 kursilla asentanut joko Debian tai Red Hat -pohjaisen distribuution, joten keskityt\u00e4\u00e4n niiden paketinhallintaan. N\u00e4iden paketteja asennetaan, hallitaan ja poistetaan tyypillisesti ty\u00f6kaluille, jotka n\u00e4kyv\u00e4t alla olevassa graafissa. Huomaa, ett\u00e4 Debian-pohjaisesta distribuutiosta l\u00f6ytyv\u00e4t yleens\u00e4 kaikki graafissa n\u00e4kyv\u00e4t, ja ne ovat j\u00e4rjestyksess\u00e4 matalamman tason ohjelmasta ylemm\u00e4n tason ohjelmaan: <code>dpkg</code>, <code>apt-get</code>, <code>apt</code>, <code>aptitude</code>. Red Hat -pohjaisissa distribuutioissa on jokin tai jotkin graafissa n\u00e4kyvist\u00e4 ohjelmista. Distrojen vanhemmat versiot kuten Amazon Linux 2, CentOS, Fedora ja RHEL k\u00e4ytt\u00e4v\u00e4t <code>yum</code>:ia. Amazon Linux 3 ja muiden distrojen tuoreemmat versiot ovat siirtyneet k\u00e4ytt\u00e4m\u00e4\u00e4n <code>DNF</code>:\u00e4\u00e4. Sen sijaan <code>Zypper</code> on SUSE:ssa k\u00e4yt\u00f6ss\u00e4.</p> <pre><code>graph\n    subgraph \"Red Hat -pohjaiset\"\n        .rpm --&gt; rpm \n        rpm --&gt; yum\n        rpm --&gt; DNF\n        rpm --&gt; Zypper\n    end\n    subgraph \"Debian-pohjaiset\"\n        .deb --&gt; dpkg \n        dpkg --&gt; apt-get\n        dpkg --&gt; apt\n        dpkg --&gt; aptitude\n    end\n\n</code></pre>"},{"location":"paketinhallinta/ohjelmapaketit/#repositoriot","title":"Repositoriot","text":"<p>Yleisesti ottaen paketteja (<code>.deb</code> tai <code>.rpm</code>) ei ladata k\u00e4sin koneelle, ellei ole tarvetta suorittaa offline-asennussta. Paketinhallintaohjelmistot hakevat paketit suoraan repositoriosta. K\u00e4ytetyt repositoriot riippuvat distribuutiosta. Red Hat -pohjaisissa distribuutioissa voit l\u00e4hte\u00e4 liikenteelle komennosta <code>dnf repolist</code>. Esimerkiksi Ubuntussa voit tutustua aiheeseen manuaalin sivuilta, jotka l\u00f6ytyv\u00e4t komennolla: <code>man -k sources.list</code>, ja  sit\u00e4 my\u00f6den <code>cat /etc/apt/sources.list</code> sek\u00e4 <code>cat /etc/apt/sources.list.d/*</code>.</p> <p>Mik\u00e4li jokin ohjelma neuvoo sinua lis\u00e4\u00e4m\u00e4\u00e4n uuden repositorion distribuutiosi listaan, olethan varovainen. Repositorio ei ole t\u00e4ll\u00f6in distribuution luojien omassa hallussa vaan kolmannen osapuolen repo.</p> <p>Ubuntun ekosysteemiss\u00e4 on olemassa Launchpad, ja esimerkiksi Pythonista voi ladata tuoreempia versioita k\u00e4ytt\u00e4m\u00e4ll\u00e4 PPA (Personal Package Archives)-repositoriota nimelt\u00e4\u00e4n Deadsnakes</p>"},{"location":"paketinhallinta/ohjelmapaketit/#komentoja","title":"Komentoja","text":"<p>Repositorion metadatan voi p\u00e4ivitt\u00e4\u00e4 omalle koneelle yleens\u00e4 komennolla <code>update</code>. Samalla vaivalla voi yleens\u00e4 tarkistaa, mitk\u00e4 asennetuista ohjelmista ovat saaneet asennettua tuoreemman version paketinhallintaan. Tyypillisesti l\u00f6yd\u00e4t haluamasi ohjelmiston asentamiseen ja poistamiseen tarvittavat komennot ohjelmiston dokumentaatiosta, mutta peruskomennot on hyv\u00e4 tuntea.</p>"},{"location":"paketinhallinta/ohjelmapaketit/#paivita-ohjelmat","title":"P\u00e4ivit\u00e4 ohjelmat","text":"Bash<pre><code># DNF\n$ sudo dnf check-update\n$ sudo dnf upgrade\n\n# APT\n$ sudo apt update\n$ sudo apt list --upgradable\n$ sudo apt upgrade\n</code></pre>"},{"location":"paketinhallinta/ohjelmapaketit/#listaa-asennetut-ohjelmat","title":"Listaa asennetut ohjelmat","text":"Bash<pre><code># DNF\n$ dnf list installed\n\n# APT\n$ apt list --installed\n</code></pre>"},{"location":"paketinhallinta/ohjelmapaketit/#etsi-uusia-ohjelmia-ja-lue-info","title":"Etsi uusia ohjelmia ja lue info","text":"Bash<pre><code># DNF\n$ dnf search \"hakusana\"\n$ dnf info &lt;package-name&gt;\n\n# APT\n$ apt search \"hakusana\"\n$ apt info &lt;package-name&gt;\n$ apt-cache search &lt;package-name&gt;\n</code></pre>"},{"location":"paketinhallinta/ohjelmapaketit/#listaa-ohjelman-tiedostot","title":"Listaa ohjelman tiedostot","text":"Bash<pre><code># DNF\n$ rpm -ql &lt;package-name&gt;\n\n# APT (tai dpkg)\n$ dpkg -L &lt;package-name&gt;\n</code></pre>"},{"location":"paketinhallinta/ohjelmapaketit/#tee-reverse-haku-eli-katso-mihin-packageen-tiedosto-kuuluu","title":"Tee reverse-haku eli katso mihin packageen tiedosto kuuluu","text":"Bash<pre><code># DNF\n$ dnf provides /path/to/file\n\n# APT\n$ dpkg -S /path/to/file\n</code></pre>"},{"location":"paketinhallinta/ohjelmapaketit/#poista-ohjelma","title":"Poista ohjelma","text":"Bash<pre><code># DNF\n$ sudo dnf remove &lt;package-name&gt;\n$ sudo dnf autoremove # Riippuvuudet\n\n# APT\n$ sudo apt remove &lt;package-name&gt;\n$ sudo apt autoremove # Riippuvuudet\n</code></pre>"},{"location":"paketinhallinta/ohjelmapaketit/#tehtavat","title":"Teht\u00e4v\u00e4t","text":"<p>Teht\u00e4v\u00e4: Asenna ohjelma</p> <p>Asenna jokin ohjelma paketinhallinnan avulla. Valitse ohjelma itse, mutta k\u00e4yt\u00e4 paketinhallintaa (apt). Voit asentaa esimerkiksi <code>nsnake</code>-pelin, joka on terminaalissa toimiva matopeli.</p> <p>Teht\u00e4v\u00e4: Selvit\u00e4 ohjelman tiedostot</p> <p>Selvit\u00e4, miss\u00e4 ohjelman <code>nsnake</code> tiedostot sijaitsevat. K\u00e4yt\u00e4 <code>dpkg</code>- tai <code>rpm</code>-komentoa.</p> <p>Teht\u00e4v\u00e4: Asennuslokaatiot</p> <p>Eri tavoin asennetut ohjelmat sijoittuvat eri paikkoihin. Selvit\u00e4, mit\u00e4 eroa on seuraavilla usein k\u00e4yt\u00f6ss\u00e4 olevilla lokaatioilla.</p> <ul> <li><code>/usr/bin</code></li> <li><code>/usr/local/bin</code></li> <li><code>/opt</code></li> <li><code>/home/$USER/.local/bin</code></li> </ul> <p>Teht\u00e4v\u00e4: Sources.List</p> <p>Tutustu <code>sources.list</code>-tiedostoon ja siihen liittyv\u00e4\u00e4n <code>sources.list.d</code>-hakemistoon. Mist\u00e4 hakemistosta ne l\u00f6ytyv\u00e4t? Mik\u00e4 on niiden tarkoitus. Kannattaa hy\u00f6dynt\u00e4\u00e4 <code>man 5 sources.list</code>-komennon antamaa tietoa.</p> <p>K\u00e4yt\u00e4nn\u00f6n esimerkin l\u00f6yd\u00e4t Azure CLI:n asennusohjeista: Install the Azure CLI on Linux</p> <p>Vinkki: tutustu my\u00f6s Ubuntu Desktop Guide: Add software repositories</p> <p>Teht\u00e4v\u00e4: Mik\u00e4 on PPA?</p> <p>Ubuntun ekosysteemiss\u00e4 Launchpad on forge-tyylinen palvelu, jossa on sek\u00e4 koodivarastoja ett\u00e4 pakettivarastoja. PPA:n tunnistaa muodosta <code>ppa:username/ppa-name</code>, joka viittaa pidemp\u00e4\u00e4n <code>http://ppa.launchpad.net/username/ppa-name/ubuntu</code> URL:iin</p> <p>Esimerkki: </p> <ul> <li>OBS Studio<ul> <li>Asennusohjeet: obsproject.com/download</li> <li>Launchpad: obsproject/obs-studio</li> <li>PPA data: Index of /obsproject/obs-studio/ubuntu</li> </ul> </li> </ul> <p>Selvit\u00e4, mit\u00e4 PPA tarkoittaa ja miten se liittyy paketinhallintaan. OBS Studion lis\u00e4ksi l\u00f6yd\u00e4t my\u00f6s muita applikaatioita, joita ei joko l\u00f6ydy Ubuntun omista repositorioista. Yksi t\u00e4llainen on videoeditori OpenShot. Lis\u00e4ksi jotkin ohjelmat l\u00f6ytyv\u00e4t apt:sta, kuten python3, mutta sen tuoreimmat versiot tarjoillaan PPA:n kautta. Miten liittyv\u00e4t toisiinsa sanat: Python3, PPA ja Deadsnakes?</p> <p>Vinkki: tutustu my\u00f6s Ubuntu Desktop Guide: Add a Personal Package Archive (PPA)</p>"},{"location":"paketinhallinta/ohjelmat/","title":"Ohjelmat","text":"<p>Jotta voimme k\u00e4sitell\u00e4 ohjelmien tai sovellusten asentamista paketinhallintaj\u00e4rjestelm\u00e4n avulla, meid\u00e4n pit\u00e4\u00e4 ensin selvent\u00e4\u00e4, mit\u00e4 ohjelmalla tarkoitetaan.</p> <p>Alla oleva lista on tiivistelm\u00e4 Learning Modern Linux (Hausenblas 2022) -kirjan Chapterin 6 alusta.</p> Termi Selite Program, ohjelma Bin\u00e4\u00e4ritiedosto tai executableksi (<code>chmod +x</code>) merkattu tekstitiedosto. J\u00e4lkimm\u00e4inen alkaa ensimm\u00e4isell\u00e4 rivill\u00e4 olevalla shebangill\u00e4, joka m\u00e4\u00e4ritt\u00e4\u00e4, mill\u00e4 ohjelmalla teksti pit\u00e4\u00e4 tulkita konekieleksi. Esimerkki: <code>#!/bin/bash</code> tai <code>#!/usr/bin/env python3</code>. Process, prosessi Ohjelman instanssi, eli entiteetti, joka k\u00e4ytt\u00e4\u00e4 CPU:ta tai I/O:ta. Daemon Taustalla ajettava prosessi, jota kutsutaan my\u00f6s serviceksi. Windowsissa vastaavat l\u00f6ytyv\u00e4t Task Manager =&gt; Services. Linuxissa n\u00e4it\u00e4 ajaa useimmiten <code>systemd</code>. Katso <code>man daemon</code>. Application, sovellus tai app Ohjelma ja sen riippuvuudet (eng. dependencies) kokonaisuudessaan: sen konfiguraatiot, data, asennus, poisto, ajaminen. Package, ohjelmapaketti Tiedosto, joka sis\u00e4lt\u00e4\u00e4 ohjelmia tai applikaatioita. Applikaatiot jaellaan (eng. distribute) paketteina. Package manager, paketinhallinta Ohjelma, joka lukee ohjelmapaketteja, ja asentaa/p\u00e4ivitt\u00e4\u00e4/poistaa ohjelman ohjeiden mukaisesti. Esimerkkej\u00e4: Pythonissa <code>pip</code>, Debian-pohjaisissa j\u00e4rjestelmiss\u00e4 <code>apt</code>, Windowsissa <code>winget</code>. Repository Repositorio on kirjasto, josta paketinhallinta(j\u00e4rjestelm\u00e4) noutaa ohjelmat, ja johon ohjelmistonkehitt\u00e4j\u00e4t julkaisevat ohjelmat. <p>Lis\u00e4ksi ohjelmat k\u00e4ytt\u00e4v\u00e4t jaettuja kirjastoja. Yksi n\u00e4ist\u00e4 on <code>libc.so</code>, joka on (useimmiten GCC:n) Standard C Library, ja sis\u00e4lt\u00e4\u00e4 esimerkiksi <code>printf</code>-funktion. Paketinhallinta huolehtii sinun puolestasi n\u00e4iden kirjastojen asentamisesta, ja niiden riippuvuuksien hallinnasta. Alla olevalla komennoilla voit tarkistaa, mit\u00e4 kirjastoja jokin bin\u00e4\u00e4ri k\u00e4ytt\u00e4\u00e4:</p> Bash<pre><code>$ ldd $(which useradd)\n</code></pre>"},{"location":"peruskaytto/kayttajat/","title":"K\u00e4ytt\u00e4j\u00e4t","text":"<p>Warning</p> <p>Eth\u00e4n luo tai poista k\u00e4ytt\u00e4ji\u00e4 koulun ymp\u00e4rist\u00f6iss\u00e4, joissa on keskitetty k\u00e4ytt\u00e4j\u00e4nhallinta (LDAP, Kerberos, Ansible-skriptej\u00e4, ...). Tee uusiin k\u00e4ytt\u00e4jiin liittyv\u00e4t kokeilut (virtuaali)koneessa, joka on t\u00e4ysin sinun hallinnoima.</p>"},{"location":"peruskaytto/kayttajat/#linux-kayttajat","title":"Linux-k\u00e4ytt\u00e4j\u00e4t","text":""},{"location":"peruskaytto/kayttajat/#perusteet","title":"Perusteet","text":"<p>Useimmissa Linux-distribuutioissa k\u00e4ytt\u00e4jien ID:t (eng. user id, UID) noudattavat seuraavaa numerointia:</p> UID K\u00e4ytt\u00e4j\u00e4 0 root 1-999 J\u00e4rjestelm\u00e4n omia \"system usereita\". 1000-59999 Komennolla <code>adduser</code> luodut tavalliset k\u00e4ytt\u00e4j\u00e4t. 60000- Useita eri alueita ja poikkeustunnuksia. <p>Yll\u00e4 mainittuihin poikkeustunnuksiin voit tutustua esimerkiksi lukemalladebian policyn. K\u00e4ytt\u00e4j\u00e4t ja salasanat s\u00e4il\u00f6t\u00e4\u00e4n Linuxissa seuraaviin tiedostoihin:</p> K\u00e4ytt\u00f6 Oikeudet Tiedosto K\u00e4ytt\u00e4j\u00e4t 644 <code>/etc/passwd</code> Ryhm\u00e4t 644 <code>/etc/group</code> K\u00e4ytt\u00e4jien salasanat 640 <code>/etc/shadow</code> Ryhmien salasanat 640 <code>/etc/gshadow</code> <p>Mik\u00e4li haluat tarkistaa, onko sinun j\u00e4rjestelm\u00e4ss\u00e4si juuri sanat tiedostot samoine oikeuksineen, aja komento <code>stat -c '%a %n' /etc/passwd /etc/group /etc/shadow /etc/gshadow</code>.</p>"},{"location":"peruskaytto/kayttajat/#passwd","title":"Passwd","text":"<p>Toisin kuin nimest\u00e4 voisi p\u00e4\u00e4tell\u00e4, <code>passwd</code>-tiedosto ei sis\u00e4ll\u00e4 salasanoja laisinkaan. Salasanat ovat <code>passwd</code>-tiedostossa, johon pureudutaan my\u00f6hemmin. Alla n\u00e4kyy esimerkkin\u00e4 kolme rivi\u00e4 <code>passwd</code>-tiedostosta.</p> /etc/passwd<pre><code>root:x:0:0:root:/root:/bin/bash\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\nopettaja:x:1000:1000:Ope Opettaja,,,:/home/opettaja:/bin/bash\n</code></pre> <p>Riveiss\u00e4 toimii kenttien erottimena <code>:</code>-merkki. Esimerkiksi <code>opettaja</code>-nimisen k\u00e4ytt\u00e4j\u00e4n rivin purkaa useaksi riviksi n\u00e4in:</p> Bash<pre><code>cat /etc/passwd | grep opettaja | tr : \"\\n\"\n</code></pre> <p>Alla tulostuvat rivit selitettyin\u00e4:</p> # Kentt\u00e4 Selite 1 username Uniikki tekstimuotoinen tunniste k\u00e4ytt\u00e4j\u00e4lle. T\u00e4ll\u00e4 k\u00e4ytt\u00e4j\u00e4 kirjautuu sis\u00e4\u00e4n. Prim\u00e4\u00e4riavain. 2 password K\u00e4ytt\u00e4j\u00e4n salasana tai <code>x</code>-kirjain indikoimassa, ett\u00e4 salasana l\u00f6ytyy <code>shadow</code>-tiedostosta. 3 user id, UID Ei-uniikki numeraalinen tunniste k\u00e4ytt\u00e4j\u00e4lle tai k\u00e4ytt\u00e4jille. Yleens\u00e4 jokaisella k\u00e4ytt\u00e4j\u00e4ll\u00e4 on kuitenkin oma ID. 4 group id, GID Ei-uniikki numeraalinen tunniste k\u00e4ytt\u00e4j\u00e4n ensisijaiselle groupille. Monta k\u00e4ytt\u00e4j\u00e4\u00e4 voi kuulua yhteen grouppiin. 5 contact, GECOS Pilkulla erotettu lista arvoista: Full Name, Room number, Work phone, Home phone, Other. Komento <code>finger &lt;username&gt;</code> palauttaa t\u00e4m\u00e4n tiedon. 6 home K\u00e4ytt\u00e4j\u00e4n kotikansio. Mik\u00e4li k\u00e4ytt\u00e4j\u00e4ll\u00e4 ei ole kotikansiota, <code>/nonexistent</code> on arvona. 7 shell Shell (tai muu ohjelma) joka ajetaan aina kun k\u00e4ytt\u00e4j\u00e4n\u00e4 kirjaudutaan sis\u00e4\u00e4n. Mik\u00e4li k\u00e4ytt\u00e4j\u00e4 on t\u00e4ysin ei-interaktiivinen k\u00e4ytt\u00e4j\u00e4, jolla ei koskaan kuulu kirjautua sis\u00e4\u00e4n, arvona on <code>/usr/sbin/nologin</code>. <p>Tip</p> <p>Voit katsella tai jopa muokata passwd tiedoston sis\u00e4lt\u00f6\u00e4 komennolla <code>vipw</code>. Ulos editorista p\u00e4\u00e4set painamalla ESC, mink\u00e4 j\u00e4lkeen <code>:q!</code> ja enteri\u00e4. Kyseess\u00e4 on siis VIM-editori.</p>"},{"location":"peruskaytto/kayttajat/#group","title":"Group","text":"<p>Tiedostosta <code>/etc/group</code> l\u00f6ytyv\u00e4t aiemmin mainitut k\u00e4ytt\u00e4jien <code>root</code>,  <code>nobody</code> ja <code>opettaja</code> prim\u00e4\u00e4riryhm\u00e4t. Taulukot joinataan yhteen GID:n eli group id:n avulla.</p> /etc/group<pre><code>root:x:0:\nnogroup:x:65534:\nopettaja:x:1000:\n</code></pre> <p>T\u00e4m\u00e4n lis\u00e4ksi tiedostosta l\u00f6ytyy muutkin ryhm\u00e4t; yksi k\u00e4ytt\u00e4j\u00e4 voi kuulua moneen ryhm\u00e4\u00e4n. K\u00e4ytt\u00e4j\u00e4hallinta (eng. access control) on yleisesti j\u00e4rjestelmiss\u00e4 kannattavaa tehd\u00e4 siten, ett\u00e4 luo ryhm\u00e4n, johon kiinnitt\u00e4\u00e4 policyn ja/tai permissionit, joka sallii tekem\u00e4\u00e4n asioita x, y ja z. K\u00e4ytt\u00e4jille ei anneta suoraan lupia mihink\u00e4\u00e4n, vaan k\u00e4ytt\u00e4j\u00e4 kiinnitet\u00e4\u00e4n ryhm\u00e4\u00e4n. Alla esimerkkin\u00e4 nelj\u00e4 rivi\u00e4 tiedostosta, jotka sis\u00e4lt\u00e4v\u00e4t sanan \"opettaja\":</p> /etc/group<pre><code>adm:x:4:syslog,opettaja\ncdrom:x:24:opettaja\nsudo:x:27:opettaja\nopettaja:x:1000:\n</code></pre> <p>Alla rivien <code>:</code>-merkill\u00e4 erotellut tiedot selitettyin\u00e4:</p> # Kentt\u00e4 Selite 1 group name Ryhm\u00e4n nimi, joka n\u00e4kyy muun muassa <code>ls -la</code> komennon tulosteessa. 2 group password Ryhm\u00e4n salasana. Kuten k\u00e4ytt\u00e4jien kohdalla, my\u00f6s t\u00e4\u00e4ll\u00e4 <code>x</code> tarkoittaa, ett\u00e4 salasana l\u00f6ytyy muualta (ks. <code>/etc/gshadow</code>). 3 group id Ryhm\u00e4n uniikki tunniste. 4 users Pilkulla erotettu lista k\u00e4ytt\u00e4j\u00e4nimist\u00e4, jotka kuuluvat ryhm\u00e4\u00e4n. <p>Muistele aiempaa lukua k\u00e4ytt\u00f6oikeuksista. Jokaisella tiedostolla ja kansiolla on kolme permissionia: owner, group ja others. Jos <code>opettaja</code> kuuluu ryhmiin <code>cdrom</code> ja <code>adm</code>, niin mit\u00e4 n\u00e4ill\u00e4 voi tehd\u00e4? Tietenkin se, mit\u00e4 permissionit sallivat. Sopivilla group-omistuksilla olevia tiedostoja voi etsi\u00e4 seuraavanlaisilla komennoilla:</p> Bash<pre><code>$ find /dev -group cdrom\n/dev/sg0\n/dev/sr0\n\n$ find /var/log -group adm\n/var/log/dmesg\n/var/log/dmesg.0\n/var/log/syslog.1\nfind: \u2018/var/log/private\u2019: Permission denied\n/var/log/apt/term.log\n...\n</code></pre> <p>Tip</p> <p>Voit katsella tai jopa muokata passwd tiedoston sis\u00e4lt\u00f6\u00e4 komennolla <code>vigr</code>.</p>"},{"location":"peruskaytto/kayttajat/#shadow","title":"Shadow","text":"<p>Tiedostosta <code>/etc/shadow</code> l\u00f6ytyv\u00e4t aiemmin mainittujen k\u00e4ytt\u00e4jien salasanat. Ote tiedoston sis\u00e4ll\u00f6st\u00e4 alla:</p> /etc/shadow<pre><code>root:!:19598:0:99999:7:::\nnobody:*:19576:0:99999:7:::\nopettaja:$y$hidden:19598:0:99999:7:::\n</code></pre> <p>Yksitt\u00e4isen rivin voi rikkoa osatekij\u00f6iksi tutulla komennolla, mutta t\u00e4ll\u00e4 kertaa tarvitse root-oikeudet, tai sinun tulee kuulua ryhm\u00e4\u00e4n shadow: <code>\u00b4sudo cat /etc/shadow| grep opettaja | tr : \"\\n\"</code>.</p> # Kentt\u00e4 Selite 1 username K\u00e4ytt\u00e4j\u00e4nimi kuten <code>opettaja</code>. (ks. <code>/etc/passwd</code>) 2 password Merkki <code>*</code> tai <code>!</code> tarkoittavat, ett\u00e4 k\u00e4ytt\u00e4j\u00e4n\u00e4 ei voi kirjautua sis\u00e4\u00e4n salasanaa k\u00e4ytt\u00e4en, mutta esimerkiksi root-oikeuksin tai ssh-avainta k\u00e4ytt\u00e4en kirjautuminen voi yh\u00e4 olla mahdollista. <code>*NP*</code> ja <code>!!</code> viittaavat siihen, ett\u00e4 salasanaa ei ole (viel\u00e4) asetettu. <code>*LK*</code> tarkoittaa, ett\u00e4 k\u00e4ytt\u00e4j\u00e4 on lukittu. Mik\u00e4li kentt\u00e4 sis\u00e4lt\u00e4\u00e4 jotain muuta, niin kyseess\u00e4 on k\u00e4ytt\u00e4j\u00e4n h\u00e4sh\u00e4tty salasana. Lue alta Salasanakent\u00e4n sis\u00e4lt\u00f6. 3 last password change P\u00e4iv\u00e4, jolloin salasana on edellisen kerran vaihdettu. Kyseess\u00e4 ei ole p\u00e4iv\u00e4m\u00e4\u00e4r\u00e4 vaan p\u00e4iv\u00e4n lukuj\u00e4rjestys alkaen 1970-luvun alusta eli UNIX timestampin alkuhetkest\u00e4 alkaen. Lue alta P\u00e4iv\u00e4m\u00e4\u00e4r\u00e4n laskeminen. 4 min days Minimi-intervalli salasanavaihtojen v\u00e4lill\u00e4. Katso <code>man chage</code>. 5 max days Maksimi-intervalli salasanavaihtojen v\u00e4lill\u00e4. Katso <code>man chage</code>. 6 warn days Varoituksen n\u00e4ytt\u00e4misen aloitus ennen salasanan vanhentumista. 7 inactive days K\u00e4ytt\u00e4j\u00e4n deaktivoinnin p\u00e4iv\u00e4luku salasanan vanhentumisen j\u00e4lkeen. 8 expiry P\u00e4iv\u00e4, jolloin k\u00e4ytt\u00e4j\u00e4 on deaktivoitu. K\u00e4ytt\u00e4\u00e4 samaa p\u00e4iv\u00e4m\u00e4\u00e4r\u00e4kaavaa kuin kentt\u00e4 <code>#3</code>."},{"location":"peruskaytto/kayttajat/#paivamaaran-laskeminen","title":"P\u00e4iv\u00e4m\u00e4\u00e4r\u00e4n laskeminen","text":"<p>Last password change kent\u00e4n arvon voi k\u00e4\u00e4nt\u00e4\u00e4 meille ihmiselle tutummaksi arvoksi <code>date</code>-komennon avulla.</p> Bash<pre><code>$ date -d \"1970-01-01 +19598 days\" +%Y-%m-%d\n2023-08-29\n</code></pre>"},{"location":"peruskaytto/kayttajat/#salasanakentan-sisalto","title":"Salasanakent\u00e4n sis\u00e4lt\u00f6","text":"<p>Salasanakent\u00e4n arvon erottajana toimii <code>$</code>-merkki, ja se noudattaa kaavaa <code>$id$salt$hash</code>, tai jos h\u00e4sh\u00e4ykseen on k\u00e4ytetty custom-parametrej\u00e4, niin <code>$id$param=value,paramb=value$salt$hash</code>. Kentt\u00e4 ID viittaa h\u00e4sh\u00e4ykseen k\u00e4ytettyyn algoritmiin ja arvojen merkitys on:</p> $ID$ H\u00e4sh\u00e4ykseen k\u00e4ytetty algoritmi 1 MD5 2, 2a tai 2b bcrypt 5 SHA-256 6 SHA-512 y yescrypt <p>Salasanan h\u00e4sh\u00e4yst\u00e4 voi harjoitella <code>openssl</code>-kirjaston avulla.</p> Bash<pre><code>$ openssl passwd -5 -salt \"suola\" \"password123\"\n$5$suola$NkZwDPPEx8Q9XA2./QA2oJ4QA35JCL9ejielN9DOApD\n</code></pre> <p>H\u00e4sh\u00e4yksess\u00e4 (eli virallisesti suomeksi \"tiivist\u00e4misess\u00e4\") k\u00e4ytetty salt eli suola on arvo, joka ynn\u00e4t\u00e4\u00e4n salasanaan ennen sen h\u00e4sh\u00e4yst\u00e4. T\u00e4ll\u00e4 estet\u00e4\u00e4n suoraa rainbow table k\u00e4ytt\u00f6\u00e4: jos k\u00e4ytt\u00e4j\u00e4n salasana olisi jotain turvatonta kuten <code>qwerty</code> tai <code>password123</code>,  salasanan h\u00e4sh\u00e4tty arvo l\u00f6ytyisi suoraan jotakin tietokannasta, joka sis\u00e4lt\u00e4\u00e4 yleisimm\u00e4n miljoonan salasanan h\u00e4shit. Kun salt on k\u00e4yt\u00f6ss\u00e4, niin k\u00e4ytt\u00e4jan salasana on k\u00e4yt\u00e4nn\u00f6ss\u00e4 \"salt\"+\"password123\". Naiivi esimerkki alla, jossa k\u00e4ytet\u00e4\u00e4n turvattomaksi luokiteltua MD5-algoritmia. Eth\u00e4n k\u00e4yt\u00e4 MD5:tt\u00e4 miss\u00e4\u00e4n tuotannossa! T\u00e4ss\u00e4 se on esimerkkin\u00e4, koska syntyv\u00e4 h\u00e4sh on mukavan lyhyt ruudulle tulostettavaksi.</p> Bash<pre><code>$ salt=salt\n$ password=password123\n$ hashed=$(echo \"$salt$password\" | md5sum | base64)\n$ echo \"\\$5\\$$salt\\$$hashed\"\n$5$salt$ZjhiY2I2NmVmOWMwMTRlYjRiMDBjZmY4N2U0YThhNjUgIC0K\n</code></pre> <p>H\u00e4sh\u00e4\u00e4m\u00e4t\u00f6nt\u00e4 salasanaa ei siis tallenneta laisinkaan. Kun k\u00e4ytt\u00e4j\u00e4 yritt\u00e4\u00e4 kirjautua sis\u00e4\u00e4n, j\u00e4rjestelm\u00e4 h\u00e4sh\u00e4\u00e4 k\u00e4ytt\u00e4j\u00e4n sy\u00f6tteen saltin kanssa, vertaa sit\u00e4 <code>shadow</code>-tiedoston arvoon, ja joko p\u00e4\u00e4st\u00e4\u00e4 k\u00e4ytt\u00e4j\u00e4n sis\u00e4\u00e4n tai ei p\u00e4\u00e4st\u00e4. Mik\u00e4li <code>shadow</code>-tiedosto vuotaa v\u00e4\u00e4riin k\u00e4siin, ja joku ulkopuolinen yritt\u00e4\u00e4 p\u00e4\u00e4tell\u00e4 mit\u00e4 h\u00e4sh\u00e4\u00e4m\u00e4tt\u00f6m\u00e4t salasanat ovat, h\u00e4nell\u00e4 ei ole k\u00e4yt\u00e4nn\u00f6ss\u00e4 muuta vaihtoehtoa kuin kokeilla kaikki vaihtoehdot l\u00e4pi.</p> <p>Note</p> <p>T\u00e4ss\u00e4p\u00e4 p\u00e4hkin\u00e4. Kuvittele tilanne, jossa salasana-policy m\u00e4\u00e4r\u00e4\u00e4, ett\u00e4 salasanan pit\u00e4\u00e4 noudattaa kaavaa <code>^[a-zA-Z0-9]{8,32}$</code> (eli 8-32 symbolia, jotka ovat isoja tai pieni\u00e4 kirjaimia tai numeroita; erikoismerkkej\u00e4 tai suomalaisia \u00e4\u00e4kk\u00f6si\u00e4 ei sallita). Kuinka monta eri vaihtoehtoa pit\u00e4isi enimmill\u00e4\u00e4n k\u00e4yd\u00e4 l\u00e4pi l\u00f6yt\u00e4\u00e4kseen h\u00e4shi, jos oikea salasana on 8 merkki\u00e4 pitk\u00e4? Ent\u00e4 jos salasana onkin 10 merkki\u00e4 pitk\u00e4?</p>"},{"location":"peruskaytto/kayttajat/#kaytannossa","title":"K\u00e4yt\u00e4nn\u00f6ss\u00e4","text":""},{"location":"peruskaytto/kayttajat/#kayttajien-luominen","title":"K\u00e4ytt\u00e4jien luominen","text":"<p>Lokaaleja k\u00e4ytt\u00e4ji\u00e4 voi luoda komennolla:</p> Bash<pre><code># Luo k\u00e4ytt\u00e4j\u00e4\n$ sudo useradd &lt;-m&gt; &lt;username&gt;\n\n# Luo tarpeen mukaan uusi ryhm\u00e4\n$ sudo groupadd &lt;groupname&gt;\n\n# Jos loit ryhm\u00e4n, lis\u00e4\u00e4 k\u00e4ytt\u00e4j\u00e4 ryhm\u00e4\u00e4n\n$ sudo usermod --append --groups &lt;groupname&gt; &lt;username&gt;\n</code></pre> <p>Tip</p> <p>Uuden k\u00e4ytt\u00e4j\u00e4n luomiseen liittyy default-asetuksia. K\u00e4y katsomassa, mit\u00e4 tiedosto <code>/etc/login.defs</code> sis\u00e4lt\u00e4\u00e4. Mit\u00e4 manuaali sanoo tiedostosta?</p> <p>Uuden k\u00e4ytt\u00e4j\u00e4n kotihakemistolle voi luoda jonkin pohjarakenteen. K\u00e4y katsomassa, mit\u00e4 kansio <code>/etc/skel</code> sis\u00e4lt\u00e4\u00e4. Mit\u00e4 manuaali sanoo siit\u00e4 (ks. USERADD(8) )?</p> <p>Tiedostojen omistajuutta voi vaihtaa komennolla <code>chown</code>. Alla lyhyt esimerkki.</p> Bash<pre><code># Vaihda owner\n$ chown &lt;username&gt; kissa.txt\n\n# Vaihda sek\u00e4 owner ett\u00e4 group\n$ chown &lt;username&gt;:&lt;group&gt; kissa.tx\n</code></pre>"},{"location":"peruskaytto/kayttajat/#toisena-kayttajana-esiintyminen","title":"Toisena k\u00e4ytt\u00e4j\u00e4n\u00e4 esiintyminen","text":"<p>Jos haluat kokeilla, kuinka tiedosto- sek\u00e4 hakemisto-oikeudet k\u00e4ytt\u00e4ytyv\u00e4t toisen k\u00e4ytt\u00e4j\u00e4n n\u00e4k\u00f6kulmasta, niin vaikea tapa on kirjautua graafisesta k\u00e4ytt\u00f6liittym\u00e4st\u00e4 ulos, ja t\u00e4m\u00e4n j\u00e4lkeen kirjautua uudella k\u00e4ytt\u00e4j\u00e4ll\u00e4 sis\u00e4\u00e4n. Helpompi tapa on k\u00e4ytt\u00e4\u00e4 <code>su</code>-komentoa (substitute user).</p> Bash<pre><code># Avaa toisen k\u00e4ytt\u00e4j\u00e4n shell sinun shellisi prosessina\n# Selvit\u00e4, mit\u00e4 \"-\" eli \"--login\" optio tekee.\n$ sudo su - &lt;username&gt;\n</code></pre> <p>Tip</p> <p>Jos haluat esiinty\u00e4 roottina, voit saavuttaa t\u00e4m\u00e4n usealla eri tavalla. Kaksi kenties nopeinta ovat:</p> Bash<pre><code># Sudo\n$ sudo -i     # eli --login\n\n# Sudo su\n$ sudo su -\n</code></pre>"},{"location":"peruskaytto/kayttajat/#tehtavat","title":"Teht\u00e4v\u00e4t","text":"<p>Teht\u00e4v\u00e4: Nologin</p> <p>Kokeile ajaa ohjelma, joka ajetaan ei-interaktiivisilla k\u00e4ytt\u00e4jill\u00e4 loginin yhteydess\u00e4 eli <code>/usr/sbin/nologin</code>. Mit\u00e4 n\u00e4et?</p> <p>Teht\u00e4v\u00e4: Kenen joukoissa seisot?</p> <p>Katso mihin ryhmiin kuulut ja selvit\u00e4, mit\u00e4 oikeuksia sinulla on niiden puolesta. Muista, ett\u00e4 sudo antaa p\u00e4\u00e4syn k\u00e4yt\u00e4nn\u00f6ss\u00e4 kaikkialle.</p> <p>Teht\u00e4v\u00e4: Luo k\u00e4ytt\u00e4j\u00e4</p> <p>Luo k\u00e4ytt\u00e4j\u00e4, jonka nimi on muunnelma omastasi: esimerkiksi opettaja sourander voisi luoda k\u00e4ytt\u00e4j\u00e4n surrender. Voit k\u00e4ytt\u00e4\u00e4 joko <code>useradd</code> tai <code>adduser</code>-komentoa. Tutki, mit\u00e4 eroa n\u00e4ill\u00e4 komennoilla on ja p\u00e4\u00e4t\u00e4 kumpaa k\u00e4yt\u00e4t. K\u00e4ytt\u00e4j\u00e4n luomisen j\u00e4lkeen:</p> <ol> <li>Esiinny toisena k\u00e4ytt\u00e4j\u00e4n\u00e4 (<code>su</code>-komennolla).</li> <li>Selvit\u00e4, mit\u00e4 tapahtuu, jos yrit\u00e4t k\u00e4ytt\u00e4\u00e4 <code>sudo</code>-komentoa.</li> <li>Antamatta k\u00e4ytt\u00e4j\u00e4lle sudoers-oikeuksia, miten voit sallia lukea ja kirjoittaa tietoa <code>/srv/antipersoonat</code> -hakemistossa? Luo hakemisto ja selvit\u00e4.</li> </ol> <p>Teht\u00e4v\u00e4: K\u00e4ytt\u00e4j\u00e4 ja kirjautuminen</p> <p>Aseta \u00e4sken luomallesi k\u00e4ytt\u00e4j\u00e4lle salasana, jos sill\u00e4 ei viel\u00e4 ole. Jos olet ep\u00e4varma, tutki <code>/etc/shadow</code>-tiedostoa.</p> <p>Kun k\u00e4ytt\u00e4j\u00e4ll\u00e4 on salasana, kirjaudu ulos p\u00e4\u00e4k\u00e4ytt\u00e4j\u00e4st\u00e4si ja kirjaudu GNOME:en t\u00e4ll\u00e4 ei-admin k\u00e4ytt\u00e4j\u00e4ll\u00e4.</p> <p>Teht\u00e4v\u00e4: Poista k\u00e4ytt\u00e4j\u00e4</p> <p>Selvit\u00e4, kuinka k\u00e4ytt\u00e4j\u00e4n voi poistaa kotihakemistoineen. Poista t\u00e4m\u00e4n j\u00e4lkeen my\u00f6s tyhjiksi j\u00e4\u00e4neet ryhm\u00e4t.</p> <p>Teht\u00e4v\u00e4: Pidenn\u00e4 sudo-salasanan kyselytiheytt\u00e4</p> <p>Olet varmasti huomannut, ett\u00e4 sudo kysyy salasanaa:</p> <ol> <li>Joka kerta kun k\u00e4yt\u00e4t <code>sudo</code>-komentoa uudessa istunnossa.</li> <li>Aina <code>sudo</code>-komennon j\u00e4lkeen, kun olet edellisest\u00e4 promptista on kulunut 15 minuuttia.</li> </ol> <p>Eik\u00f6 olisi n\u00e4pp\u00e4r\u00e4\u00e4, jos salasana kysytt\u00e4isiin vaikkapa vain kerran tunnissa - olit miss\u00e4 tahansa shell-istunnossa? Kokeile muokata t\u00e4t\u00e4. Se hoituu <code>visudo</code>-komennolla, joka avaa <code>/etc/sudoers</code>-tiedoston. Visudo on editori, joka on erikoistettu sudoers-tiedoston muokkaamiseen. Se pyrkii est\u00e4m\u00e4\u00e4n virheellisten asetusten tallentamisen. Ole kuitenkin tarkkana: t\u00e4m\u00e4n tiedoston rikkominen voi est\u00e4\u00e4 sinua kirjautumasta sis\u00e4\u00e4n j\u00e4rjestelm\u00e4\u00e4n. </p> <p>Lis\u00e4\u00e4 konfiguraatioon rivi, joka sallii sinulle 60 minuutin cachetuksen salasanalle. Voit k\u00e4ytt\u00e4\u00e4 joko <code>/etc/sudoers</code>-tiedostoa tai luoda oman drop-in tiedoston <code>/etc/sudoers.d/my-sudoers</code>. Drop-in tiedosto on erillinen tiedosto, joka ladataan sudoers-tiedoston lis\u00e4ksi. T\u00e4m\u00e4 on suositeltava tapa.</p> Bash<pre><code>$ sudo sudo -V | grep -i \"timestamp timeout\"\nAuthentication timestamp timeout: 15,0 minutes\n\n$ sudo visudo /etc/sudoers.d/my-sudoers\n</code></pre> my-sudoers<pre><code>Defaults    timestamp_timeout=60,timestamp_type=global\n</code></pre> <p>Yll\u00e4 olevien vakioarvot ovat 15 minuuttia ja <code>timestamp_type=tty</code>, joka tarkoittaa, ett\u00e4 salasana kysyt\u00e4\u00e4n aina kun avaat uuden terminaali-ikkunan tai -v\u00e4lilehden.</p> <p>Ja mihink\u00f6 se cachettaa n\u00e4m\u00e4? Linuxissa l\u00e4hes kaikki on tiedostoina, kuten my\u00f6s t\u00e4m\u00e4. Voit tutkia <code>/run/sudo/ts</code>-hakemistoa. Sielt\u00e4 pit\u00e4isi l\u00f6yty\u00e4 sinun userid:n mukainen tiedosto, jota on muokattu viimeksi kun ajoit sudo-komennon. Lis\u00e4tietoja l\u00f6yd\u00e4t komennolla <code>man 5 sudoers</code>.</p> <p>Tip</p> <p>Voit halutessasi lis\u00e4t\u00e4 my\u00f6s toisen arvon, kuten <code>timestamp_type=global</code>, joka sallii salasanan kysymisen vain kerran <code>timeout</code>-viiveen v\u00e4lein riippumatta siit\u00e4, miss\u00e4 istunnossa olet. Voit lis\u00e4t\u00e4 sen my\u00f6s drop-in tiedostoon joko uudelle riville tai samaan riviin pilkulla erotettuna. Sen arvoa voit tutkia n\u00e4in:</p> Bash<pre><code>$ sudo sudo -V | grep -i \"type\"\nType of authentication timestamp record: tty\n</code></pre>"},{"location":"peruskaytto/kayttooikeudet/","title":"K\u00e4ytt\u00f6oikeudet","text":"<p>Linuxissa tiedostoilla ja hakemistoilla on kullakin omat k\u00e4ytt\u00f6oikeudet. Kaikilla Linuxin tiedostoilla on kolmeosainen access control, joka m\u00e4\u00e4r\u00e4\u00e4 p\u00e4\u00e4syn kolmella dimensiolla: omistaja (esim. k\u00e4ytt\u00e4j\u00e4 <code>opettaja</code>), ryhm\u00e4 (esim. <code>sales</code> tai useammin sama kuin k\u00e4ytt\u00e4j\u00e4 eli <code>opettaja</code>), sek\u00e4 kaikki loput j\u00e4rjestelm\u00e4\u00e4n kirjautuneet k\u00e4ytt\u00e4j\u00e4t eli others.</p> <p>Jokaiselle n\u00e4ist\u00e4 kolmesta, eli <code>(owner)(group)(others)</code>, m\u00e4\u00e4r\u00e4ytyy p\u00e4\u00e4synhallinta kolmen bitin avulla. N\u00e4iden tarkat verbit riippuvat siit\u00e4, onko kyseess\u00e4 tiedosto vai hakemisto. Mik\u00e4li kyseess\u00e4 on tiedosto, niin verbit ovat vasemmalta lukien j\u00e4rjestyksess\u00e4 read,  write ja execute.  Esimerkiksi ownerin p\u00e4\u00e4sy voi olla jotain v\u00e4lill\u00e4 <code>000</code>...<code>111</code>. Kurkataan v\u00e4liss\u00e4, milt\u00e4 t\u00e4m\u00e4 n\u00e4ytt\u00e4\u00e4 GNOME:n tiedostoselaimessa eli Nautiluksessa (ks. Kuvio 1).</p> <p></p> <p>Kuvio 1: GNOME 3:n vakio tiedostoselaimessa (GNOME Nautilus 42.6) voi asettaa hakemiston ja sen sis\u00e4lt\u00e4mien tiedostojen sek\u00e4 hakemistojen k\u00e4ytt\u00f6oikeudet rekursiivisesti.</p>"},{"location":"peruskaytto/kayttooikeudet/#samat-numeroina","title":"Samat numeroina","text":"<p>K\u00e4\u00e4nnet\u00e4\u00e4n kuvassa n\u00e4kyv\u00e4 tiedostojen p\u00e4\u00e4syhallinta luvuiksi. Katso alla oleva taulukko.</p> Selite Bin\u00e4\u00e4ri Desimaali Owner can... Read and write 110 6 Group can... Read and write 110 6 Others can... Read 100 4 <p>Huomaa, ett\u00e4 selitteen verbit vaihtuvat sen mukaan, onko kyseess\u00e4 tiedosto vai hakemisto. Verbit ovat selitettyn\u00e4 alla taulukossa. Linuxissa ohjelmat tunnistetaan siit\u00e4, ett\u00e4 jokin kolmesta permissionista on muotoa <code>xx1</code>, kun taas Windowsissa suoritettavat ohjelmat tunnistetaan yleisesti tiedostop\u00e4\u00e4tteest\u00e4 (<code>.exe</code>).</p> Tiedosto kohdalla entiteetti... Hakemiston kohdalla.... 100 Saa lukea sis\u00e4ll\u00f6n Saa listata mit\u00e4 tiedostoja ja alihakemistoja se sis\u00e4lt\u00e4\u00e4. 010 Saa kirjoittaa tiedostoon tai poistaa tiedoston. Saa lis\u00e4t\u00e4 ja poistaa tiedostoja sek\u00e4 alihakemistoja. 001 Saa suorittaa tiedoston. Tiedosto on nyt <code>executable</code> eli ohjelma. Saa suorittaa ohjelmia hakemiston sis\u00e4ll\u00e4, listata tiedostojen metadataa, vaihtaa <code>pwd</code>:n kyseiseksi kansioksi. <p>K\u00e4ymme Linuxin komennot my\u00f6hemmin l\u00e4pi, mutta voit alustavasti jo mietti\u00e4, mit\u00e4 alla n\u00e4kyv\u00e4t komennot tekev\u00e4t. Komentojen v\u00e4liss\u00e4 oleva <code>&amp;&amp;</code> on looginen AND-operaattori, mik\u00e4 aiheuttaa sen, ett\u00e4 j\u00e4lkimm\u00e4inen komento ajetaan vain jos ensimm\u00e4inen ei nostanut varoituksia. Muutoin komennot tekev\u00e4t hyvinkin sen, milt\u00e4 ne englanniksi kuulostavat.</p> Bash<pre><code>$ echo \"This is my file\" &gt; myfile   # Merkkijono ammutaan uuteen tiedostoon\n$ ls -la myfile\n-rw-rw-r-- 1 opettaja opettaja 16 elo    30 13:09 myfile\n\n$ cat myfile    # Tulostetaan tiedoston sis\u00e4lt\u00f6\nThis is my file\n\n$ chmod 777 myfile &amp;&amp; ls -la myfile\n-rwxrwxrwx 1 opettaja opettaja 16 elo    30 13:09 myfile\n\n$ chmod -x myfile &amp;&amp; ls -la myfile\n-rw-rw-rw- 1 opettaja opettaja 16 elo    30 13:09 myfile\n\n$ chmod +r myfile &amp;&amp; ls -la myfile\n-rw-rw-rw- 1 opettaja opettaja 16 elo    30 13:09 myfile\n\n$ chmod 000 myfile &amp;&amp; ls -la myfile\n---------- 1 opettaja opettaja 16 elo    30 13:09 myfile\n\n$ cat myfile    # Tulostetaan tiedoston sis\u00e4lt\u00f6\ncat: myfile: Permission denied\n\n$ chmod u+rw &amp;&amp; ls -la myfile\n-rw------- 1 opettaja opettaja 16 elo    30 13:09 myfile\n\n$ chmod g+r,o+r myfile &amp;&amp; ls -la myfile\n-rw-r--r-- 1 opettaja opettaja 16 elo    30 13:09 myfile\n</code></pre>"},{"location":"peruskaytto/kayttooikeudet/#entapa-hakemistot","title":"Ent\u00e4p\u00e4 hakemistot?","text":"<p>Hakemiston erottaa tiedostosta Linuxissa siten, ett\u00e4 <code>ls -la</code> komennon output alkaa d-kirjaimella, kuten <code>drwx------</code>. Hakemistolle annettu hassu oikeus saattaa my\u00f6hemmin aiheuttaa p\u00e4\u00e4nvaivaa, kun pohdit mikset saa muokata jotain aiemmin luotua tiedostoa.</p> Bash<pre><code>$ mkdir my                             # Luo kansio\n$ touch my/tralalaa my/dingdingdong    # ja sinne kaksi tiedostoa\n$ mkdir my/inner                       # Luo my\u00f6s alikansio\n$ touch my/inner/peace                 # ja sinnekin tiedosto\n$ tree my                              # N\u00e4yt\u00e4 hakemistopuu\nmy\n\u251c\u2500\u2500 dingdingdong\n\u251c\u2500\u2500 inner\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 peace\n\u2514\u2500\u2500 tralalaa\n\n$ chmod 666 my                         # Anna muut paitsi execute kaikille\n$ touch my/dingdingdong\ntouch: cannot touch 'my/dingdingdong': Permission denied\n\n$ cat my/inner/peace\ncat: my/inner/piece: Permission denied\n\n$ ls -la | grep my                     # Kansion itsens\u00e4 voi listata, sis\u00e4lt\u00f6\u00e4 ei.\ndrw-rw-rw-  2 opettaja opettaja 4096 elo    30 15:51 my\n\n$ rm -rf my/                           # Yrit\u00e4 poistaa\nrm: cannot remove 'my/dingdingdong': Permission denied\nrm: cannot remove 'my/tralalaa': Permission denied\n\n$ chmod u+x my                         # Anna execute ownerille\n$ rm -rf my                            # Nyt kansion ja tiedostot voi poistaa\n</code></pre>"},{"location":"peruskaytto/kayttooikeudet/#tehtavat","title":"Teht\u00e4v\u00e4t","text":"<p>Teht\u00e4v\u00e4: K\u00e4ytt\u00f6oikeudet</p> <p></p> <p>Kuvio 1. Tavoiteltu lopputulos n\u00e4kyy kuvassa.</p> <p>Kuvassa n\u00e4kyy n\u00e4kyy <code>tree -ap tehtava1</code> komennon output. Komento on ajettu hakemistossa <code>~/harjoitukset/kayttooikeudet</code>. Luo vastaava hakemisto teht\u00e4v\u00e4\u00e4 varten, mutta noudattaen sinun omaa hakemistostandardia, jonka olet p\u00e4\u00e4tt\u00e4nyt aiemmin t\u00e4ll\u00e4 kurssilla. </p> <p>Tarkista komennolla <code>tree -ap &lt;hakemistonnimit\u00e4h\u00e4n&gt;</code>, ett\u00e4 hakemistorakenne on samankaltainen. Vertaile erityisesti tiedostojen ja hakemistojen k\u00e4ytt\u00f6oikeuksia (eli merkkijonoa kuten <code>-rw-rw-r--</code> tai <code>drwx---r-x</code>).</p> <p>Jos haluat lis\u00e4haastetta, pyri tekem\u00e4\u00e4n t\u00e4m\u00e4 mahdollisimman pienell\u00e4 m\u00e4\u00e4r\u00e4ll\u00e4 komentoja. Kuinka esimerkiksi luot tiedostot <code>file_01 - file_10</code> yhdell\u00e4 komennolla? Avaimet vastaukseen l\u00f6ytyy Komennot -sivulta.</p> <p>Tip</p> <p>Jos sinulla ei ole <code>tree</code> ohjelma asennettu, aja komennot:</p> <pre><code>sudo apt update\nsudo apt install tree\n</code></pre> <p>Teht\u00e4v\u00e4: Tarkista k\u00e4ytt\u00f6oikeudet skriptill\u00e4</p> <p>Lataa tiedosto yht\u00e4 hakemistoa ylemm\u00e4s hakemistopolussa kuin mihin loit \u00e4skeiset tiedostot. Polku skriptiin on: <code>https://raw.githubusercontent.com/sourander/linux-perusteet/refs/heads/main/kurssitiedostot/tarkista_kayttooikeudet.sh</code></p> <ol> <li>Lataa skripti</li> <li>Tee siit\u00e4 ajettava</li> <li>Suorita se</li> <li>Tarkastele tulosta. Pit\u00e4isi olla 21/21 oikein.</li> </ol> <p>K\u00e4yt\u00e4 lataukseen joko <code>wget</code> tai <code>curl</code> ohjelmaa. Ainakin toisen n\u00e4ist\u00e4 pit\u00e4isi olla sinulle jo t\u00e4lt\u00e4 kurssilta tuttu!</p> <p>Vihje suorittamiseen: <code>./tarkista_kayttooikeudet.sh harjoitus1</code></p>"},{"location":"peruskaytto/komennot/","title":"Komennot","text":""},{"location":"peruskaytto/komennot/#komentojen-perusteet","title":"Komentojen perusteet","text":""},{"location":"peruskaytto/komennot/#flagit-ja-argumentit","title":"Fl\u00e4git ja argumentit","text":"<p>GNU Bashin shell-syntaksissa v\u00e4lily\u00f6nti, tab, newline ja muut metamerkit (<code>|</code>, <code>&amp;</code>, <code>;</code>, <code>(</code>,<code>)</code>, <code>&lt;</code>, <code>&gt;</code>) toimivat erottimina, jolla k\u00e4ytt\u00e4j\u00e4n sy\u00f6tt\u00e4m\u00e4 (tai tiedosta luettu) sy\u00f6te jaetaan osiksi, jotka sittemmin tunnistetaan joko komennoiksi tai operaattoreiksi. Komennot voivat olla sis\u00e4isi\u00e4 (eng. built-in) kuten <code>cd</code> tai ulkoisia kuten <code>nano</code>. Ne voivat olla my\u00f6s aliaksia tai funktioita. Tarkemmat shellin vaiheet l\u00f6ytyv\u00e4t ohjekirjasta. T\u00e4rke\u00e4\u00e4 on muistaa, ett\u00e4 v\u00e4lily\u00f6nti ja newline ovat erottimia.</p> <p>UNIX:st\u00e4 periytyviss\u00e4 k\u00e4ytt\u00f6j\u00e4rjestelmiss\u00e4 komennot noudattavat tyypillisesti POSIX-standardiperheen \"utility argument syntax\"-k\u00e4yt\u00e4nt\u00f6\u00e4. Mik\u00e4li k\u00e4yt\u00f6ss\u00e4 on bash-yhteensopiva shell, kuten yleens\u00e4 on, niin lis\u00e4mauteena ovat GNU:n lis\u00e4\u00e4m\u00e4t pitk\u00e4t option-nimet. Mik\u00e4li k\u00e4yt\u00e4t jotakin muuta shelli\u00e4 kuin bashi\u00e4, toiminnallisuus voi poiketa.</p> <p>Tutkitaan t\u00e4t\u00e4 k\u00e4yt\u00e4nn\u00f6ss\u00e4 alla olevan sy\u00f6tteen avulla. Stdout on ignoorattu, jotta koodi pysyisi lyhyen\u00e4, mutta kokeile toki ajaa lokaalisti komennot. Jos ajat eri komentoja, sinun pit\u00e4isi huomata, ett\u00e4 tuloste pysyy samana, vaikka vaihdamme optioneiden kirjoitusasua.</p> Bash<pre><code># L\u00e4ht\u00f6piste\n# Huomaa, ett\u00e4 pitk\u00e4 option toimii sek\u00e4 yht\u00e4suuruismerkin\n# kuin v\u00e4lily\u00f6nnin avulla eli --ignore Desktop on my\u00f6s ok.\n$ ls -lah --inode --ignore=Desktop ~/\n\n# Useimmille komennoille l\u00f6ytyy lyhyt ja pitk\u00e4 option format\n# Pitk\u00e4 komento --inode on lyhennetty lyhyeksi -i:ksi\n$ ls -lah -i --ignore=Desktop ~/\n\n# My\u00f6s ignorelle l\u00f6ytyy lyhyt formaatti. Huomaa case sensitive.\n$ ls -lah -i -I Desktop ~/\n\n# Kaikki argumentteja odottamattomat lyhyet optionit voi kirjoittaa\n# yhteen. Ne sis\u00e4lt\u00e4v\u00e4t aina vain yhden kirjaimen.\n$ ls -lahi -I Desktop ~/\n\n# Lyhyet optionit voi my\u00f6s j\u00e4rjest\u00e4\u00e4 haluamallaan tavalla\n$ ls -ihal -I Desktop ~/\n\n# Ainoan argumentteja odottavan optionin voi j\u00e4tt\u00e4\u00e4 listan viimeksi.\n$ ls -ihalI Desktop ~/\n\n# Ja my\u00f6s v\u00e4lily\u00f6nnin voi poistaa\n$ ls -ihalIDesktop ~/\n</code></pre> <p>Sy\u00f6tteess\u00e4 ei ole muita metamerkkej\u00e4 kuin v\u00e4lily\u00f6nti, joten kyseess\u00e4 on yksinkertainen komento. Bash etsii itse komentoa useista eri paikoista (funktioista, aliaksista, built-ineista, <code>$PATH</code>:sta) ja ajaa ensimm\u00e4isen l\u00f6ytyneen. Muut osat eli <code>-lah</code>, <code>--inode</code> ja <code>--ignore=Desktop</code>  sy\u00f6tet\u00e4\u00e4n ohjelmalle, ja ohjelma parsii ne parhaaksi katsomallaan tavalla optionseiksi, optioneiden argumenteiksi, ja argumenteiksi. Lue lis\u00e4\u00e4 esimerkkej\u00e4 t\u00e4\u00e4lt\u00e4: Conventions for Command Line Options (nullprogram.com)</p> <p>Huomaa, ett\u00e4 lyhyet komennot eiv\u00e4t ole mik\u00e4\u00e4n itsetarkoitus. Yll\u00e4 olevan komennon voi kirjoittaa huomattavasti luettavammassa muodossa n\u00e4in:</p> Bash<pre><code>$ ls -l --all --human-readable --inode --ignore=Desktop ~\n</code></pre> <p>Todella pitk\u00e4t komennot voi jakaa usealle riville <code>\\</code> merkin avulla. Kyseinen merkki on Bashiss\u00e4 <code>ESCAPE</code>, ja se pakenee eli ignooraa seuraavan merkin, joka olisi t\u00e4ss\u00e4 tapauksessa rivinaihto. Huomaathan, ett\u00e4 escapen j\u00e4lkeen ei saa olla v\u00e4lily\u00f6nti\u00e4 ennen Enter painamista, tai v\u00e4lily\u00f6nti on se merkki, joka on <code>ESCAPE</code>:n kohde:</p> Bash<pre><code>$ ls \\\n&gt; -l --all \\\n&gt; --human-readable \\\n&gt; --inode \\\n&gt; --ignore=Desktop ~\n</code></pre>"},{"location":"peruskaytto/komennot/#useat-positio-argumentit","title":"Useat positio argumentit","text":"<p>Huomaa, ett\u00e4 monet komennot huolivat useita argumentteja. Alla esimerkki:</p> Bash<pre><code>$ ls ~/Downloads ~/Documents\nDocuments/:\nmy_file\n\nDownloads/:\nPedra_Azul_Milky_Way.jpg.webp\n</code></pre> <p>Joskus, joskin harvoin, optioneiden p\u00e4\u00e4ttymist\u00e4 ja argumenttien alkamista erotetaan <code>--</code> merkeill\u00e4. N\u00e4inp\u00e4 alla oleva komento on sama kuin yll\u00e4 oleva:</p> Bash<pre><code>$ ls -- ~/Downloads ~/Documents\n</code></pre>"},{"location":"peruskaytto/komennot/#apua","title":"Apua","text":""},{"location":"peruskaytto/komennot/#komentojen-loytaminen","title":"Komentojen l\u00f6yt\u00e4minen","text":"<p>Kuvio 1: Osa komennoista pit\u00e4\u00e4 vain tiet\u00e4\u00e4; niiden p\u00e4\u00e4ttely nimest\u00e4 voi olla vaikeaa. Tiedostojen luominen (<code>touch</code>) tai uudelleen nime\u00e4minen (<code>mv</code>) saattaa yll\u00e4tt\u00e4\u00e4.</p> <p>Bashin tuntemat built-init l\u00f6yt\u00e4\u00e4 (built-in)-komennolla:</p> Bash<pre><code># Listaa kaikki built-init\n$ compgen -b\n\n# Listaa kaikki (muut) komennot\n$ compgen -c\n</code></pre> <p>Bash etsii muita komentoja ymp\u00e4rist\u00f6muuttujasta $PATH. Ymp\u00e4rist\u00f6muutujat esitell\u00e4\u00e4n muualla, mutta voit listata sen sis\u00e4ll\u00f6n n\u00e4in:</p> Bash<pre><code>$ echo $PATH\n/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n\n$ echo $PATH | tr \":\" \"\\n\"   # Paranna luettavuutta (1)\n/usr/local/sbin\n/usr/local/bin\n/usr/sbin\n/usr/bin\n/sbin\n/bin\n</code></pre> <ol> <li>Komento tr vaihtaa t\u00e4ss\u00e4 tapauksessa kaksoispisteen rivivaihdoksi. Tutustu komentoon <code>tr</code> alla olevien ohjeiden avulla.</li> </ol> <p>Jos haluat selvitt\u00e4\u00e4, miss\u00e4 polussa jokin ajettava PATH:ssa oleva ohjelma on, tai mik\u00e4 on jonkin aliaksen m\u00e4\u00e4ritelm\u00e4, kokeile seuraavia komentoja:</p> Bash<pre><code># T\u00e4m\u00e4 on deprekoitunut ainakin Debianissa mutta toimii yh\u00e4\n$ which ls\nls: aliased to ls -G\n\n# T\u00e4m\u00e4 on ylemm\u00e4n sijasta suositeltu komento\n$ command -v ls\nalias ls='ls -G'\n\n# My\u00f6s type palauttaa polun. Alias vaatii -a flagin.\n$ type -a ls\nls is an alias for ls -G\nls is /bin/ls\n</code></pre>"},{"location":"peruskaytto/komennot/#komentojen-ohjeiden-loytaminen","title":"Komentojen ohjeiden l\u00f6yt\u00e4minen","text":"<p>Alla joitakin hy\u00f6dyllisi\u00e4 tapoja tutustua komennon sielunel\u00e4m\u00e4\u00e4n.</p> <ol> <li>L\u00e4hes jokainen ohjelma vastaa pitk\u00e4\u00e4n optioniin  <code>--help</code> tulostamalla oman helpin. </li> <li>Shellin omat built-init tyypillisesti tulostavat helpin komennolla <code>help &lt;komento&gt;</code>. Huomaa, ett\u00e4 help itsess\u00e4\u00e4n on yksi built-in.</li> <li>Komento <code>man &lt;komento&gt;</code> tulostaa komennon k\u00e4ytt\u00f6ohjeen, mik\u00e4li se l\u00f6ytyy man pagesista (ks. <code>usr/share/man</code>). Komennon itsens\u00e4 ohjeet l\u00f6ytyv\u00e4t my\u00f6s sielt\u00e4: kokeila ajaa <code>man man</code>.</li> <li> <p>Komento <code>man -k &lt;hakusana&gt;</code> palauttaa listan sivuista, jotka sis\u00e4lt\u00e4v\u00e4t hakusanan. T\u00e4t\u00e4 voi k\u00e4ytt\u00e4\u00e4 my\u00f6s komentojen etsimiseen.</p> <p>Tip</p> <p>Jos asennuksesi on kovin tuore, man-sivuston tietokantaa ei ole v\u00e4ltt\u00e4m\u00e4tt\u00e4 p\u00e4ivitetty. Jos saat outputin <code>&lt;hakusana&gt;: nothing appropriate</code> sellaiselle hakusanalle, jolle voisi kuvitella l\u00f6ytyv\u00e4n tietoa (esim. <code>user</code>), p\u00e4ivit\u00e4 tietokanta komennolla <code>sudo mandb</code>.</p> </li> <li> <p>Komento <code>info &lt;komento&gt;</code> palauttaa infosivuston, joka sis\u00e4lt\u00e4\u00e4 Internet-sivuilta tutun tavan linkitt\u00e4\u00e4 documenteja yhteen. Voit navigoida linkkiin painamalla Enter.</p> </li> <li>Komento <code>type &lt;komento&gt;</code> paljastaa, onko komento alias, built-in vai jossakin PATH:n lokaatiossa oleva ohjelma.</li> <li>Internetin hakukoneet. Varmistathan, ett\u00e4 ymm\u00e4rr\u00e4t mit\u00e4 komennot tekev\u00e4t ennen kuin ajat niit\u00e4.</li> </ol>"},{"location":"peruskaytto/komennot/#tldr","title":"TLDR","text":"<p>Er\u00e4s n\u00e4pp\u00e4r\u00e4 apuv\u00e4line komentojen ja niiden optioneiden tutkimiseen on tldr.inbrowser.app/. Verkkosivun lis\u00e4ksi voit py\u00f6ritt\u00e4\u00e4 sit\u00e4 lokaalisti. T\u00e4m\u00e4 onnistuu kenties helpoiten ty\u00f6kalun uv avulla. Mik\u00e4li sinulla on asennettuna <code>uv</code>, kokeile seuraavaa komentoa, joka asentaa PyPi: tldr-paketin koneellesi:</p> <pre><code># Install\nuv tool install tldr\n\n# Get local copy of all pages for faster access\ntldr --update_cache\n\n# Get help for a command\ntldr tar\n</code></pre>"},{"location":"peruskaytto/komennot/#merkkijonot-ja-muuttujat","title":"Merkkijonot ja muuttujat","text":""},{"location":"peruskaytto/komennot/#muuttujat","title":"Muuttujat","text":"<p>Voit luoda nykyisen shellin skooppiin muuttujia ja k\u00e4ytt\u00e4\u00e4 niit\u00e4 muun muassa lyhent\u00e4m\u00e4\u00e4n komentoja. Huomaa, ett\u00e4 <code>=</code>-merkin ymp\u00e4rill\u00e4 ei saa olla v\u00e4lily\u00f6ntej\u00e4. Alla esimerkki:</p> Bash<pre><code>$ url=\"https://jsonplaceholder.typicode.com\"\n$ curl $url/posts/1   # GET data\n</code></pre> stdout<pre><code>{\n  \"id\": 1,\n  \"body\": \"Some really long body.\"\n}\n</code></pre> <p>Mik\u00e4li haluamme p\u00e4ivitt\u00e4\u00e4 yll\u00e4 n\u00e4kyv\u00e4n rivin lyhyemm\u00e4ksi, voimme uusiok\u00e4ytt\u00e4\u00e4 url-muuttujaa ja luoda pari uutta:</p> Bash<pre><code>$ new_data='{\"body\": \"This is a shorter body.\"}'\n$ header='Content-Type: application/json'\n$ curl -X PATCH -H \"$header\" -d \"$new_data\" $url/posts/1\n</code></pre> stdout<pre><code>{\n  \"id\": 1,\n  \"body\": \"This is a shorter body.\"\n}\n</code></pre> <p>Paikallisesta shell-muuttujasta voi muuntaa ymp\u00e4rist\u00f6muuttujan (eng. environment variable) komennolla <code>export &lt;muuttuja&gt;</code>, jolloin niihin p\u00e4\u00e4see k\u00e4siksi prosessit eli ohjelmat, joita k\u00e4ytt\u00e4j\u00e4 ajaa. N\u00e4it\u00e4 k\u00e4ytet\u00e4\u00e4n ajoittain konfiguraatiotiedoston jatkeena tai korvikkeena. Esimerkiksi Amazon AWS:n CLI etsii tokeneita sek\u00e4 asetuksia ymp\u00e4rist\u00f6muuttujista. Ne voi asettaa n\u00e4in:</p> Bash<pre><code>$ AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE\n$ export AWS_ACCESS_KEY_ID \n</code></pre> <p>Saman voi tehd\u00e4 my\u00f6s yhdell\u00e4 rivill\u00e4:</p> Bash<pre><code>$ export AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE\n</code></pre> <p>Mik\u00e4li tunnuksia sis\u00e4lt\u00e4v\u00e4t ymp\u00e4rist\u00f6muuttujat ovat asetettuina, AWS CLI -komennot, kuten S3-bucketit listaava <code>aws s3 ls</code>, k\u00e4yv\u00e4t poimimassa itselleen t\u00e4rkeit\u00e4 arvoja ymp\u00e4rist\u00f6muuttujista. Huomaathan, ett\u00e4 konfiguraatiotiedostot ovat yleisesti turvallisempina pidetty keino asettaa konfiguraatiot paikoilleen: jokin ohjelma saattaa vikatilanteessa tulostaa ymp\u00e4rist\u00f6muuttujia, ja n\u00e4in vuotaa arkaluonteisia arvoja v\u00e4\u00e4rien silm\u00e4parien katseltaviksi.</p>"},{"location":"peruskaytto/komennot/#merkkijonot","title":"Merkkijonot","text":"<p>Komennoissa k\u00e4ytet\u00e4\u00e4n usein argumentteina merkkijonoja, joten t\u00e4ss\u00e4 v\u00e4liss\u00e4 on hyv\u00e4 oppia, kuinka shell reagoi tiettyihin metamerkkeihin. Alla on esimerkkej\u00e4: </p> Bash<pre><code>$ echo 'Onko $USER t\u00e4\u00e4ll\u00e4?'     # ''-merkit tekev\u00e4t merkkijonosta literaalin\nOnko $USER t\u00e4\u00e4ll\u00e4?\n\n$ echo \"Onko $USER t\u00e4\u00e4ll\u00e4?\"     # \"\"-merkit sallivat erilaiset substitutionit\nOnko opettaja t\u00e4\u00e4ll\u00e4?\n\n$ echo \"T\u00e4n\u00e4\u00e4n on: $(date -I)\"  # Command substitution\nT\u00e4n\u00e4\u00e4n on: 2023-12-31\n\n$ echo \"Sormia on: $((5 + 5))\"  # Arithmetic substitution\nSormia on: 10\n\n$ echo Liian \\                  # Line continuation\n&gt; pitk\u00e4 lause \\\n&gt; yhdelle riville\nLiian pitk\u00e4 lause yhdelle riville\n\n$ touch my/{tralala,dingdingdong}   # Brace expansion\n\necho El\u00e4m\u00e4n tarkoitus: \\        # Parameter expansion\n&gt; ${MEANING_OF_LIFE:-42}  \n42\n\n$ echo $'c\\nb\\na'               # ANSI-C Quoting (1)\nc\nb\na\n</code></pre> <ol> <li>Yksitt\u00e4isten lainausmerkkien v\u00e4liss\u00e4 oleva, dollareiden edelt\u00e4v\u00e4 merkkijono, voi sis\u00e4lt\u00e4\u00e4 poistumismerkill\u00e4 (kenoviiva, <code>\\</code>)   alkavia taikasanoja, joista dekoodataan my\u00f6hemmin haluttu merkki. Yleisesti tarpeellisin on rivinvaihto eli <code>\\n</code>. Lue lis\u00e4\u00e4: Bash Reference Manual (gnu.org)</li> </ol> <p>Jos mietit, ett\u00e4 mik\u00e4 on <code>\\n</code> yll\u00e4 n\u00e4kyv\u00e4ss\u00e4 <code>echo $'c\\nb\\na'</code> komennossa, niin kyseess\u00e4 on line feed eli newline character. Huomaa, ett\u00e4 echo lis\u00e4\u00e4 vakiona newlinen aina rivin per\u00e4\u00e4n. Jos alla olevat komennot h\u00e4mment\u00e4v\u00e4t, kokeile <code>man xxd</code> ja esimerkiksi <code>xxd tiedosto.txt</code>.</p> Bash<pre><code># Echo ilman parametrej\u00e4 sis\u00e4lt\u00e4\u00e4 newlinen\n$ echo \"\" | xxd\n\n# Echo -n poistaa newlinen\n$ echo -n \"\" | xxd\n\n# Huomaa, ett\u00e4 ASCII:ta seuraavat merkit ovat UTF-8 enkoodattuja, monen tavun arvoja:\n$ echo -n \"\u00e4\" | xxd\n</code></pre> <p></p> <p>Kuvio 1: Notepad++ Windowsissa tuottaa vakiona rivinvaihdossa kaksi merkki\u00e4: CR (<code>\\r</code>) sek\u00e4 LF (<code>\\n</code>). Linuxissa k\u00e4yt\u00f6ss\u00e4 on tyypillisesti vain j\u00e4lkimm\u00e4inen.</p> <p>Note</p> <p>N\u00e4m\u00e4 merkit voivat joskus aiheuttaa h\u00e4mmennyst\u00e4, jos joku l\u00e4hett\u00e4\u00e4 Linux-ymp\u00e4rist\u00f6\u00f6n esimerkiksi konfiguraatiotiedoston, joka on luotu Windows-ymp\u00e4rist\u00f6ss\u00e4 huolimattomasti. Ota t\u00e4st\u00e4 koppi ja selvit\u00e4, mik\u00e4 on \"CR LF\":n historia rivivaihtona. Mit\u00e4 CR ja LF k\u00e4yt\u00e4nn\u00f6ss\u00e4 edustavat? </p>"},{"location":"peruskaytto/komennot/#hyodyllisia-komentoja","title":"Hy\u00f6dyllisi\u00e4 komentoja","text":"<p>Ota selv\u00e4\u00e4 kustakin komennosta alla olevasta taulukosta.</p> K\u00e4ytt\u00f6tarkoitus Komentoja Avun etsiminen <code>man</code>, <code>info</code>, <code>&lt;komento&gt; --help</code> Tiedostoissa ja hakemistoissa navigointi <code>pwd</code>, <code>ls</code>, <code>cd</code>, <code>tree</code>, <code>clear</code> Tiedostojen pl\u00e4r\u00e4ys <code>less</code>, <code>cat</code>, <code>diff</code>, <code>head</code>, <code>tail</code>, <code>find</code>, <code>locate</code>, <code>file</code>, <code>type</code>, <code>stat</code> Tiedostojen luominen ja muokkaus <code>touch</code>, <code>mkdir</code>, <code>nano</code>, <code>vi</code> tai <code>vim</code>, <code>vimtutor</code>, <code>cp</code>, <code>mv</code>, <code>ln</code> Tiedostojen ja kansioiden poisto <code>rm</code>, <code>rmdir</code> Tiedostojen prosessointi <code>wc</code>, <code>tr</code>,  <code>sort</code>, <code>uniq</code>, <code>grep</code>, <code>aws</code> K\u00e4ytt\u00e4j\u00e4\u00e4n tai ymp\u00e4rist\u00f6\u00f6n liittyvi\u00e4 <code>id</code>, <code>who</code>, <code>whoami</code>, <code>groups</code>, <code>history</code>, <code>tty</code>, <code>exit</code>, <code>printenv</code>, <code>alias</code> Tiedostojen pakkaus <code>gzip</code>, <code>tar</code> <p>Tip</p> <p>Komentorivilt\u00e4 ajettavien k\u00e4skyjen ajamiseen l\u00f6yd\u00e4t reilusti esimerkkej\u00e4 ja snippettej\u00e4 Github-repositoriosta nimelt\u00e4\u00e4n the-art-of-command-line</p>"},{"location":"peruskaytto/komennot/#tehtavat","title":"Teht\u00e4v\u00e4t","text":"<p>Teht\u00e4v\u00e4: Monirivinen komento</p> <p>Kokeile alla olevaa monirivist\u00e4 komentoa shelliss\u00e4. Kirjoita se rivi rivilt\u00e4: \u00e4l\u00e4 yrit\u00e4 kopioida ja liitt\u00e4\u00e4 rimpsua kokonaisuudessaan. Kopiointi ei tule toimimaan <code>&gt;</code>-merkkien takia, jotka kuuluvat promptiin eiv\u00e4tk\u00e4 komentoon</p> <pre><code>$ ls \\\n&gt; -l --all \\\n&gt; --human-readable \\\n&gt; --inode \\\n&gt; --ignore=Desktop ~\n</code></pre> <p>Teht\u00e4v\u00e4: Standardoi hakemistorakenne</p> <p>IT-alalla on t\u00e4rke\u00e4\u00e4 olla j\u00e4rjestelm\u00e4llinen: \u00e4l\u00e4 sotke kotihakemistoasi turhilla tiedostoilla! P\u00e4\u00e4t\u00e4 ja luo hakemistorakenne, jossa voit kokeilla bash-komentoja ja miss\u00e4 voit t\u00e4m\u00e4n kurssin teht\u00e4v\u00e4t.</p> <p>Kenties hyv\u00e4 lokaatio olisi: <code>~/harjoitukset/&lt;viikkonumero&gt;/&lt;osion_otsikko&gt;/&lt;teht\u00e4v\u00e4&gt;</code>.</p> <p>Huomaa, ett\u00e4 <code>&lt;jotain&gt;</code>-merkinn\u00e4t ovat paikanpit\u00e4ji\u00e4, jotka tulee korvata oikeilla arvoilla. Esimerkiksi <code>~/harjoitukset/1/komennot/1_standardi/</code>. On sinun valintasi, k\u00e4yt\u00e4tk\u00f6 viikkonumeroa, ja jos k\u00e4yt\u00e4t, k\u00e4yt\u00e4tk\u00f6 kurssin juoksevaa viikkonumeroa vai kalenteriviikkoa. Ole kuitenkin johdonmukainen ja perustele valintasi.</p> <p>Harjoittele kyseisen nestatun hakemistorakenteen luomista ja siihen siirtymist\u00e4 (<code>cd</code>-komennolla).</p> <p>Teht\u00e4v\u00e4: Graafinen tiedostoselain</p> <p>T\u00e4ll\u00e4 kurssilla k\u00e4ytet\u00e4\u00e4n p\u00e4\u00e4asiassa terminaalia, mutta koska olemme GNOME-ty\u00f6p\u00f6yd\u00e4ss\u00e4, on hyv\u00e4 opetella luotujen tiedostojen ja hakemistojen l\u00f6yt\u00e4minen my\u00f6s graafisesti. T\u00e4m\u00e4 voi samalla madaltaa Linuxin k\u00e4yt\u00f6n kynnyst\u00e4.</p> <p>Navigoi Nautilus-ty\u00f6kalulla luomaasi hakemistorakenteeseen ja tarkastele sen sis\u00e4lt\u00f6\u00e4.</p> <p>Vinkki: kokeile ajaa terminaalissa komento <code>open .</code> kun olet aiemmin luomassasi hakemistossa (esim. <code>~/harjoitukset/1/komennot/1_standardi/</code>)</p> <p>Teht\u00e4v\u00e4: IsOt jA PiEnEt kIrJaImEt</p> <p>Kokeile luoda seuraavan nimiset hakemistot samaan lokaatioon (esim. <code>~/harjoitukset/1/komennot/4_case/</code>):</p> <ul> <li><code>CaseSensitive</code></li> <li><code>casesensitive</code></li> <li><code>CASESENSITIVE</code></li> </ul> <p>Onko se sallittua? Toimiko t\u00e4m\u00e4 samoin Windowsissa?</p> <p>Teht\u00e4v\u00e4: V\u00e4lily\u00f6nnit tiedostonimiss\u00e4</p> <p>Selvit\u00e4, kuinka voit luoda hakemiston, jonka nimess\u00e4 on v\u00e4lily\u00f6nti (esim. <code>~/harjoitukset/1/komennot/5_space/Hakemiston Nimi</code>). Voit kokeilla samaa my\u00f6s tiedostonimell\u00e4.</p> <p>Selvit\u00e4 my\u00f6s, kuinka voit siirty\u00e4 t\u00e4h\u00e4n hakemistoon (<code>cd</code>-komennolla) tai kuinka voit nimet\u00e4 sen uudestaan (esim. <code>hakemiston_nimi</code>).</p> <p>Teht\u00e4v\u00e4: Read The Fine Manual ja date-komento</p> <p>Kuvitellaan, ett\u00e4 luit juuri, ett\u00e4 lipunmyynti Best Summit Ever -tapahtumaan alkaa 2 vuorokauden, 19 tunnin ja 42 minuutin p\u00e4\u00e4st\u00e4. Selvit\u00e4 <code>date</code>-komennon ja sen parametrien avulla, milloin t\u00e4m\u00e4 aika on.</p> <p>K\u00e4yt\u00e4 t\u00e4ss\u00e4 dokumentissa neuvottuja tapoja l\u00f6yt\u00e4\u00e4 ohjeita komennolle: \u00e4l\u00e4 kysy suoraan oikeaa vastausta teko\u00e4lylt\u00e4. Oppimisp\u00e4iv\u00e4kirjassasi pit\u00e4isi n\u00e4ky\u00e4 p\u00e4\u00e4ttelyketju ja se, mist\u00e4 kohtaa mit\u00e4 dokumenttia l\u00f6ysit tarvittavan tiedon.</p> <p>Teht\u00e4v\u00e4: Kissa, ananas, avaruus ja pari muuta</p> <p>Tallenna <code>peruskaytto_luo_filut.sh</code> tiedosto hakemistoon <code>~/harjoitukset/komennot/tehtava7/</code>. Sen voi ladata <code>wget</code>-ohjelmalla GitHubista t\u00e4m\u00e4n kurssin repositoriosta. Tee scriptist\u00e4 ajettava ja aja se. Ohjeet alla:</p> <pre><code># Lataa\nwget https://raw.githubusercontent.com/sourander/linux-perusteet/refs/heads/main/kurssitiedostot/peruskaytto_luo_filut.sh\n\n# Tee siit\u00e4 ajettava\nchmod +x peruskaytto_luo_filut.sh\n\n# Aja se\n./peruskaytto_luo_filut.sh\n</code></pre> <p>Skripti generoi useita hakemistoja ja tiedostoja. Kaikki tiedostot ovat aluksi jarjestelemattomat/-hakemistossa. Siirr\u00e4 tiedostot komentokehotteella hakemistoihin, joihin luulet niiden kuuluvan.</p> <p>Vinkki: Jos sinun tarvitsee aloittaa alusta, tuhoa koko <code>tehtava7/</code>-hakemisto ja aloita alusta.</p>"},{"location":"peruskaytto/tiedostot/","title":"Tiedostot","text":""},{"location":"peruskaytto/tiedostot/#linux-vs-windows","title":"Linux vs. Windows","text":"<p>Linuxin (ja UNIX:n) hakemistorakenne voi tuntua oudolta, mik\u00e4li on aiemmin tottunut Windowsin vastaavaan. Windowsissa yksi fyysinen tallennuslaite (kiintolevy, optinen asema, muistikortinlukija) l\u00f6ytyy tyypillisesti asemasta, joka merkataan kirjaimella (eng. drive-letter). Kiintolevyn osio, jolle Windows on asennettu, l\u00f6ytyy usein C-asemasta eli polusta <code>C:\\</code>. Mik\u00e4li tietokoneessa on toinen kiintolevy, sen osio voidaan tuntea esimerkiksi <code>D:\\</code>-asemana. <code>E:\\</code> on esimerkiksi CD-asema tai toinen kiintolevy/osio.</p> <p>Note</p> <p>Tarkennuksena mainittakoon, ett\u00e4 laite:osio:asema suhde ei ole aina v\u00e4ltt\u00e4m\u00e4tt\u00e4 n\u00e4in yksiselitteinen. K\u00e4ytt\u00e4j\u00e4 voi esimerkiksi luoda useasta kiintolevyst\u00e4 RAID-henkisen <code>Windows Storage Pool</code>:n, jolloin monta fyysist\u00e4 levy\u00e4 l\u00f6ytyy yhden aseman kirjaimen takaa.</p> <p>Lis\u00e4ksi my\u00f6s Windows-ymp\u00e4rist\u00f6ss\u00e4 on osioita, joille ei ole tarkoitus tallentaa laisinkaan tietoa k\u00e4sin. N\u00e4it\u00e4 ovat esimerkiksi UEFI- ja Recovery-osiot. Jos osioit Dual Boot -asennuksen yhteydess\u00e4 Linuxia varten k\u00e4ytt\u00e4m\u00e4t\u00f6nt\u00e4 tilaa, t\u00f6rm\u00e4sit n\u00e4ihin todenn\u00e4k\u00f6isesti. Huomaa, ett\u00e4 n\u00e4m\u00e4 toki voi mountata asematunnukseen esimerkiksi debuggausta varten PowerShellill\u00e4.</p> <p>Linuxissa tilanne on hyvin toinen. Asemia ja niiden kirjaimia ei ole olemassa. Hakemistorakenteen juuri ei siis ala laitteen/aseman kirjaimesta vaan <code>/</code>-merkist\u00e4, joka toimii Linuxissa hakemistoerottimena. Hakemistot muodostavat puurakenteen samalla tavalla kuin Windowsin hakemistot, joten on mahdollista, ett\u00e4 <code>kissa.txt</code> sijaitsee polussa <code>/a/b/c/kissa.txt</code>. Yksitt\u00e4inen hakemisto, kuten <code>/home</code> tai <code>/var</code>, voi sijaita saman levyn eri partitiolla tai jopa kokonaan eri levyll\u00e4 kuin valtaosa k\u00e4ytt\u00f6j\u00e4rjestelm\u00e4st\u00e4.</p> <p>Alla n\u00e4kyy ajettuna komento <code>lsblk</code> eli List Block Devices. T\u00e4ss\u00e4 tapauksessa <code>sda</code> on laite eli kiintolevy. Sen osiot tunnistaa juoksevasta numerosta j\u00e4lkiliitteess\u00e4. L\u00e4hes koko 30 Gt:n levy on varattu <code>/</code>-hakemistolle, pois lukien tietokoneen k\u00e4ynnistysprosessin tarvitsemat pikkuosiot, sek\u00e4 virtuaalinen snap:n hallinnoima osio, joka on varattu Firefoxin oikolukuohjelmistolle.</p> Bash<pre><code>$ lsblk /dev/sda\nAME   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS\nsda      8:0    0   30G  0 disk \n\u251c\u2500sda1   8:1    0    1M  0 part \n\u251c\u2500sda2   8:2    0  513M  0 part /boot/efi\n\u2514\u2500sda3   8:3    0 29,5G  0 part /var/snap/firefox/common/host-hunspell # (1)\n                                /\n</code></pre> <ol> <li>Lue lis\u00e4\u00e4: Sdb5 mounted on firefox? - snap - snapcraft.io</li> </ol> <p>Alla eritt\u00e4in karkea taulukko Linuxin ja Windowsin tiedosto/kansiorakenteen eroista.</p> Linux Windows Kansiorakenteen standardi Filesystem Hierarchy Standard Microsoft ja konventiot Juuri <code>/</code> <code>C:\\</code> Kotihakemisto <code>/home/username/</code> <code>C:\\Users\\username\\</code> Kotihakemisto env <code>$HOME</code> <code>%homepath%</code> Todenn\u00e4k\u00f6inen tiedostoj\u00e4rjestelm\u00e4 ext4, XFS NTFS Tekstitiedoston p\u00e4\u00e4te Ei mit\u00e4\u00e4n v\u00e4li\u00e4 .txt Ajettavan tiedoston p\u00e4\u00e4te Ei mit\u00e4\u00e4n v\u00e4li\u00e4 .exe"},{"location":"peruskaytto/tiedostot/#spesifikaatiot","title":"Spesifikaatiot","text":""},{"location":"peruskaytto/tiedostot/#filesystem-hierarchy-standard","title":"Filesystem Hierarchy Standard","text":"<p>Linuxin tiedostoj\u00e4rjestelm\u00e4n standardi l\u00f6ytyy Filesystem Hierarchy Standard (linuxfoundation.org)-sivustolta, mutta alla on listattuna t\u00e4rkeimm\u00e4t juuritason kansiot taulukossa. On t\u00e4rke\u00e4\u00e4 kuitenkin huomioida, ett\u00e4 vaikka kyseess\u00e4 on standardi, ei se tarkoita, ett\u00e4 kaikki Linux-jakelut noudattaisivat sit\u00e4. Esimerkiksi GoboLinux asentaa ohjelmat poikkeukselliseen <code>/Programs</code>-hakemistoon. Voit tutustua t\u00e4h\u00e4n FHS:st\u00e4 poikkeavaan tapaan GoboLinux at a glance-sivulla. Esimerkin mukaan esimerkiki Bash asentuisi <code>/usr/bin/bash</code> sijasta <code>/Programs/Bash/4.4/bin/bash</code>-hakemistoon, ja sen manuaalit olisivat tyypillisen <code>/usr/share/man</code> sijasta <code>/Programs/Bash/4.4/man/</code>-hakemistossa.</p> Hakemisto Sis\u00e4lt\u00e4\u00e4 /bin, /sbin Useimmiten C-kielest\u00e4 k\u00e4\u00e4nnettyn\u00e4 ajettavia bin\u00e4\u00e4ritiedostoja, kuten yll\u00e4 k\u00e4ytetty <code>lsbkl</code> tai hakemistojen luontiin tarkoitettu <code>mkdir</code>. Tyypillisesti viittaa lokaatioon <code>/usr/bin/</code> sek\u00e4 <code>/usr/sbin/</code>. /boot Kernel image, jota k\u00e4ytet\u00e4\u00e4n konetta k\u00e4ynnist\u00e4ess\u00e4. /dev Fyysisi\u00e4 laitteita, kuten yll\u00e4 n\u00e4kyv\u00e4 <code>sda</code>, tai loogisia/virtuaalisia laitteita kuten partitio <code>sda1</code> tai ty\u00f6p\u00f6yt\u00e4ymp\u00e4rist\u00f6ss\u00e4 k\u00e4ytt\u00e4m\u00e4si terminaali <code>/dev/pts/0</code>. /etc Koko j\u00e4rjestelm\u00e4\u00e4 koskevat konfiguraatiotiedostot, kuten <code>/etc/hosts</code>, josta tarkistetaan tunnetut hostnamet ennen DNS-kyselyit\u00e4, tai <code>/etc/passwd</code>, jossa m\u00e4\u00e4ritell\u00e4\u00e4n k\u00e4ytt\u00e4j\u00e4t ja aikoinaan jopa salasanat, tai <code>/etc/fstab</code> /home K\u00e4ytt\u00e4jien kotikansiot. /lib Jaettuja kirjastoja, joita <code>/bin</code>:ss\u00e4 ja <code>/sbin</code>:ss\u00e4 olevat ohjelmat tarvitsevat, kuten C-kielen kirjastot <code>libc.so</code>. /mnt, /media K\u00e4sin tai automaattisesti mountattavat mediat kuten CD- sek\u00e4 USB-asemat tai jopa verkkolevyt. /opt Jotkin kolmannen osapuolen eli jakelun ulkopuoliset ohjelmat. Opiskelijana saatat huomata, ett\u00e4 sinne asentuu esimerkiksi Brave-selain, Cisco Packet Tracer tai Zoom. /proc, /sys Kernelin rajapintoja, kuten <code>/proc/version</code>, joka sis\u00e4lt\u00e4\u00e4 kernelin ja distron versioon liittyv\u00e4\u00e4 tietoa. /tmp V\u00e4liaikaiset tiedostot. Eiv\u00e4t s\u00e4ily ikuisesti. /usr K\u00e4ytt\u00e4jien ohjelmat ja tiedostot. /var Usein muuttuva, ohjelmien sis\u00e4lt\u00e4m\u00e4 data. Erikoimaininta lokitiedostoja sis\u00e4lt\u00e4v\u00e4 alihakemisto <code>/var/log/</code> <p>Tip</p> <p>Tyypillisesti distribuution oma paketinhallinta (esim. apt) asentaa ohjelman eri tyyppi\u00e4 edustavat tiedostot eri lokaatioihin: bin\u00e4\u00e4ri <code>/usr/bin</code> hakemistoon, kirjastot <code>/usr/lib</code>-hakemistoon, konfiguraatiot <code>/etc</code>-hakemistoon, data <code>/var</code>-hakemistoon ja niin edelleen.</p> <p>T\u00e4lle on vaihtoehtona <code>/opt</code>, mihin ohjelmat asennetaan jonkin paketinhallinnan (esim. Homebrew) toimesta. Ohjelmat ovat t\u00e4ll\u00f6in self-contained, eiv\u00e4tk\u00e4 ole pirstaloitu <code>/usr</code>-hakemistoon. T\u00e4m\u00e4 on tyypilisesti Windows-k\u00e4ytt\u00e4jille tutumpi tapa (vrt. <code>C:\\Program Files\\Ohjelmannimi</code>).</p>"},{"location":"peruskaytto/tiedostot/#base-directory-specification","title":"Base Directory Specification","text":"<p>XDG Base Directory Specification (XDG BDS) on FSH:een l\u00e4heisesti liittyv\u00e4 m\u00e4\u00e4rittely, joka m\u00e4\u00e4rittelee, miss\u00e4 k\u00e4ytt\u00e4j\u00e4n tiedostot sijaitsevat. T\u00e4h\u00e4n liittyv\u00e4 konventio on tallentaa k\u00e4ytt\u00e4j\u00e4n oman bin\u00e4\u00e4ritiedostot <code>/home/username/.local/bin/</code>-hakemistoon. Jos esimerkiksi haluat luoda oman skriptin, jota juuri sin\u00e4 voit ajaa mist\u00e4 tahansa, voit tallentaa sen t\u00e4h\u00e4n hakemistoon. Samaan hakemistoon tallentuvat usein my\u00f6s k\u00e4ytt\u00e4j\u00e4n omat ohjelmat, jotka eiv\u00e4t ole distribuution paketinhallinnassa.</p> <p>Aiemmin mainitun <code>~/.local/bin</code> lis\u00e4ksi muita siihen liittyvi\u00e4 merkitt\u00e4vi\u00e4 hakemistoja ovat:</p> <ul> <li><code>$XDG_CONFIG_HOME</code> (oletus <code>~/.config/</code>) - K\u00e4ytt\u00e4j\u00e4n konfiguraatiotiedostot</li> <li><code>XDG_DATA_HOME</code> (oletus <code>~/.local/share/</code>) - K\u00e4ytt\u00e4j\u00e4n data, kuten pelitallennukset</li> </ul> <p>Jos ymp\u00e4rist\u00f6muuttujaa ei ole asetettu, k\u00e4ytet\u00e4\u00e4n oletusarvoja. On tyypillist\u00e4, ett\u00e4 asentamasi ohjelma luo kotikansioosi bin\u00e4\u00e4rej\u00e4, konfiguraatioita ja dataa n\u00e4ihin hakemistoihin - ja joskus my\u00f6s hakemistoon, joka on piilotettu hakemisto kotihakemistossa (esim. <code>.ohjelmanimi/</code>, kuten <code>.kube</code>, <code>.azure</code>, <code>.ssh</code>, ...).</p>"},{"location":"peruskaytto/tiedostot/#tehtavat","title":"Teht\u00e4v\u00e4t","text":"<p>Teht\u00e4v\u00e4: Hakemistopuu</p> <p>Piirr\u00e4 valitsemallasi ty\u00f6kalulla hakemistopuu, joka alkaa juuresta, ja sis\u00e4lt\u00e4\u00e4 seuraavat tiedostot kaikkine hakemistoineen. \u00c4l\u00e4 unohda juurihakemistoa.</p> <pre><code>/home/pekka/.bashrc\n/home/pekka/Desktop/P.jpg\n/home/liisa/.bashrc\n/home/liisa/Desktop/L.jpg\n/etc/crontab\n/etc/cron.d/anacron\n/dev/\n</code></pre> <p>Ty\u00f6kalu voi olla kyn\u00e4 ja paperi, Excalidraw, OpenOffice Draw tai vaikkapa ASCII Draw.</p> <p>Teht\u00e4v\u00e4: lsblk</p> <p>Aja komento <code>lsblk</code> ja tarkastele tulosta. Mit\u00e4 laitteita ja osioita l\u00f6ytyy. Jos olet asentanut Dual Bootin, miss\u00e4 n\u00e4ist\u00e4 osioista on Windows ja miss\u00e4 Linux?</p>"},{"location":"prosessit/cron/","title":"Cron","text":"<p>Kuten aiemmassa luvussa n\u00e4imme, ajastetun teht\u00e4v\u00e4n voi luoda systemd:n timerill\u00e4. Toinen - vanhempi mutta silti yh\u00e4 k\u00e4yt\u00f6ss\u00e4 oleva - keino on cron. Cron on ajastettujen teht\u00e4vien hallintaan tarkoitettu ohjelma, joka ajaa m\u00e4\u00e4riteltyj\u00e4 teht\u00e4vi\u00e4 m\u00e4\u00e4ritellyin v\u00e4liajoin.</p> <p>Huomaa, ett\u00e4 cron (kuten kaikki muutkin ohjelmat) ovat systemd:n k\u00e4ynnist\u00e4mi\u00e4 daemoneita tai servicej\u00e4:</p> Bash<pre><code>$ systemctl status cron\n</code></pre>"},{"location":"prosessit/cron/#cronin-kaytto","title":"Cronin k\u00e4ytt\u00f6","text":"<p>Cronin k\u00e4ytt\u00f6 on melko yksinkertaista. Cronin k\u00e4ytt\u00f6\u00f6n liittyy kaksi komentoriviohjelmaa: <code>crontab</code> ja <code>cron</code>. <code>crontab</code>-ohjelmaa k\u00e4ytet\u00e4\u00e4n ajastettujen teht\u00e4vien hallintaan, kun taas <code>cron</code>-ohjelmaa k\u00e4ytet\u00e4\u00e4n ajastettujen teht\u00e4vien suorittamiseen. Aikoinaan cron-teht\u00e4v\u00e4t m\u00e4\u00e4ritettiin <code>/etc/crontab</code>-tiedostossa, mutta nyky\u00e4\u00e4n k\u00e4ytet\u00e4\u00e4n <code>crontab</code>-ohjelmaa, joka mahdollistaa k\u00e4ytt\u00e4j\u00e4kohtaiset cron-teht\u00e4v\u00e4t. K\u00e4y kuitenkin kurkkaamassa, milt\u00e4 <code>/etc/crontab</code> n\u00e4ytt\u00e4\u00e4.</p> Bash<pre><code>$ less /etc/crontab\n</code></pre> <p>Tiedostossa neuvotaan cron-tabin syntaksi, joka on muotoa <code>* * * * *</code> (at every minute), jossa mink\u00e4 tahansa t\u00e4hden voi korvata numerolla. Esimerkiksi <code>59 12 * 12 1</code> olisi lauseena \"joulukuun jokaisena maanantaina kello 12:59 (joka vuosi)\".</p> <p>Task</p> <p>Harjoittele cron-tabin syntaksi online-generaattorin avulla. Yksi monista on Crontab.guru.</p>"},{"location":"prosessit/cron/#crontab-ohjelma","title":"crontab-ohjelma","text":"<p><code>crontab</code>-ohjelmaa k\u00e4ytet\u00e4\u00e4n ajastettujen teht\u00e4vien hallintaan. <code>crontab</code>-ohjelmaa k\u00e4ytet\u00e4\u00e4n seuraavasti:</p> Bash<pre><code>$ crontab [-u k\u00e4ytt\u00e4j\u00e4] [-l | -r | -e]\n</code></pre> <ul> <li><code>-u</code>-valitsimella voidaan m\u00e4\u00e4ritt\u00e4\u00e4 k\u00e4ytt\u00e4j\u00e4 (default: sin\u00e4)</li> <li><code>-l</code>-valitsin listaa.</li> <li><code>-e</code>-valitsin editoi (tai luo).</li> <li><code>-r</code>-valitsin poistaa</li> </ul>"},{"location":"prosessit/cron/#luodaan-uusi-cron-tehtava","title":"Luodaan uusi cron-teht\u00e4v\u00e4","text":"<p>Aluksi sinun k\u00e4ytt\u00e4j\u00e4ll\u00e4 ei todenn\u00e4k\u00f6isesti ole laisinkaan cron-teht\u00e4vi\u00e4. Voit tarkistaa t\u00e4m\u00e4n <code>crontab -l</code> komennolla. Luodaan uusi teht\u00e4v\u00e4.</p> Bash<pre><code>$ crontab -e\nno crontab for &lt;username&gt; - using an empty one\n\nSelect an editor.  To change later, run 'select-editor'.\n  1. /bin/nano        &lt;---- easiest\n  2. /usr/bin/vim.basic\n...\n</code></pre> <p>Valitse haluamasi editori. T\u00e4ss\u00e4 esimerkiss\u00e4 valitsen <code>nano</code>-editorin. T\u00e4m\u00e4n j\u00e4lkeen n\u00e4et tyhj\u00e4n tiedoston, johon voit kirjoittaa cron-teht\u00e4v\u00e4n. Muutokset kirjoitetaan tiedostoon <code>/var/spool/cron/crontabs/&lt;username&gt;</code>, mutta eth\u00e4n muokkaa tiedostoa k\u00e4sin. Lis\u00e4\u00e4 <code>crontab -e</code> komennon avulla tiedostoon seuraava rivi:</p> Bash<pre><code>* * * * * echo \"Time is $(date)\" &gt;&gt; ~/crontesting\n</code></pre>"},{"location":"prosessit/cron/#tehtavat","title":"Teht\u00e4v\u00e4t","text":"<p>Teht\u00e4v\u00e4: Cron toimii!</p> <p>K\u00e4yt\u00e4 <code>crontab -e</code> -komentoa lis\u00e4t\u00e4ksesi ajastetun teht\u00e4v\u00e4n, joka kirjoittaa \"Cron toimii!\" -viestin tiedostoon <code>~/cronlog.txt</code> kerran minuutissa. Varmista, ett\u00e4 teht\u00e4v\u00e4 toimii tarkistamalla tiedoston sis\u00e4lt\u00f6 muutaman minuutin kuluttua.</p> <p>Teht\u00e4v\u00e4: Docker Prune scheduled</p> <p>Luo skripti bobcares: Crontab Docker Prune Command ohjetta noudattaen, joka tuhoaa yli 30 p\u00e4iv\u00e4\u00e4 vanhat kontit ja imaget.</p> <p>Huomaa kuitenkin, ett\u00e4 t\u00e4m\u00e4 vaatii hieman pohtimista. Et voi v\u00e4ltt\u00e4m\u00e4tt\u00e4 noudattaa ohjetta aivan orjallisesti, jos sinulla on Rootless Docker. Kyseinen <code>cron.daily</code> ajetaan root-k\u00e4ytt\u00e4j\u00e4ll\u00e4, joten kyseinen ohje toimii vain, </p> <ol> <li>Jos sinun Docker ajetaan roottina, voit k\u00e4ytt\u00e4\u00e4 ohjetta sellaisenaan.</li> <li>Jos sinulla on rootless Docker, k\u00e4yt\u00e4 sen sijaan sinun k\u00e4ytt\u00e4j\u00e4n omaa cronia (<code>crontab -e</code>).</li> </ol> <p>Perustele valintasi.</p>"},{"location":"prosessit/kontit/","title":"Kontit","text":"<p>T\u00e4m\u00e4 otsikko voi \u00e4kkiselt\u00e4\u00e4n tuntua aiheeseen liittym\u00e4tt\u00f6m\u00e4lt\u00e4, mutta Linux-kontit ovat tavallisia prosesseja Linux-k\u00e4ytt\u00f6j\u00e4rjestelm\u00e4ss\u00e4. Kerneli\u00e4 voi k\u00e4ytt\u00e4\u00e4 konttien runtimen\u00e4. T\u00e4h\u00e4n l\u00f6ytyy ainakin kaksi hyvinkin Linux-natiivia ratkaisua: LXC (LinuX Containers) sek\u00e4 systemd-nspawn.</p> <p>Mik\u00e4li sinulla on jossakin muussa k\u00e4ytt\u00f6j\u00e4rjestelm\u00e4ss\u00e4 (kuten Windows tai macOS) esimerkiksi Docker Desktop asennettuna, sinulla on k\u00e4yt\u00e4nn\u00f6ss\u00e4 aina my\u00f6s virtuaalikone, jossa py\u00f6rii Linux. Kontit ovat l\u00e4hes poikkeuksetta Linux-kontteja.</p>"},{"location":"prosessit/kontit/#lxc","title":"LXC","text":"<p>LXC on ainakin kirjoitushetkell\u00e4 j\u00e4\u00e4nyt pahasti Dockerin ja Podmanin jalkoihin, mutta kokeillaan sit\u00e4 siit\u00e4 huolimatta.</p> Bash<pre><code># Tarkista, ett\u00e4 lxd on asennettuna\n$\u00a0snap list lxd\n\n# Jos ei, asenna\n$ sudo snap install lxd\n\n# Initoi lxd - vastaa default vastaus kaikkeen.\n$ sudo lxd init\n\n# K\u00e4ynnist\u00e4 hitusen vanhempi Ubuntu kontissa\n$ lxc --help\n$ lxc launch ubuntu:18.04 democontainer\n\n# Tarkista ett\u00e4 se on luotu\n$ lxc list\n\n# K\u00e4ynnist\u00e4 bash\n$ lxc exec democontainer -- bash\n\n# Loggaa ulos\n$ exit\n</code></pre>"},{"location":"prosessit/kontit/#docker","title":"Docker","text":"<p>Docker sinulla on jo asennettuna, jos olet noudattanut kurssin ohjeita. Docker on todenn\u00e4k\u00f6isesti my\u00f6s ajossa siten, ett\u00e4 sit\u00e4 ajetaan rootless Dockerilla. T\u00e4m\u00e4 tarkoittaa, ett\u00e4 Dockerin kontit ajetaan sinun k\u00e4ytt\u00e4j\u00e4n oikeuksilla, eiv\u00e4tk\u00e4 ne voi vaikuttaa toisiinsa. </p>"},{"location":"prosessit/kontit/#tehtavat","title":"Teht\u00e4v\u00e4t","text":"<p>Teht\u00e4v\u00e4: Docker ps</p> <p>Avaa ylim\u00e4\u00e4r\u00e4inen terminaali ja avaa siin\u00e4 interaktiivinen kontti, jonka j\u00e4t\u00e4t k\u00e4yntiin:</p> Bash<pre><code>$ docker run -it --rm python:3 python -m http.server 8080\n</code></pre> <p>T\u00e4m\u00e4n j\u00e4lkeen avaa toinen terminaali-ikkuna ja pyri tutkimaan, miss\u00e4 kontti n\u00e4kyy sinun prosesseissasi. Voit etsi\u00e4 sit\u00e4 esimerkiksi melko uniikilla <code>http.server</code>-merkkijonolla. Kenties <code>ps aux | grep http.server</code> voisi toimia? Toinen vaihtoehto on kysy\u00e4 Dockerilta itsels\u00e4\u00e4n, esimerkiksi n\u00e4in:</p> Bash<pre><code>$ docker ps\nCONTAINER ID   IMAGE         COMMAND\n123afffff      python:3      \"python -m http.server 8080\"\n\n$ docker inspect 123afffff | grep -i pid\n        \"Pid\": 9348,\n        \"PidMode\": \"\",\n        \"PidsLimit\": null,\n\n$ ps -fp 9348\nUID       PID    PPID  C STIME TTY          TIME CMD\nuser      9348   9321  0 15:09 pts/0    00:00:00 python -m http.server 8080\n\n$ pstree 9321\ncontainerd-shim\u2500\u252c\u2500python\n            \u2514\u250011*[{containerd-shim}]\n\n$ lsns -p 9348\n        NS TYPE   NPROCS   PID USER      COMMAND\n4026531834 time      109  2853 user rootlesskit --state-dir=/run/user/1000/\n4026533041 user        6  2901 user \u2514\u2500/proc/self/exe --state-dir=/run/user/\n4026532976 mnt         1  9348 user python -m http.server 8080\n4026532977 uts         1  9348 user python -m http.server 8080\n4026532979 ipc         1  9348 user python -m http.server 8080\n4026532980 pid         1  9348 user python -m http.server 8080\n4026532981 cgroup      1  9348 user python -m http.server 8080\n4026532982 net         1  9348 user python -m http.server 8080\n</code></pre> <p>Huomaa, ett\u00e4 prosessi on tavallinen prosessi muiden joukossa, jota ajetaan sinun oikeuksin, mutta:</p> <ol> <li>Sit\u00e4 ajetaan <code>containerd-shim</code>:n lapsena, joka on Dockerin k\u00e4ytt\u00e4m\u00e4 prosessi, joka huolehtii konttien ajamisesta. <code>containerd</code> luo kutakin konttia varten oman <code>containerd-shim</code>-prosessin, joka huolehtii kontista ja sen elinkaaren hallinnasta.</li> <li>Kontitettu prosessi on eristyksiss\u00e4 muista prosesseista, koska se ajetaan omassa prosessiavaruudessaan (namespace) ja resurssirajoituksessaan (cgroup).</li> </ol> <p>Huomaa, ett\u00e4 kontin sis\u00e4ll\u00e4 PID on <code>1</code>, mutta is\u00e4nt\u00e4j\u00e4rjestelm\u00e4ss\u00e4 se on <code>9348</code> (tai mik\u00e4 se sinulla ikin\u00e4 onkaan).</p> <p>Jos olet kyberturvallisuudesta kiinnostunut, voit tutustua Docker Engine security -sivustoon. Voit my\u00f6s lukea lis\u00e4\u00e4 namespaces/groups ominaisuuksista esimerkiksi <code>man namespaces</code>- ja <code>man cgroups</code>-komentojen avulla. Kenties haluat my\u00f6s tutustua siihen, kuinka docker client, dockerd, containerd, containerd-shim ja runc toimivat yhdess\u00e4 esimerkiksi containerd vs. Docker: Understanding Their Relationship and How They Work Together-blogipostauksen avulla.</p> <p>Jos et olet kiinnostunut, tai haluat sys\u00e4t\u00e4 t\u00e4m\u00e4n teht\u00e4v\u00e4n my\u00f6hemm\u00e4ksi, voit kuitata t\u00e4m\u00e4n teht\u00e4v\u00e4n suoritetuksi, kunhan olet saanut onnistuneesti ajettua kontin ja l\u00f6yt\u00e4nyt sen prosessin ID:n lokaalista j\u00e4rjestelm\u00e4st\u00e4si.</p>"},{"location":"prosessit/lokit/","title":"Lokit","text":"<p>Linuxissa on kattavat lokit l\u00e4hes kaikesta tapahtuneesta, mik\u00e4 mahdollistaa vianselvityksen. Lokitiedostot ovat yleens\u00e4 <code>/var/log</code>-hakemistossa. T\u00e4ss\u00e4 luvussa k\u00e4ymme l\u00e4pi, miten voit lukea lokitiedostoja ja miten voit seurata prosessien lokitapahtumia.</p>"},{"location":"prosessit/lokit/#lokit_1","title":"Lokit","text":""},{"location":"prosessit/lokit/#lokiin-kasin-kirjoittaminen-ja-sen-lukeminen","title":"Lokiin k\u00e4sin kirjoittaminen ja sen lukeminen","text":"Bash<pre><code># Kirjoita merkkijono system logiin\n$ logger \"T\u00e4m\u00e4 on testi\"\n\n# K\u00e4y lukemassa systemd journalia - olettaen ett\u00e4 k\u00e4yt\u00f6ss\u00e4 on systemd-journald\njournalctl --since \"5 minutes ago\"\n</code></pre>"},{"location":"prosessit/lokit/#systemd-journald","title":"Systemd-journald","text":"<p>Teoriassa kukin Linux-distribuutio voi k\u00e4ytt\u00e4\u00e4 omaa lokij\u00e4rjestelm\u00e4\u00e4ns\u00e4, mutta k\u00e4yt\u00e4nn\u00f6ss\u00e4 suurin osa k\u00e4ytt\u00e4\u00e4 <code>systemd-journald</code>-j\u00e4rjestelm\u00e4\u00e4 ja/tai <code>rsyslogd</code>-j\u00e4rjestelm\u00e4\u00e4.</p> <p>Perinteinen Linuxin lokij\u00e4rjestelm\u00e4 on <code>syslog</code>, mutta systemd on tuonut mukanaan oman journalinsa. <code>systemd-journald</code> on j\u00e4rjestelm\u00e4palvelu, joka ker\u00e4\u00e4 ja tallentaa lokitietoja. Se luo ja yll\u00e4pit\u00e4\u00e4 strukturoituja, indeksoituja lokia, jotka perustuvat lokitietoon, joka on saatu monista eri l\u00e4hteist\u00e4. N\u00e4m\u00e4 l\u00e4hteet listataan sivulla <code>man 8 systemd-journald</code>. Distribuutiosta riippuen sinulla voi olla joko pelk\u00e4st\u00e4\u00e4n <code>systemd-journald</code> tai lis\u00e4ksi my\u00f6s <code>rsyslogd</code>. Esimerkiksi Ubuntussa komennolla <code>sudo systemctl list-units *log*</code> l\u00f6ytyy kummatkin.</p> <pre><code>* Kernel log messages, via kmsg\n* Simple system log messages, via the libc syslog(3) call\n* Structured system log messages via the native Journal API, see sd_journal_print(3) and Native Journal Protocol[1]\n* Standard output and standard error of service units. For further details see below.\n* Audit records, originating from the kernel audit subsystem\n</code></pre> <p>Systemd:n journalia luetaan komennolla <code>journalctl</code> (<code>/usr/bin/journalctl</code>). </p> <p>Tip</p> <p>T\u00e4t\u00e4 service\u00e4, kuten yleens\u00e4 muitakin, voi konfiguroida tiedostojen avulla, jotka sijaitsevat <code>/etc</code>-hakemiston alaisuudessa. Tarkempi ohjeistus l\u00f6ytyy <code>man 8 journalctl</code>-sivulta.</p>"},{"location":"prosessit/lokit/#rsyslogd","title":"Rsyslogd","text":"<p>Kuten yll\u00e4 mainittiin, sinulla saattaa olla <code>systemd-journald</code>:n kyljess\u00e4 tai tilalla <code>rsyslodg</code>. T\u00e4st\u00e4 l\u00f6yd\u00e4t lis\u00e4tietoa <code>man rsyslogd</code>.</p> <p>Tip</p> <p>K\u00e4y kurkkaamassa <code>man rsyslogd</code>:ssa mainittua konfiguraatiotiedostoa <code>/etc/rsyslog.conf</code> ja <code>/etc/rsyslog.d/</code>-hakemistoa.</p> <p>Tip</p> <p>Rsyslog ja muut lokeja kirjoittavat sovellukset luovat lokinsa yleens\u00e4 <code>/var/log</code>-hakemistoon. Kokeile listata kaikki kyseisen hakemiston tiedostot ja kansiot, joissa ei ole numeroita, ja n\u00e4et mit\u00e4 kaikkea siell\u00e4 on. Alla on komento t\u00e4t\u00e4 varten.</p> Bash<pre><code>$ ls -1F --group-directories-first /var/log | grep -v '[0-9]'\n</code></pre> <p>Vertaa n\u00e4it\u00e4 tiedostoja ja kansioita rsyslog.conf-tiedostossa listattuihin tiedostoihin.</p> <p>Huomaat, ett\u00e4 tyypillisi\u00e4 tiedostoja ovat esimerkiksi:</p> <ul> <li><code>auth.log</code> - k\u00e4ytt\u00e4j\u00e4n kirjautumiset</li> <li><code>syslog</code> - j\u00e4rjestelm\u00e4n lokit</li> <li><code>dmesg</code> - kernel ring buffer</li> </ul> <p>Bin\u00e4\u00e4rimuotoiset tiedostot eiv\u00e4t ole suoraan luettavissa, mutta niit\u00e4 voi lukea komennolla <code>dmesg</code> tai <code>journalctl</code>.</p>"},{"location":"prosessit/lokit/#keskitetty-lokitus","title":"Keskitetty lokitus","text":"<p>Keskitetty lokitus tarkoittaa, ett\u00e4 lokitiedostot ker\u00e4t\u00e4\u00e4n yhteen paikkaan. T\u00e4m\u00e4 on hy\u00f6dyllist\u00e4, jos sinulla on useita palvelimia, joista haluat ker\u00e4t\u00e4 lokit yhteen paikkaan. T\u00e4m\u00e4 onnistuu esimerkiksi <code>rsyslog</code>:n avulla. N\u00e4m\u00e4 asetukset s\u00e4\u00e4det\u00e4\u00e4n <code>rsyslog.conf</code>-tiedostossa tai drop-in -tiedostoissa <code>/etc/rsyslog.d/</code>-hakemistossa.</p> <p>L\u00e4hett\u00e4v\u00e4n koneen konfiguraatio, joka neuvotaan Rsyslog: Sending Messages to a Remote Syslog Server-ohjeessa, voisi olla:</p> Bash<pre><code># This could be in this file, for example:\n# /etc/rsyslog.d/99-forward.conf\n*.* @somehost.example.com:514\n# or like this:\n*.* action(type=\"omfwd\" target=\"somehost.example.com\" port=\"514\" protocol=\"tcp\")\n</code></pre> <p>K\u00e4y katsomassa vastaanottavan koneen konfiguraatio, joka neuvotaan Rsyslog: Receiving Messages from a Remote System-ohjeessa.</p> <p>Lokien keskitt\u00e4misen voi hoitaa my\u00f6s muilla avoimen l\u00e4hdekoodin ratkaisuilla tai kaupallisilla ratkaisuilla. Lis\u00e4ksi eri pilvipalveluntarjoajat tarjoavat omia ratkaisujaan. N\u00e4iden k\u00e4sittely on t\u00e4m\u00e4n kurssin skoopin ulkopuolella.</p>"},{"location":"prosessit/lokit/#tehtavat","title":"Teht\u00e4v\u00e4t","text":"<p>Teht\u00e4v\u00e4: Kirjoita oma lokimerkint\u00e4</p> <p>K\u00e4yt\u00e4 <code>logger</code>-komentoa kirjoittaaksesi oman testiviestisi j\u00e4rjestelm\u00e4lokeihin. Tarkista sitten, ett\u00e4 viesti on tallentunut oikein k\u00e4ytt\u00e4m\u00e4ll\u00e4 <code>journalctl --since \"5 minutes ago\"</code> -komentoa.</p> <p>Teht\u00e4v\u00e4: Tarkista palvelun lokit</p> <p>Selvit\u00e4, miten voit tarkastella tietyn palvelun (esim. <code>cron</code> tai <code>sshd</code>) lokeja <code>journalctl</code>-komennolla. Vihje: K\u00e4yt\u00e4 <code>-u</code>-valitsinta ja tutki, mit\u00e4 tietoa saat irti esimerkiksi komennolla <code>journalctl -u cron --no-pager | tail -n 10</code>.</p> <p>Teht\u00e4v\u00e4: Todista tietyn palvelun event</p> <p>Tee tarkoituksella jotakin, mink\u00e4 saat n\u00e4kym\u00e4\u00e4n lokissa, ja joka on monimutkaisempi event kuin <code>logger &lt;viesti&gt;</code> tai <code>cron</code>-palvelun tuloste. Huomaa, ett\u00e4 etsi service, joka on vastuussa tapahtumasta, eli siis k\u00e4yt\u00e4 lopulta komentoa:</p> Bash<pre><code>$ journalctl -f -u name-of-the-service\n</code></pre> <p>Mink\u00e4 servicen lokeissa mahtaa n\u00e4ky\u00e4, jos t\u00f6kk\u00e4\u00e4t USB-muistitikun koneeseen?</p> <p>Mink\u00e4 servicen lokeissa mahtaa n\u00e4ky\u00e4, jos ajat komennon <code>ssh localhost</code>?</p> <p>Etsi jokin t\u00e4llainen event, selvit\u00e4 mik\u00e4 service on vastuussa siit\u00e4, ja k\u00e4yt\u00e4 <code>journalctl -f -u &lt;service&gt;</code>-komentoa n\u00e4hd\u00e4ksesi, mit\u00e4 lokitietoja tulee n\u00e4kyviin.</p> <p>Tip</p> <p>Jos olet ep\u00e4varma, mink\u00e4 servicen piiriin tietty tapahtuma kuuluu, voit k\u00e4ytt\u00e4\u00e4 <code>journalctl -f</code>-komentoa ilman <code>-u</code> optionia. Outputissa n\u00e4kyy kaikkien servicejen eventit, joten siit\u00e4 tunnistat helposti mik\u00e4 service \u00e4l\u00e4ht\u00e4\u00e4, kun teet jotakin, mik\u00e4 n\u00e4kyy varmana lokeissa! Rivi on syntaksiltaan jotakuinkin:</p> <pre><code>&lt;timestamp&gt; &lt;hostname&gt; &lt;service&gt;: &lt;message&gt;\n</code></pre>"},{"location":"prosessit/prosessit/","title":"Prosessit","text":"<p>Linuxin kerneli luo jokaiselle k\u00e4ynnistetylle ohjelmalle oman prosessin, ja jokaisella prosessilla on oma tunniste (PID, Process ID). Ohjelma voi olla ajossa etualalla tai taustalla. Linuxissa on <code>init process</code>, joka k\u00e4ynnist\u00e4\u00e4 kaikki muut prosessit. Kaksi init-prosessia ovat:</p> <ul> <li>SysVinit (ja yhteensopivat init-j\u00e4rjestelm\u00e4t kuten Upstart)</li> <li>Systemd (uusi korvaaja)</li> </ul>"},{"location":"prosessit/prosessit/#komennot","title":"Komennot","text":"<p>K\u00e4yt\u00e4t useimmiten prosessien seurantaan seuraavia komentoja:</p> <ul> <li>ps</li> <li>pstree</li> <li>top</li> </ul>"},{"location":"prosessit/prosessit/#ps-ja-pstree","title":"Ps ja pstree","text":"<p>K\u00e4ytt\u00e4m\u00e4si shell, kuten GNU bash, on yksi monista ohjelmista, jonka voi k\u00e4ynnist\u00e4\u00e4, ja siten se saa oman PID:n. Ymp\u00e4rist\u00f6muuttuja <code>$0</code> sis\u00e4lt\u00e4\u00e4 ohjelman nimen, kun taas <code>$$</code> sis\u00e4lt\u00e4\u00e4 ohjelman PID:n. Tutki alla olevaa koodia ajatuksella:</p> Bash<pre><code>Last login: Fri Sep 15 09:10:36 on ttys005\n$ echo $0\n-zsh        # T\u00e4m\u00e4n k\u00e4ytt\u00e4j\u00e4n login shell ei olekaan bash vaan zsh\n\n$ echo $$\n18039       # Kyseisen shell-instanssin PID on t\u00e4m\u00e4\n\n$ bash\n$ echo $0\nbash        # Bash-komento k\u00e4ynnisti bash-prosessin nykyisess\u00e4 terminaalissa\n\n$echo $$\n18196       # T\u00e4m\u00e4n bash shell -instanssin PID on eri kuin zsh:n\n\n$ pstree 18039\n-+= 18039 opettaja -zsh\n \\-+= 18196 opettaja bash\n   \\-+= 18546 opettaja pstree 18039\n     \\--- 18547 root ps -axwwo user,pid,ppid,pgid,command\n\n$ echo $$\n18196       # Bash shell -instanssin PID on yh\u00e4 sama kuin aiemmin\n\n$ exit\n$ echo $$\n18039       # My\u00f6s Z Shellin PID on pysynyt samana.\n</code></pre> <p>Yll\u00e4 ajettu pstree paljastaa, ett\u00e4 Z Shelli on parent process k\u00e4ynnist\u00e4m\u00e4llemme GNU Bash prosessille. Juuri ajettu <code>pstree</code>-komento sen sijaan on t\u00e4m\u00e4n prosessin child. Komento <code>pstree</code> on sis\u00e4isesti k\u00e4ynnist\u00e4nyt prosessin <code>ps</code>. Kun n\u00e4iden ohjelmien suorittaminen loppui, terminaaliin tuli takaisin aiemmin ajamamme <code>bash</code>-ohjelman prompt. PID:t <code>pstree (18039)</code> sek\u00e4 <code>ps (18547)</code> ovat terminoituja, koska niiden suoritus on jo loppunut.</p> <p>Kokeillaan ajaa sama komento, mink\u00e4 pstree ajoi sis\u00e4isesti. Jos haluat hieman lyhent\u00e4\u00e4 command-sarakkeen sis\u00e4lt\u00f6\u00e4, korvaa <code>command</code>-sana argumentista sanalla <code>comm</code>.</p> Bash<pre><code># Aja t\u00e4ysin sama komento\n$ sudo ps -axwwo user,pid,ppid,pgid,command\nroot                 1     0     1 /sbin/launchd\nroot                88     1    88 /usr/libexec/logd\nroot                89     1    89 /usr/libexec/smd\n...\n</code></pre> <p>Tutustu <code>ps</code>-komentoon <code>man</code>:n tai netist\u00e4 l\u00f6ytyvien esimerkkien avulla. Selvit\u00e4 muun muassa, mit\u00e4 alla olevat komennot tekev\u00e4t. Huomaa, ett\u00e4 komento tukee kolmenlaista syntaksia optioneille: UNIX, BSD ja GNU. Jos kokeilet samaa komentoa macOS:lla, huomaat, ett\u00e4 vain osa samoista optioneista toimii edes sinne p\u00e4in samalla tavalla.</p> Bash<pre><code># Mit\u00e4 t\u00e4m\u00e4 tekee?\n$ ps -u $(whoami) | grep python\n\n# Ent\u00e4 t\u00e4m\u00e4?\n$ ps -o ppid= -p 1\n\n# Mites t\u00e4m\u00e4?\n$ ps -x -o pid,user,%mem,%cpu,comm\n</code></pre>"},{"location":"prosessit/prosessit/#top","title":"top","text":"<p>Windowsista tutun teht\u00e4vienhallinnan (task manager) tai macOS:st\u00e4 tutun Activity Monitorin kaltaiset tiedot saa shelliss\u00e4 esiin komennolla <code>top</code>. Kyseinen komento n\u00e4ytt\u00e4\u00e4 j\u00e4rjestetyn eli sortatun listan j\u00e4rjestelm\u00e4n prosesseista. Sorttaukseen k\u00e4ytetty\u00e4 saraketta voi vaihtaa parametreill\u00e4 tai pikan\u00e4pp\u00e4imill\u00e4.</p> Bash<pre><code>$ top -o mem   # J\u00e4rjest\u00e4 muistink\u00e4yt\u00f6n mukaan laskevasti\n</code></pre> <p>Tutustu komentoon <code>man</code>-komennon avulla.</p> <p>Tutki my\u00f6s, l\u00f6ytyyk\u00f6 k\u00e4ytt\u00e4m\u00e4st\u00e4si ty\u00f6p\u00f6yt\u00e4ymp\u00e4rist\u00f6st\u00e4si (esim. GNOME) vastaava graafinen sovellus kuten System Monitor.</p>"},{"location":"prosessit/prosessit/#jumiutuneiden-ohjelmien-tappaminen","title":"Jumiutuneiden ohjelmien tappaminen","text":"<p>Mik\u00e4li jokin ohjelma on auttamattomasti jumissa, voit viime k\u00e4dess\u00e4 tappaa sen aina <code>kill -9 pid</code>-komennolla. Option <code>-9</code> on signaalille <code>KILL</code> annettu numero. </p> <p>Tip</p> <p>Kaikki kill-signaalit ja niiden numerot saat esille ajamalla <code>kill -l</code>. Mik\u00e4li output on yhdell\u00e4 rivill\u00e4 v\u00e4lily\u00f6nnill\u00e4 erotettuna, muista, ett\u00e4 voit putkittaa tulosteen toiselle ohjelmistolle. Kokeile ensin korvata v\u00e4lily\u00f6nnit rivinvaihdoilla, ja t\u00e4m\u00e4n j\u00e4lkeen lis\u00e4\u00e4 rivinumerot.</p> <p>Alla on joitakin poimintoja lyhyine selityksineen:</p> # Signaali Selitys 1 HUP Hang up. Aikoinaan t\u00e4ll\u00e4 ly\u00f6tiin \"luuri korvaan\" modeemissa. Nykyisin t\u00e4ll\u00e4 voidaan esimerkiksi pakottaa daemon lataamaan konfiguraatiotiedostot uusiksi. 2 INT Interrupt. Sama kuin Ctrl+C. Ohjelmaa pyydet\u00e4\u00e4n sulkeutumaan n\u00e4tisti. 9 KILL Kill. Ohjelmalta ei pyydet\u00e4 mit\u00e4\u00e4n eik\u00e4 ohjelma t\u00e4ten voi j\u00e4tt\u00e4\u00e4 t\u00e4t\u00e4 tekem\u00e4tt\u00e4. Kernel lopettaa prosessin ajon ja poistaa sen muistista. 15 TERM Terminate. Komennon <code>kill</code> default. Ohjelmaa pyydet\u00e4\u00e4n sulkemaan itsens\u00e4. 19 STOP Stop. Ohjelmaa pyydet\u00e4\u00e4n pys\u00e4htym\u00e4\u00e4n. Sama kuin Ctrl+Z. <p>Tyypillisesti <code>kill</code>-komentoa ei pit\u00e4isi tarvita laisinkaan. Jos sit\u00e4 kuitenkin tarvitsee, kokeile ensin <code>TERM</code>:n avulla eli <code>kill pid</code> eli <code>kill -15 pid</code>. Mik\u00e4li ohjelma ei n\u00e4yt\u00e4 sammutan, aja per\u00e4\u00e4n <code>kill -9 pid</code>.</p> Bash<pre><code># Luo prosessi, joka nukkuu 24h\n$ sleep $((60 * 60 * 24))\n\n###############################################\n# Avaa toinen pseudo- tai virtuaaliterminaali #\n###############################################\n\n$ ps\nPID   TTY           TIME CMD\n26967 ttys008    0:01.32 /bin/zsh\n29527 ttys008    0:00.00 sleep 86400    # &lt;= T\u00e4m\u00e4\n...\n\n$ kill -TERM 29527\n# tai kill -15 29527\n\n###########################################\n# Mene takaisin ensimm\u00e4iseen terminaaliin #\n# #########################################\n\n[1]    29527 terminated  sleep $((60 * 60 * 24))\n</code></pre>"},{"location":"prosessit/prosessit/#tausta-ajo","title":"Tausta-ajo","text":"<p>Ohjelmia voi ajaa my\u00f6s taustalla p\u00e4\u00e4tt\u00e4m\u00e4ll\u00e4 komentiriviin <code>&amp;</code>-merkkiin. Ohjelma siirtyy tausta-ajoon my\u00f6s siten, ett\u00e4 etualalla ajettavan ohjelman kohdalla painetaan Ctrl+Z (<code>SIGTSTP</code>). Tosin t\u00e4m\u00e4 pys\u00e4ytt\u00e4\u00e4 ohjelman ajon. Ohjelman saa takaisin etualalle komennolla <code>fg</code>, tai <code>fg %n</code>, jossa <code>n</code> on se hakasuluissa n\u00e4ytetty numero eli <code>JOB_SPEC</code>, joka on useimmiten <code>[1]</code>. Vaihtoehtoisesti ohjelman voi laittaa k\u00e4yntiin Ctrl+Z painamisen j\u00e4lkeen komennolla <code>bg %n</code>, jossa <code>n</code> on yh\u00e4 <code>JOB_SPEC</code></p> Bash<pre><code>$ sleep $((60 * 60 * 24)) &amp;\n$ sleep $((60 * 60 * 24)) &amp;\n$ sleep $((60 * 60 * 24)) &amp;\n$ sleep $((60 * 60 * 24)) &amp;\n\n$ jobs -l   # -l listaa my\u00f6s PID:t\n[1]    71338 running    sleep $((60 * 60 * 24))\n[2]    71344 running    sleep $((60 * 60 * 24))\n[3]  - 71350 running    sleep $((60 * 60 * 24))\n[4]  + 71435 running    sleep $((60 * 60 * 24))\n\n$ kill %4  # JOB_SPEC-numeroon voi viitata %n:ll\u00e4\n[4]  + 71435 terminated  sleep $((60 * 60 * 24))\n\n$ jobs\n[1]    running    sleep $((60 * 60 * 24))\n[2]  - running    sleep $((60 * 60 * 24))\n[3]  + running    sleep $((60 * 60 * 24))\n</code></pre> <p>Huomaa, ett\u00e4 jos nyt loggaat ulos tai suljet shellin (<code>exit</code>), niin kyseiset prosessit p\u00e4\u00e4ttyv\u00e4t v\u00e4litt\u00f6m\u00e4sti. Tuoreimman jobin rivill\u00e4 on <code>+</code>-merkki, joka viittaa siihen, ett\u00e4 ilman parametrej\u00e4 annettu komento (kuten <code>fg</code>) viittaa kyseiseen jobiin.</p> Bash<pre><code>$ fg\n[3]  - 71350 running    sleep $((60 * 60 * 24))\n\n# PAINA CTRL + Z\n[3]  + 71350 suspended  sleep $((60 * 60 * 24))\n\n$ bg %3\n[3]  - 71350 continued  sleep $((60 * 60 * 24))\n\n$ jobs\n[1]    running    sleep $((60 * 60 * 24))\n[2]  - running    sleep $((60 * 60 * 24))\n[3]  + running    sleep $((60 * 60 * 24))\n\n$ kill %1 %2 %3\n[1]    71338 terminated  sleep $((60 * 60 * 24))\n[3]  + 71350 terminated  sleep $((60 * 60 * 24))\n[2]  + 71344 terminated  sleep $((60 * 60 * 24))\n</code></pre> <p>Jos on tarve ajaa ohjelma siten, ett\u00e4 se ei sammu terminaalin sulkeutumisen yhteydess\u00e4 tai logoutin yhteydess\u00e4, niin komento <code>nohup</code> on avuksi. Ajetaan vanha tuttu <code>sleep</code> uusiksi, mutta ohjataan stdout bittiavaruuteen ja stderr tiedostoon <code>errors.log</code>. </p> Bash<pre><code>$ nohup sleep $((60 * 60 * 24)) &gt; /dev/null 2&gt; errors.log &amp;\n[1] 71645\n\n$ jobs\n[1]  + running    nohup sleep $((60 * 60 * 24)) &gt; /dev/null 2&gt; errors.log\n\n#######################################\n# Uudelleenk\u00e4ynnist\u00e4 pseudoterminaali #\n#######################################\n\n$ jobs\n# Ei tulosta mit\u00e4\u00e4n\n\n$ ps 71645\nPID     TT  STAT      TIME COMMAND\n71645   ??  SN     0:00.01 sleep 86400\n\n$ kill 71645\n$ rm errors.log\n</code></pre> <p>Kysymys</p> <p>Selvit\u00e4, mit\u00e4 <code>disown</code>-komento tekee. Tarkista jonkin jobin id. Jos id on <code>1</code>, aja <code>disown %1</code>. </p> <p>Vihje: Komento liittyy toiminnallisesti <code>nohup</code>-komentoon.</p>"},{"location":"prosessit/prosessit/#avoimien-tiedostojen-etsiminen","title":"Avoimien tiedostojen etsiminen","text":"<p>Mik\u00e4li haluat saada tiet\u00e4\u00e4, mik\u00e4 ohjelmaa lukee tai kirjoittaa paraikaa johonkin tiedostoon, t\u00e4h\u00e4n auttaa komento <code>lsof</code>. FD-kent\u00e4ss\u00e4 olevat numerot viittaavat \"Descriptor ID\":hen, joista 0 on standard input, 1 on standard output ja 2 on standard error. Numeroa 2 suuremmat ovat ohjelmien itsens\u00e4 avaamia uusia descriptoreita (esimerkiksi <code>open()</code>-funktion puolesta.)</p> Bash<pre><code>$ echo \"Miau\" &gt; kissa.txt\n$ tail -f kissa.txt &amp;\n[1] 71967\nMiau\n\n$ jobs\n[1]  + running    tail -f kissa.txt\n\n$ lsof | grep kissa.txt\ntail      71967  janisou1  3r  /Users/opettaja/kissa.txt # Lyhennetty\n\n$ echo \"MIAW\" &gt; kissa.tx\nMIAW   # Huomaathan, ett\u00e4 bg ei est\u00e4 ohjelmaa tulostamasta stdouttia tty:iin\n\n$ kill %1\n$ rm kissa.txt\n</code></pre>"},{"location":"prosessit/prosessit/#tehtavat","title":"Teht\u00e4v\u00e4t","text":"<p>Teht\u00e4v\u00e4: Selvit\u00e4 oman shellisi PID</p> <p>K\u00e4yt\u00e4 <code>echo $$</code> -komentoa selvitt\u00e4\u00e4ksesi, mik\u00e4 on oman k\u00e4ynniss\u00e4 olevan komentotulkintasi prosessitunniste (PID).</p> <p>Teht\u00e4v\u00e4: K\u00e4ynnist\u00e4 ja pys\u00e4yt\u00e4 prosessi taustalla</p> <p>Aja ohjelma taustalla k\u00e4ytt\u00e4en <code>&amp;</code>-merkki\u00e4, tarkista sen tila <code>jobs</code>-komennolla ja tuo se takaisin etualalle <code>fg</code>-komennolla.</p> <p>Teht\u00e4v\u00e4: Tapa prosessi siististi ja v\u00e4kisin</p> <p>K\u00e4ynnist\u00e4 pitk\u00e4kestoinen prosessi (esim. <code>sleep 600</code>) ja yrit\u00e4 ensin pys\u00e4ytt\u00e4\u00e4 se <code>kill -TERM &lt;pid&gt;</code> -komennolla. Jos se ei lopu, pakota lopetus <code>kill -9 &lt;pid&gt;</code> -komennolla.</p>"},{"location":"prosessit/systemd/","title":"Systemd","text":"<p>Systemd on Linux-j\u00e4rjestelmien init-prosessi, joka on korvannut sen edelt\u00e4j\u00e4ns\u00e4 (ks. Upstart: init(8) - Linux man page). Systemd on ensimm\u00e4inen prosessi, joka k\u00e4ynnistet\u00e4\u00e4n (kernelin j\u00e4lkeen) ja se on vastuussa muiden prosessien k\u00e4ynnist\u00e4misest\u00e4 ja hallinnasta. N\u00e4m\u00e4 asiat, joita se k\u00e4ynnist\u00e4\u00e4, tunnetaan termill\u00e4 unit. Systemd reagoi eri triggeri-tapahtumiin ja on t\u00e4ten event-driven. Tyypillisten deamon-prosessien hallinnan lis\u00e4ksi sill\u00e4 voi hallita my\u00f6s muiden muassa mountteja ja laitteita. Tutustu systemd:n kontrollerin toimintaan joko kirjoittamalla <code>man 1 systemd</code> tai online-version avulla: Ubuntu Manpages: systemctl - Control the systemd system and service manager</p> Bash<pre><code># Tarkista kaikki saatavilla olevat komennot\n$ systemctl --help\n\n# Listaa unit-tyypit\n$ systemctl -t help\n</code></pre> <p>Unit m\u00e4\u00e4ritell\u00e4\u00e4n konfiguraatiotiedostossa, ja n\u00e4it\u00e4 sijaitsee useissa eri lokaatioissa:</p> <ol> <li><code>/etc/systemd/system/</code> - System-wide, admin-created</li> <li><code>/run/systemd/system/</code> - System-wide, runtime (dynaamiset, luodaan Linuxin ollessa ajossa)</li> <li><code>[/usr]/lib/systemd/system/</code> - System-wide, package-created (apt, dnf, pacman, yms.)</li> <li><code>/home/$USER/.config/systemd/user/</code> - Per-user, user-created</li> <li>ks. lis\u00e4\u00e4 ajamalla komento <code>man 5 systemd.unit</code></li> </ol> <p></p> <p>Kuvio 1: Systemd DALL-E 3:n n\u00e4kemyksen\u00e4.</p>"},{"location":"prosessit/systemd/#peruskaytto","title":"Perusk\u00e4ytt\u00f6","text":"<p>Tyypillisesti Linux-k\u00e4ytt\u00e4j\u00e4n ei v\u00e4ltt\u00e4m\u00e4tt\u00e4 tarvitse luoda omia Unit-tiedostoja vaan paketinhallintaohjelmisto (apt, dnf, pacman, yms.) luo ne ohjelmaa asentaessa. On t\u00e4rke\u00e4\u00e4 osata kuitenkin perusk\u00e4ytt\u00f6, eli daemonin k\u00e4ynnist\u00e4minen, pys\u00e4ytt\u00e4minen, uudelleenk\u00e4ynnist\u00e4minen, statuksen tarkistaminen ja lokien seuranta.</p> Bash<pre><code># Listaa kaikki daemon/service-tyyliset unitit\n$ systemctl list-units --type=service\n\n# Etsi hakusanalla (currently in memory)\n$ systemctl list-units \"*armor*\"\n\n# Etsi hakusanalla (tiedostot, ei v\u00e4ltt\u00e4m\u00e4tt\u00e4 ajossa)\n$ systemctl list-unit-files --type=service \"*bolt*\"\n</code></pre>"},{"location":"prosessit/systemd/#asennetaan-uusi","title":"Asennetaan uusi","text":"<p>Asennetaan nginx-palvelin, jotta meill\u00e4 on jotain, mit\u00e4 k\u00e4ynnistell\u00e4 ja pys\u00e4ytell\u00e4.</p> Bash<pre><code># Asenna nginx\n$ sudo apt update\n$ sudo apt install nginx\n\n# Etsi, mit\u00e4 kaikkea asentui\n$ systemctl list-units \"*nginx*\"\n\n# Voit k\u00e4ytt\u00e4\u00e4 t\u00e4h\u00e4n my\u00f6s paketinhallintaa\n$ dpkg -L nginx-common | grep systemd\n\n# Tarkista, onko se k\u00e4ynniss\u00e4\n$ systemctl status nginx\n\n# Huomaa, ett\u00e4 seuraavat kaksi komentoa tekev\u00e4t saman asian\n$ systemctl cat nginx\n$ cat /lib/systemd/system/nginx.service\n\n# Tarkista sen status\n$ systemctl status nginx\n</code></pre> <p>Kokeile pys\u00e4ytt\u00e4\u00e4 ja k\u00e4ynnist\u00e4\u00e4 nginx:</p> Bash<pre><code># Pys\u00e4yt\u00e4 ja tarkista vastaako portti 80\n$ sudo systemctl stop nginx\n$ curl localhost\n\n# K\u00e4ynnist\u00e4 ja tarkista vastaako portti 80\n$ sudo systemctl start nginx\n$ curl localhost\n</code></pre> <p>Tip</p> <p>Ohjelmalla on erikseen status \"started/stopped\" ja \"enabled/disabled\". Ohjelman pys\u00e4ytys stop-komennolla ei siis est\u00e4 ohjelmaa k\u00e4ynnistym\u00e4st\u00e4 ensi bootissa! Sinun pit\u00e4\u00e4 erikseen asettaa <code>sudo systemctl disable &lt;service&gt;</code>.</p>"},{"location":"prosessit/systemd/#muokataan-oletussivua","title":"Muokataan oletussivua","text":"<p>Komento <code>curl localhost</code> palauttaa nginx:n oletussivun. Tutkitaan, mist\u00e4 se l\u00f6ytyy ja muokataan sit\u00e4.</p> Bash<pre><code># Optional: Kaiva ilman dokumentaatiota tai ohjeistusta, ett\u00e4\n#   miss\u00e4 nginx:n konfiguraatiotiedostot sijaitsevat. T\u00e4ss\u00e4 auttavat ainakin\n#   alla olevat komennot:\n$ dpkg -L nginx-common | grep conf\n$ sudo nginx -T | grep \"configuration file\"\n$ less /etc/nginx/nginx.conf\n$ less /etc/nginx/sites-enabled/default\n\n# Vaihda sana \"Welcome\" sanaksi \"Tervetuloa\"\n$ sudo sed -i 's/Welcome/Tervetuloa/' /var/www/html/index.nginx-debian.html\n\n# Kokeile p\u00e4ivittyik\u00f6 sivu\n$ curl localhost\n</code></pre>"},{"location":"prosessit/systemd/#service-tiedoston-muokkaus","title":"Service-tiedoston muokkaus","text":"<p>Service-tiedostot m\u00e4\u00e4rittelev\u00e4t, miten ohjelma k\u00e4ynnistet\u00e4\u00e4n. Tiedostojen muokkaus suoraan tekstieditorilla ei ole suositeltavaa. Luo mieluummin uudet drop-in -tiedostot, joissa m\u00e4\u00e4rittelet uudet asetukset.</p> Bash<pre><code># Luo uusi drop-in -tiedosto\n$ sudo systemctl edit nginx\n</code></pre> <p>Tiedosto aukeaa systemctl:n vakioeditorilla (yleens\u00e4 nano). Lis\u00e4\u00e4 tiedostoon seuraava sis\u00e4lt\u00f6 (sille ohjeistettuun paikkaan - lue kommentit tiedostosta!):</p> <pre><code>[Unit]\nDescription=This is my fake description!\n</code></pre> <p>Tip</p> <p>Tiedosto on niin sanottu <code>drop-in</code>-konfiguraatio. Linuxissa n\u00e4m\u00e4 toimivat yleens\u00e4 siten, ett\u00e4 <code>/etc/program</code>:n drop-in konfiguraatiotiedostot l\u00f6ytyv\u00e4t hakemistosta <code>/etc/program.d/</code>. T\u00e4ss\u00e4 tapauksessa tiedosto l\u00f6ytyy hakemistosta <code>/etc/systemd/system/nginx.service.d/override.conf</code>. Joissakin tapauksissa drop-in -tiedostot ovat numeroituja, jolloin niiden suoritusj\u00e4rjestys on m\u00e4\u00e4ritelty tiedostonimess\u00e4.</p> <p>J\u00e4rjestelm\u00e4n k\u00e4ynnistyess\u00e4 systemd lukee kaikki konfiguraatiotiedostot ja yhdist\u00e4\u00e4 ne yhdeksi kokonaisuudeksi. Mik\u00e4li samasta asetuksesta on useampi m\u00e4\u00e4ritely, viimeisin voittaa. Drop-in -tiedostoilla voidaan siis ylikirjoittaa alkuper\u00e4isi\u00e4 asetuksia.</p> Bash<pre><code># Tarpeen mukaan saatat joutua lataamaan systemd:n konffit uudelleen\n$ sudo systemctl daemon-reload\n\n# Kokeile k\u00e4ynnist\u00e4\u00e4 nginx uudelleen\n$ sudo systemctl restart nginx\n\n# Tarkista, ett\u00e4 uusi kuvaus n\u00e4kyy\n$ systemctl status nginx\n\n# Katso my\u00f6s cat:lla\n$ systemctl cat nginx\n</code></pre> <p>Tip</p> <p>Jos ihmettelet, mik\u00e4 on service-konfiguraatiotiedossa n\u00e4kynyt <code>After=network.target</code>, niin se tarkoittaa, ett\u00e4 ohjelma k\u00e4ynnistyy vasta kun verkko on k\u00e4ytett\u00e4viss\u00e4. Huomaa, ett\u00e4 systemd itsess\u00e4\u00e4n on ensimm\u00e4inen k\u00e4ynnistett\u00e4v\u00e4 ohjelma, joten sen asetuksilla voi m\u00e4\u00e4ritt\u00e4\u00e4, mit\u00e4 kaikkea k\u00e4ynnistet\u00e4\u00e4n ja miss\u00e4 j\u00e4rjestyksess\u00e4. Targetit ovat systemd:n tapa m\u00e4\u00e4ritell\u00e4 t\u00e4m\u00e4.</p> <p>Jos haluat, ett\u00e4 Linux ei k\u00e4ynnisty laisinkaan graafiseen k\u00e4ytt\u00f6liittym\u00e4\u00e4n, voit muuttaa <code>multi-user.target</code>-targetiksi. T\u00e4m\u00e4 on hy\u00f6dyllist\u00e4 esimerkiksi palvelimilla, joissa ei ole tarvetta graafiselle k\u00e4ytt\u00f6liittym\u00e4lle.</p> Bash<pre><code>$ sudo systemctl get-default\n$ sudo systemctl set-default multi-user.target # vaihtoehtona graphical.target\n$ sudo systemctl reboot\n</code></pre> <p>Jos haluat ihan listata nykyisen targetin (eli yleens\u00e4 <code>graphical.target</code> )riippuvuudet, voit k\u00e4ytt\u00e4\u00e4 <code>list-dependencies</code>-komennon.</p> Bash<pre><code>$ systemctl list-dependencies\n</code></pre> <p>Warning</p> <p>Jos et tarvitse NGINX:\u00e4\u00e4, kannattaa se poistaa t\u00e4ss\u00e4 v\u00e4liss\u00e4. T\u00e4m\u00e4 hoituu komennolla <code>sudo apt remove nginx</code>. Muista riippuvuuksista p\u00e4\u00e4set eroon komennolla <code>sudo apt autoremove</code>. Huomaa, ett\u00e4 konfiguraatiotiedostot j\u00e4\u00e4v\u00e4t kuitenkin paikoilleen (ks. <code>/etc/nginx/</code>).</p>"},{"location":"prosessit/systemd/#esimerkki-ajastettu-python-ohjelma","title":"Esimerkki: Ajastettu Python-ohjelma","text":"<p>Kuvio 2: Python TODO-ohjelma DALL-E 3:n piirt\u00e4m\u00e4n\u00e4.</p> <p>Luodaan esimerkin vuoksi ajastettu Python-ohjelma, joka annetaan systemd:n per-user instanssin ajettavaksi. Vaihtoehtona olisi lis\u00e4t\u00e4 konfiguraatiotiedostot <code>/run/systemd/system</code>-lokaatioon system-wide instanssin ajettavaksi.</p> <p>Alla lyhyt kuvaus ohjelmasta, jonka luomme:</p> <ul> <li>Ohjelma etsii tiedostoja <code>todo</code>-kansiosta.</li> <li>... jos se l\u00f6yt\u00e4\u00e4, se:<ul> <li>siirt\u00e4\u00e4 tiedoston <code>doing</code>-kansioon.</li> <li>vaihtaa sis\u00e4ll\u00f6n <code>TODO</code>-sanat <code>DONE</code>-sanoiksi.</li> <li>valmis tiedosto l\u00f6ytyy <code>done</code>-kansiosta.</li> </ul> </li> <li>Ohjelma ajetaan minuutin v\u00e4lein k\u00e4ytt\u00e4j\u00e4n ollessa kirjautuneena.</li> <li>Ohjelman working directory m\u00e4\u00e4ritet\u00e4\u00e4n <code>.service</code>-tiedostossa.</li> </ul>"},{"location":"prosessit/systemd/#python","title":"Python","text":"<p>Luo Python-executable kotikansion alaisuuteen:</p> Bash<pre><code>$ mkdir -p ~/.local/bin/testprocessor/\n$ cd ~/.local/bin/testprocessor/\n$ touch main.py\n$ chmod u+x main.py\n</code></pre> <p>Lis\u00e4\u00e4 seuraava sis\u00e4lt\u00f6 <code>main.py</code>-tiedostoon:</p> <pre><code>#!/usr/bin/python3\n\nfrom pathlib import Path\n\n# Define the folder names\ntodo, doing, done = \"todo\", \"doing\", \"done\"\n\n# Create the folders if they don't exist\nfor folder in [todo, doing, done]:\n    Path(folder).mkdir(parents=True, exist_ok=True)\n\nprint(f\"[INFO] Scanning: {Path(todo).absolute()}\")\n\n# Get a list of files in the todo folder\nfiles_to_process = list(Path(todo).glob(\"*.txt\"))\n\nprint(f\"[INFO] Processing {len(files_to_process)} files.\")\n\n# Process each file\nfor file_path in files_to_process:\n    filename = file_path.name\n    todo_path = Path(todo) / filename\n    doing_path = Path(doing) / filename\n    done_path = Path(done) / filename\n\n    # Move from todo to doing\n    todo_path.rename(doing_path)\n\n    # Process\n    with doing_path.open(\"r\") as file:\n        content = file.read()\n        content = content.replace(\"TODO\", \"DONE\")\n\n    # Write the processed content to the done folder\n    with done_path.open(\"w\") as file:\n        file.write(content)\n\n    # Remove the file from the doing folder\n    doing_path.unlink()\n\nprint(\"[INFO] Processing complete.\")\n</code></pre>"},{"location":"prosessit/systemd/#service-ja-timer","title":"Service ja Timer","text":"<p>Luo service ja timer konfiguraatiot paikkaan:</p> Bash<pre><code>$ mkdir -p ~/.config/systemd/user/\n$ cd ~/.config/systemd/user/\n$ touch testprocessor.service\n$ touch testprocessor.timer\n</code></pre> <p>Ajan syntaksin docs: systemd.time (www.freedesktop.org)</p> <p>Lis\u00e4\u00e4 seuraava sis\u00e4lt\u00f6 <code>testprocessor.service</code> tiedostoon:</p> <pre><code>[Unit]\nDescription=My Test Processor Service\n\n[Service]\nType=oneshot\nWorkingDirectory=%h/Documents/\nExecStart=%h/.local/bin/testprocessor/main.py\n</code></pre> <p>Lis\u00e4\u00e4 seuraava sis\u00e4lt\u00f6 <code>testprocessor.timer</code> tiedostoon:</p> <pre><code>[Unit]\nDescription=Timer for My Test Processor Service\n\n[Timer]\nOnCalendar=minutely\n</code></pre>"},{"location":"prosessit/systemd/#kaynnista","title":"K\u00e4ynnist\u00e4","text":"Bash<pre><code>$ systemctl --user daemon-reload\n$ systemctl --user start testprocessor.timer\n\n# Tarkista my\u00f6s statukset\n$ systemctl --user status testprocessor.timer\n$ systemctl --user status testprocessor.service\n\n# Tarkista my\u00f6s list:ll\u00e4\n$ systemctl --user list-units\n$ systemctl --user list-timers\n</code></pre> <p>Mik\u00e4li teet muutoksia <code>main.py</code>-tiedostoon tai daemonin m\u00e4\u00e4ritelytiedostoihin, aja komento <code>systemctl --user daemon-reload</code> uusiksi.</p>"},{"location":"prosessit/systemd/#testaus","title":"Testaus","text":"<p>K\u00e4ynnist\u00e4 uusi terminaali Ctrl+Alt+T n\u00e4pp\u00e4imill\u00e4 ja k\u00e4ynnist\u00e4 lokin seuranta (<code>-f</code> optionilla).</p> Bash<pre><code>$ journalctl --user -u testprocessor.service -f\nsyys 08 16:28:25 opekone systemd[2415]: Starting My Test Processor Service...\nsyys 08 16:28:25 opekone main.py[3748]: [INFO] Scanning: /home/opettaja/Documents/todo\nsyys 08 16:28:25 opekone main.py[3748]: [INFO] Processing 0 files.\nsyys 08 16:28:25 opekone main.py[3748]: [INFO] Processing complete.\n</code></pre> <p>Lis\u00e4\u00e4 toisessa terminaalissa uusi tiedosto hakemistoon, jota skripti vahtii:</p> Bash<pre><code>$ echo \"TODO\" &gt; ~/Documents/todo/tester.txt\n</code></pre>"},{"location":"prosessit/systemd/#pysayta","title":"Pys\u00e4yt\u00e4","text":"Bash<pre><code>$ systemctl --user stop testprocessor.timer\n\n# Katso my\u00f6s status\n$ systemctl --user status testprocessor.timer\n</code></pre>"},{"location":"prosessit/systemd/#tehtavat","title":"Teht\u00e4v\u00e4t","text":"<p>Teht\u00e4v\u00e4: Tutustu Systemd Unittiin</p> <p>Listaa kaikki tyypin <code>service</code> unitit. Valitse niist\u00e4 yksi ja tutustu siihen. Mit\u00e4 konfiguraatiotiedostoja siihen liittyy? Mik\u00e4 sen teht\u00e4v\u00e4 on ylip\u00e4\u00e4t\u00e4ns\u00e4? Mik\u00e4 sen status on ja milloin se k\u00e4ynnistyy tai ajetaan? Mist\u00e4 l\u00f6yd\u00e4t list\u00e4tietoa siit\u00e4?</p> <p>Teht\u00e4v\u00e4: Systemd timer</p> <p>Toteuta yll\u00e4 esitelty esimerkki omassa Linux-asennuksessasi. Todista kuvien ja journalctl:n avulla, ett\u00e4 se toimii.</p> <p>Lopuksi poista se k\u00e4yt\u00f6st\u00e4.</p>"},{"location":"tiedostojarjestelma/levyt/","title":"Levyt","text":"<p>Warning</p> <p>T\u00e4m\u00e4 Tiedostoj\u00e4rjestelm\u00e4-osio ei sis\u00e4ll\u00e4 teht\u00e4v\u00e4pakettia ja on kehitys/odotustilassa; sit\u00e4 jatketaan, jos sille tulee tarve jossakin toteutuksessa. Voit kuitenkin tutustua t\u00e4h\u00e4n raakileeseen vapaasti.</p> <p>Tietokoneessa k\u00e4ynniss\u00e4 olevat ohjelmat eli prosessit ovat ladattuina tietokoneen keskusmuistiin (RAM). Jotta jotakin tietoa voisi s\u00e4ilytt\u00e4\u00e4 (eng. persist) pysyv\u00e4sti, tarvitaan massamuistina toimiva laite, kuten kiintolevy tai SSD-puolijohdelevy. Virtuaalikoneessasi t\u00e4m\u00e4 laite on virtuaalinen, mutta l\u00f6ytyy <code>/dev</code>-lokaatiosta tiedostona, kuten muutkin laitteet Linuxissa.</p> <p>Alla esimerkki macOS:n UTM-virtuaalikoneessa ajetusta Ubuntusta, josta l\u00f6ytyy seuraavat block devicesit (ks. <code>man lsblk</code>).</p> Bash<pre><code>$ lsblk --exlude 7\nNAME   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS\nsr0     11:0    1 1024M  0 rom  \nvda    252:0    0   64G  0 disk \n\u251c\u2500vda1 252:1    0  512M  0 part /boot/efi\n\u2514\u2500vda2 252:2    0 63,5G  0 part /\n</code></pre> <p>Mik\u00e4li sinulla on virtuaalikone Windowsissa, laitteena on todenn\u00e4k\u00f6isesti <code>sda</code> eik\u00e4 <code>vda</code>. SDA on hypervisorin emuloima SCSI-asema, kun taas VDA on paravirtualisoitu, jolloin virtuaalikoneen k\u00e4skyt vied\u00e4\u00e4n jotakuinkin l\u00e4pivientin\u00e4 hypervisorin l\u00e4pi sen alla olevaan k\u00e4ytt\u00f6j\u00e4rjestelm\u00e4\u00e4n, joka on t\u00e4ss\u00e4 tapauksessa UNIX-pohjainen macOS.</p> <p>P.S. Listalla voi n\u00e4ky\u00e4 muutakin kuin, kuten Firefoxin <code>host-hunspell</code>. </p>"},{"location":"tiedostojarjestelma/levyt/#laitteet","title":"Laitteet","text":"<p>Mik\u00e4li haluat l\u00f6yt\u00e4\u00e4 laitteista lis\u00e4\u00e4 tietoa, voit tarkistaa esimerkiksi kernel ring bufferin eli kernelin lokiviestit (komento <code>sudo dmesg</code>) tai udevin eli laitehallinnan tietoja. Alla j\u00e4lkimm\u00e4isen output kyseisten laitteiden kohdalta.</p> Bash<pre><code># udev\n$ udevadm info /dev/sr0\nP: /devices/pci0000:00/0000:00:04.0/usb1/1-4/1-4.1/1-4.1:1.0/host0/target0:0:0/0:0:0:0/block/sr0\nN: sr0\nL: -100\nS: cdrom\nS: disk/by-id/usb-QEMU_QEMU_CD-ROM_1-0000:00:04.0-4.1-0:0\n...\n\n# udev\n$ udevadm info /dev/vda\nP: /devices/pci0000:00/0000:00:06.0/virtio2/block/vda\nN: vda\nL: 0\nS: disk/by-path/virtio-pci-0000:00:06.0\nS: disk/by-path/pci-0000:00:06.0\n...\n</code></pre> <p>Huomaa, ett\u00e4 laitteet ovat t\u00e4ss\u00e4 tapauksessa vain virtuaalisia. Tiedostojen lokaatio ja muoto riippuu hypervisorista. T\u00e4ss\u00e4 tapauksessa hypervisor on UTM, ja tiedosto l\u00f6ytyy lokaatiosta:</p> Bash<pre><code>/Users/&lt;user&gt;/Library/Containers/com.utmapp.UTM/Data/Documents/&lt;vm-name&gt;/Data\n</code></pre>"},{"location":"tiedostojarjestelma/levyt/#scsi","title":"SCSI","text":"<p>Mik\u00e4li et paravirtualisoi massamuistia virtio:lla kuten yll\u00e4, laitteet k\u00e4sitell\u00e4\u00e4n Linuxissa mit\u00e4 suurimmalla todenn\u00e4k\u00f6isyydell\u00e4 SCSI block device -tyylisin\u00e4 laitteina. T\u00e4m\u00e4 ei siis tarkoita, ett\u00e4 tietokoneessa olisi erikseen SCSI-ohjainkortti, vaan Linux k\u00e4ytt\u00e4\u00e4 SCSI-komentoja levyjen kanssa kommunikoimiseen. (S)ATA, ATAPI, USB ja muihin liit\u00e4nt\u00f6ihin kiinnitetyt massamuistilaitteet n\u00e4kyv\u00e4t t\u00e4ten Linuxissa SCSI-v\u00e4yl\u00e4\u00e4n kytkettyin\u00e4 laitteina.</p> <p></p> <p>Kuvio 1: Virtuaalikoneeseen lis\u00e4t\u00e4\u00e4n uusi SCSI-rajapintaa k\u00e4ytt\u00e4v\u00e4 levy.</p> <p>Mik\u00e4li virtuaalikoneeseen lis\u00e4t\u00e4\u00e4n kaksi SCSI-rajapintaa k\u00e4ytt\u00e4v\u00e4\u00e4 levy\u00e4, ja ajetaan aiemmin tuttu list block devices komento, tulostuu ruudulle alla n\u00e4kyv\u00e4 tuloste. Mik\u00e4li <code>--exclude</code>:n viittaamaa sek\u00e4 tulostuneessa taulussa n\u00e4kym\u00e4 MAJ eli major numero kiinnostaa, tutki tiedostoa <code>/proc/devices</code>, jossa ne ovat listattuina.</p> Bash<pre><code>$ lsblk --exclude 7\nNAME   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS\nsda      8:0    0   10G  0 disk \nsdb      8:16   0   10G  0 disk \nsr0     11:0    1 1024M  0 rom  \nvda    252:0    0   64G  0 disk \n\u251c\u2500vda1 252:1    0  512M  0 part /boot/efi\n\u2514\u2500vda2 252:2    0 63,5G  0 part /\n</code></pre> <p>Kuten yll\u00e4 n\u00e4kyy, kaksi uutta SCSI-laitetta ovat saaneet nimet <code>sda</code> ja <code>sdb</code>. Linux n\u00e4kee siis laitteet, mutta niit\u00e4 ei ole viel\u00e4 liitetty mill\u00e4\u00e4n tavalla file hierarchyyn. Tietokoneessa vapaana oleva kiintolevytila ei ole siis viel\u00e4 k\u00e4ytt\u00f6j\u00e4rjestelm\u00e4n n\u00e4k\u00f6kulmasta lis\u00e4\u00e4ntynyt. T\u00e4m\u00e4n voi varmistaa ajamalla <code>df</code>-komennon. Option <code>-h</code> kertoo koot ihmisille sopivissa formaateissa, <code>-e tmpfs</code> sen sijaan piilottaa muistinsis\u00e4iset eli vain RAM:ssa sijaitsevat, v\u00e4liaikaiset levyj\u00e4rjestelm\u00e4t.</p> Bash<pre><code>$ df -h --exclude-type tmpfs\nFilesystem      Size  Used Avail Use% Mounted on\n/dev/vda2        63G   13G   47G  22% /\n/dev/vda1       512M  5,3M  507M   2% /boot/efi\n</code></pre> <p>Jos haluat n\u00e4hd\u00e4 kaikki SCSI-laitteesi listamuodossa, tutustu tiedostoon <code>/proc/scsi/scsi</code> tai aja alla n\u00e4kym\u00e4 komento:</p> Bash<pre><code>$ lsscsi\n[0:0:0:0]    disk    QEMU     QEMU HARDDISK    2.5+  /dev/sda \n[0:0:1:0]    disk    QEMU     QEMU HARDDISK    2.5+  /dev/sdb \n[1:0:0:0]    cd/dvd  QEMU     QEMU CD-ROM      2.5+  /dev/sr0 \n</code></pre> <p>Ensimm\u00e4isen sarakkeen selite l\u00f6ytyy <code>/proc/scsi/scsi</code>-tiedostosta, eli <code>[0:0:0:0]</code> on sama kuin <code>Host: scsi0 Channel: 00 Id: 00 Lun: 00</code>.</p>"},{"location":"tiedostojarjestelma/lvm/","title":"LVM","text":"<p>Edellisess\u00e4 luvussa (Osiot) loimme yhden partition levylle <code>/dev/sda</code>, mounttasimme sen, lis\u00e4simme sen <code>fstab</code>-tiedostoon ja lopulta poistimme osion.</p> <p>T\u00e4ss\u00e4 luvussa otamme k\u00e4ytt\u00f6\u00f6n Logical Virtual Managerin:n eli LVM:n, joka muistuttaa jossain m\u00e4\u00e4rin Windowsista tuttua Storage Spaces:i\u00e4. Kuvittele, ett\u00e4 sinulla on edellisess\u00e4 harjoituksessa luodun osion, joka mountattiin lokaatioon <code>/mnt/mydata</code>, levytila lopussa. Huomaat t\u00e4m\u00e4n <code>df -H</code> komennolla.</p> <p>Quote</p> <p>\"Haluan lis\u00e4t\u00e4 levytilaa /mnt/mydata/ kansion alla olevaan partitioon. Kyseinen osio on /dev/sda1 ja sen on levyn /dev/sda ainut osiot.\"</p> <p>Levy on t\u00e4ss\u00e4 tapauksessa virtuaalinen, joten me voimme skaalata sit\u00e4 suuremmaksi, mutta enp\u00e4 jos levy on fyysinen? Vaihehtoja ovat ainakin:</p> <ul> <li>Osta suurempi kiintolevy ja kopioi data sille. Mounttaa uusi levy vanhan tilalle.</li> <li>Osta toinen kiintolevy ja mounttaa se <code>/mnt/moredata</code>. K\u00e4ytt\u00e4j\u00e4 joutuu hallinnoimaan tilan.</li> </ul> <p>LVM ratkaisee muun muassa t\u00e4m\u00e4n ongelman: voit kytke\u00e4 tietokoneeseen uuden levyn ja luoda siit\u00e4 fyysisen volumen. Tutustutaan t\u00e4h\u00e4n alla.</p>"},{"location":"tiedostojarjestelma/lvm/#terminologia","title":"Terminologia","text":"<pre><code>graph BT\n      pvx[Physical Volume X] --&gt; vg0\n      pvy[Physical Volume Y] --&gt; vg0\n      pvz[Physical Volume Z] --&gt; vg0\n      vg0[Volume Group 0] --&gt; lva[Logical Volume A]\n      vg0[Volume Group 0] --&gt; lvb[Logical Volume B]\n      lva --&gt; fsa[Filesystem A]\n      lvb --&gt; fsb[Filesystem B]</code></pre> Termi Lyhenne Selite Filesystem N/A T\u00e4m\u00e4 ei muutu. LVM:\u00e4\u00e4 tukevat kaikki aiemmin mainitut tiedostoj\u00e4rjestelm\u00e4t, kuten <code>ext4</code> sek\u00e4 <code>xfs</code>, koska sen alla oleva Logical Volume on ihan vain tavallinen block device. Logical Volume lv Loogiset volumet ovat k\u00e4ytt\u00e4j\u00e4n n\u00e4k\u00f6kulmasta tavallisia block devicej\u00e4, jotka listataan paikassa <code>/dev/mapper/</code> symbolisina linkkein\u00e4. Volume Group vg LVM:n hallinnoimia usean Physical Volumen kokonaisuuksia. N\u00e4ist\u00e4 voidaan my\u00f6hemmin luoda Logical Volumeja. Physical Volume pv Koko kiintolevy tai yksitt\u00e4inen osio levyll\u00e4."},{"location":"tiedostojarjestelma/lvm/#luodaan-kahden-levyn-group","title":"Luodaan kahden levyn group","text":"<p>Warning</p> <p>Ajathan n\u00e4m\u00e4 esimerkit vain sinun hallinnoimalla koneella, jolla ei ole mit\u00e4\u00e4n t\u00e4rke\u00e4\u00e4 tallennettuna. T\u00e4ss\u00e4 esimerkiss\u00e4 oletetaan, ett\u00e4 olet liitt\u00e4nyt koneeseen kaksi kiintolevy\u00e4 (<code>/dev/sda</code> ja <code>/dev/sdb</code>), jotka ovat tyhji\u00e4, eiv\u00e4tk\u00e4 ole miss\u00e4\u00e4n k\u00e4yt\u00f6ss\u00e4. Lue kaksi aiempaa lukua (Levyt ja Osiot) jos et tied\u00e4 mist\u00e4 t\u00e4ss\u00e4 on kyse.</p> <p>Aloitetaan asentamalla tarvittavat ty\u00f6kalut:</p> Bash<pre><code># Asenna\n$ sudo apt install lvm2\n\n# Yrit\u00e4 listata nykyiset volume groupit\n$ sudo vgs\n</code></pre> <p>T\u00e4m\u00e4n j\u00e4lkeen alamme luoda LVM:\u00e4\u00e4 graafin pohjalta yl\u00f6sp\u00e4in j\u00e4rjestyksess\u00e4 PV, VG, LV ja lopuksi tiedostoj\u00e4rjestelm\u00e4</p>"},{"location":"tiedostojarjestelma/lvm/#pv","title":"PV","text":"Bash<pre><code># HUOM! Jos levy sis\u00e4lt\u00e4\u00e4 edellisen harjoituksen pohjalta GPT:n, poista se:\n# $ sudo wipefs --all /dev/sda\n\n# Luo physical volume koko levyst\u00e4\n$ sudo pvcreate /dev/sda\n  Physical volume \"/dev/sda\" successfully created.\n\n# Tee sama toiselle levylle\n$ sudo pvcreate /dev/sdb\n  Physical volume \"/dev/sdb\" successfully created.\n\n# Listaa\n$ sudo pvs\n  PV         VG Fmt  Attr PSize  PFree\n  /dev/sda      lvm2 ---  10,00g 10,00g\n  /dev/sdb      lvm2 ---  10,00g 10,00g\n\n# Tarkastele tarkemmin\n$ sudo\n  \"/dev/sda\" is a new physical volume of \"10,00 GiB\"\n  --- NEW Physical volume ---\n  PV Name               /dev/sda\n  VG Name\n  PV Size               10,00 GiB\n  Allocatable           NO\n  PE Size               0\n  Total PE              0\n  Free PE               0\n  Allocated PE          0\n  PV UUID               96qMoT-w2eU-3S3h-VZSo-Qrsp-k96L-7XDqD9\n</code></pre>"},{"location":"tiedostojarjestelma/lvm/#vg","title":"VG","text":"Bash<pre><code># Luo\n$ sudo vgcreate myvg0 /dev/sda /dev/sdb\n  Volume group \"myvg0\" successfully created\n\n# Listaa\n$ sudo vgs\n  VG    #PV #LV #SN Attr   VSize  VFree\n  myvg0   2   0   0 wz--n- 19,99g 19,99g\n\n# Tarkastele\n$ sudo vgdisplay myvg0\n  --- Volume group ---\n  VG Name               myvg0\n  System ID\n  Format                lvm2\n  ...\n  PE Size               4,00 MiB\n  Total PE              5118\n  Free  PE / Size       5118 / 19,99 GiB\n  VG UUID               JEikj0-x8Ue-4Ozp-ev6d-Hdjb-rpGq-814q10\n</code></pre> <p>PE eli Physical Extent on yksikk\u00f6, jonka kokoisiin loogisiin palasiin Volume Group on pilkottu. Logical Volumet luodaan jakamalla n\u00e4it\u00e4 eri laareihin.</p>"},{"location":"tiedostojarjestelma/lvm/#lv","title":"LV","text":"Bash<pre><code># Luo\n$ sudo lvcreate --name mydata --extents 100%FREE myvg0\n  Logical volume \"mydata\" created.\n\n# Listaa\n$ sudo lvs\n  LV     VG    Attr       LSize  Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert\n  mydata myvg0 -wi-a----- 19,99g\n\n$ sudo lvdisplay myvg0\n  --- Logical volume ---\n  LV Path                /dev/myvg0/mydata\n  LV Name                mydata\n  VG Name                myvg0\n  LV UUID                0dCKxl-QCyg-3xgy-TOuq-0bmR-V0eu-Np8jEF\n  LV Write Access        read/write\n  LV Creation host, time opettajakone, 2023-09-25 10:29:06 +0300\n  LV Status              available\n  # open                 0\n  LV Size                19,99 GiB\n  Current LE             5118\n  Segments               2\n  Allocation             inherit\n  Read ahead sectors     auto\n  - currently set to     256\n  Block device           253:0\n</code></pre> <p>Jos katsot nyt, mit\u00e4 block devicej\u00e4 sinulla on k\u00e4yt\u00f6ss\u00e4, huomaat ett\u00e4 sek\u00e4 sda ett\u00e4 sdb ovat tyyppi\u00e4 LVM. Kummankin osiona n\u00e4kyy Volume Group myvg0-mydata.</p> Bash<pre><code># Listaa\n$ lsblk -e 7 /dev/sda /dev/sdb\nNAME           MAJ:MIN RM SIZE RO TYPE MOUNTPOINTS\nsda              8:0    0  10G  0 disk\n\u2514\u2500myvg0-mydata 253:0    0  20G  0 lvm\nsdb              8:16   0  10G  0 disk\n\u2514\u2500myvg0-mydata 253:0    0  20G  0 lvm\n\n# Kyseinen osio l\u00f6ytyy paikasta:\n$ ls -la /dev/mapper\ncrw-------  1 root root 10, 236 syys   25 08:44 control\nlrwxrwxrwx  1 root root       7 syys   25 10:29 myvg0-mydata -&gt; ../dm-0\n</code></pre> <p>Huomaat, ett\u00e4 <code>myvg0-mydata</code> on symbolinen linkki <code>/dev/dm-0</code> deviceen.</p>"},{"location":"tiedostojarjestelma/lvm/#tiedostojarjestelman-luonti","title":"Tiedostoj\u00e4rjestelm\u00e4n luonti","text":"Bash<pre><code>$ sudo mkfs.ext4 -L MyData /dev/mapper/myvg0-mydata\nmke2fs 1.46.5 (30-Dec-2021)\nDiscarding device blocks: done\nCreating filesystem with 5240832 4k blocks and 1310720 inodes\nFilesystem UUID: 808c8175-4c78-429d-9dcf-c6c58736fd2b\n</code></pre> <p>Kun tiedostoj\u00e4rjestelm\u00e4 on luotu, mountataan osio kuten aiemminkin:</p> Bash<pre><code># Mount\n$ sudo mount /dev/mapper/myvg0-mydata /mnt/mydata/\n\n# Tarkista\n$ mount | grep myvg\n/dev/mapper/myvg0-mydata on /mnt/mydata type ext4 (rw,relatime)\n\n# Muuta oikeuksia tarpeen mukaan, kuten\n# $ sudo chown opettaja:opettaja /mnt/mydata\n</code></pre> <p>Mik\u00e4li haluat, ett\u00e4 levy on joka bootissa k\u00e4yt\u00f6ss\u00e4, lis\u00e4\u00e4 se tuttuun tapaan fstabiin, esimerkiksi alla n\u00e4kyv\u00e4ll\u00e4 tavalla. Tiedoston muut rivit on poistettu alla olevasta n\u00e4kym\u00e4st\u00e4, jotta se pysyy tiiviin\u00e4; eth\u00e4n oikeasti tyhjenn\u00e4 tiedostosta muita rivej\u00e4! My\u00f6s UUID on lyhennetty luettavuuden parantamiseksi.</p> <pre><code>UUID=&lt;uuid-poistettu&gt;         /               ext4    errors=remount-ro 0       1\n/dev/mapper/myvg0-mydata      /mnt/mydata     ext4    defaults          0       2\n</code></pre> <p>Jos ihmettelet, miksei LVM:n kohdalla k\u00e4ytet\u00e4 UUID:t\u00e4 vaan mapper device\u00e4, niin lue Best Practice for Mounting an LVM Logical Volume with /etc/fstab.</p> <p>Tip</p> <p>Kannattaa kokeilla lis\u00e4t\u00e4 my\u00f6s kolmas levy, poistaa levyj\u00e4, ja poistaa koko LVM. T\u00e4m\u00e4n ohjeen j\u00e4lkeen sinun pit\u00e4isi osata tehd\u00e4 n\u00e4m\u00e4 kaikki - tai v\u00e4hint\u00e4\u00e4n etsi\u00e4 tietoa, kuinka n\u00e4m\u00e4 tehd\u00e4\u00e4n.</p>"},{"location":"tiedostojarjestelma/osiot/","title":"Osiot","text":"<p>Jotta levyj\u00e4 voisi k\u00e4ytt\u00e4\u00e4 k\u00e4ytt\u00f6j\u00e4rjestelm\u00e4ss\u00e4, t\u00e4ytyy niill\u00e4 olla osio tai useampi (eng. partition). Osiointiin voi k\u00e4ytt\u00e4\u00e4 ohjelmaa <code>parted</code> tai <code>fdisk</code>. Ensimm\u00e4isest\u00e4 l\u00f6ytyy my\u00f6s GUI-versio nimell\u00e4 <code>gparted</code>. Osiot tallennetaan kyseisell\u00e4 levyll\u00e4 olevaan osiointitaulukkoon (eng. partitioning table), joka on (ainakin loogisen osoitteen puolesta) levyn alussa, eli HDD:n tapauksessa sen voi kuvitella olevan py\u00f6riv\u00e4n kiekon ulkolaidalla. SSD:n tapauksessa py\u00f6riv\u00e4\u00e4 kiekkoa ei ole, mutta loogiset osoitteet l\u00f6ytyv\u00e4t silti. Varsinaiset partitiot eli ohjelmien tallentama data tallennetaan kiekon (tai median) alueille, joita ei ole varattu GPT:n k\u00e4ytt\u00f6\u00f6n.</p> <p>Olemassa olevat osiot voi listata seuraavalla komennolla:</p> Bash<pre><code>$ sudo parted -l\nModel: QEMU QEMU HARDDISK (scsi)                                          \nDisk /dev/sda: 10,7GB\nSector size (logical/physical): 512B/512B\nPartition Table: unknown\nDisk Flags: \n\nError: /dev/sdb: unrecognised disk label\nModel: QEMU QEMU HARDDISK (scsi)                                          \nDisk /dev/sdb: 10,7GB\nSector size (logical/physical): 512B/512B\nPartition Table: unknown\nDisk Flags: \n\nModel: Virtio Block Device (virtblk)\nDisk /dev/vda: 68,7GB\nSector size (logical/physical): 512B/512B\nPartition Table: gpt\nDisk Flags: \n\nNumber  Start   End     Size    File system  Name                  Flags\n 1      1049kB  538MB   537MB   fat16        EFI System Partition  boot, esp\n 2      538MB   68,7GB  68,2GB  ext4\n</code></pre> <p>Huomaa yll\u00e4 olevasta tulosteesta, ett\u00e4 kummallakaan SCSI-levyll\u00e4 (sda, sdb) ei ole osiointitaulukkoa olemassa. Sen sijaan Ubuntu Installerin luoma levy on partitioitu GPT-taulukon avulla. Osiointitaulukkoja on kahta sorttia: vanhempi MBR ja uudempi GPT. N\u00e4m\u00e4 tulevat sanoista Master Boot Record sek\u00e4 GUID Partition Table eli GPT. MBR kannattaa uusissa koneissa j\u00e4tt\u00e4\u00e4 kokonaisuudessaan historiaan ja k\u00e4ytt\u00e4\u00e4 sen uudempaa, UEFI-yhteensopivaa vastinetta eli GPT:t\u00e4.</p> <p>Tip</p> <p>Huomaa, ett\u00e4 vaikka MBR alkaa olla jo historian havinaa, taaksep\u00e4in yhteensopivuuden takia jokaisella osioidulla levyll\u00e4 on silti \"Protected MBR\", joka v\u00e4itt\u00e4\u00e4 koko levyn olevan yht\u00e4 osiota. N\u00e4in legacy-sovellukset luulevat tilan olevan k\u00e4yt\u00f6ss\u00e4 jollekin, mit\u00e4 ne eiv\u00e4t ymm\u00e4rr\u00e4. Voit lukea t\u00e4st\u00e4 lis\u00e4\u00e4 esimerkiksi Windows Hardware Developer: Windows and GPT FAQ</p> <p>Yll\u00e4 mainittu GUID (eli siis GPT-lyhenteen ensimm\u00e4inen kirjain) tulee sanoista Globally Unique Identifier, joka n\u00e4ytet\u00e4\u00e4n k\u00e4ytt\u00e4j\u00e4lle tyypillisesti heksadesimaalina, joka on eritelty muutamaan katkoviivalla eriteltyyn rypp\u00e4\u00e4seen, joissa kussakin on seuraava m\u00e4\u00e4r\u00e4 digittej\u00e4: <code>&lt;8-4-4-4-12&gt;</code>. Alla n\u00e4kyy nykyisten osioiden GUID:t:</p> Bash<pre><code>$ sudo blkid /dev/vda\n/dev/vda: PTUUID=\"b617623d-318a-4180-b190-04037556de27\" PTTYPE=\"gpt\"\n\n$ sudo blkid /dev/sda\n# Ei tulostu mit\u00e4\u00e4n\n</code></pre>"},{"location":"tiedostojarjestelma/osiot/#yksi-osio-uudelle-levylle","title":"Yksi osio uudelle levylle","text":"<p>Warning</p> <p>Eth\u00e4n tee n\u00e4it\u00e4 harjoitteita koneella, jossa on pienink\u00e4\u00e4n riski menett\u00e4\u00e4 dataa. N\u00e4m\u00e4 harjoitukset tulisi tehd\u00e4 sinun itsesi hostaamalla virtuaalikoneella, jolle ei ole tallennettu mit\u00e4\u00e4n arvokasta.</p> <p>Kokeillaan osioida yll\u00e4 mainittu levy <code>sda</code>, luoda sille file system, ja mountata levy johonkin, miss\u00e4 sit\u00e4 voidaan k\u00e4ytt\u00e4\u00e4. Aivan ensimm\u00e4iseksi on hyv\u00e4 varmistaa, ett\u00e4 levy\u00e4 ei ole jo mountattu johonkin. T\u00e4ss\u00e4 tapauksessa on v\u00e4h\u00e4n mahdotonta, kun levyll\u00e4 ei ole edes osioida joita mountata, mutta tilanne voi olla toinen, mik\u00e4li sinulla on fyysinen kone, ja sen kiintolevyill\u00e4 on entuudestaan jotakin sis\u00e4lt\u00f6\u00e4.</p> Bash<pre><code>$ mount | grep sda # Tuloste on arvatenkin tyhj\u00e4\n</code></pre> <p>K\u00e4ynnistet\u00e4\u00e4n partitiointiohjelma.</p> Bash<pre><code>$ sudo parted /dev/sda\nGNU Parted 3.4\nUsing /dev/sda\nWelcome to GNU Parted! Type 'help' to view a list of commands.\n</code></pre> <p>T\u00e4m\u00e4 k\u00e4ynnist\u00e4\u00e4 interaktiivisen ohjelman, joten <code>$</code>-merkki\u00e4 ei jatkossa ole en\u00e4\u00e4 prompt:n alussa, vaan promtia yll\u00e4pit\u00e4\u00e4 parted. T\u00e4m\u00e4n tunnistaa <code>(parted)</code>-tekstist\u00e4 promptin alussa. Kuten aina, tarkista help ensin, jos ohjelmasta sellainen l\u00f6ytyy. Koko manuaali ly\u00f6tyy GNU:n sivuilta.</p> <pre><code>(parted) help\n  align-check TYPE N                       check partition N for TYPE(min|opt) alignment\n  help [COMMAND]                           print general help, or help on COMMAND\n  mklabel,mktable LABEL-TYPE               create a new disklabel (partition table)\n  mkpart PART-TYPE [FS-TYPE] START END     make a partition\n  ...\n</code></pre> <p>Ajetaan seuraavat komennot. Risuaidalla alkavat kommentit eiv\u00e4t kuulu komentoihin.</p> Bash<pre><code>(parted) mklabel gpt # kommentti (1)\n\n(parted) print       # (2)\nModel: QEMU QEMU HARDDISK (scsi)\nDisk /dev/sda: 10,7GB\nSector size (logical/physical): 512B/512B\nPartition Table: gpt\nDisk Flags: \n\nNumber  Start  End  Size  File system  Name  Flags\n\n(parted) mkpart       # (3)\nPartition name?  []? mydata\nFile system type?  [ext2]? ext4 # (4)\nStart? 0%             # (5)\nEnd? 100%\n\n(parted) print\nModel: QEMU QEMU HARDDISK (scsi)\nDisk /dev/sda: 10,7GB\nSector size (logical/physical): 512B/512B\nPartition Table: gpt\nDisk Flags:\n\nNumber  Start   End     Size    File system  Name    Flags\n 1      1049kB  10,7GB  10,7GB  ext4         mydata\n\n(parted) quit          # (6)\nInformation: You may need to update /etc/fstab.\n</code></pre> <ol> <li>Luodaan osiointitaulu tai ylikirjoitetaan sellainen.</li> <li>Tulostetaan t\u00e4h\u00e4n asti luodut osiot. Huomaa, ett\u00e4 <code>parted</code> luo kaiken heti k\u00e4skyn tapahtuessa eik\u00e4 vasta komennosta poistuessa. Kaikki muutokset ovat siis v\u00e4litt\u00f6m\u00e4sti voimassa.</li> <li>Luodaan osio. T\u00e4m\u00e4 k\u00e4ynnist\u00e4\u00e4 interaktiiviset kyselyt tulevan osion tiedoista.</li> <li>T\u00e4m\u00e4 komento ei viel\u00e4 luo file systemi\u00e4, mutta varmistaa osion yhteensopivuuden sen file systemin kanssa, jonka siihen aiot my\u00f6hemmin luoda.</li> <li>Levytila on helpointa t\u00e4ytt\u00e4\u00e4 prosentteina. Luku <code>0%</code> on sama kuin kirjoittaisit luvun <code>1</code>.</li> <li>Muutoksia ei tarvitse erikseen tallentaa. Poistu ohjelmasta quit-komennolla.</li> </ol> <p>Nyt jos tarkistat <code>parted -l</code> komennolla, mit\u00e4 osioita sinulla on, niin huomaat ett\u00e4 levylle on ilmestynyt sek\u00e4 partition table ett\u00e4 yksi osio. Osion <code>File system</code> on yh\u00e4 tyhj\u00e4.</p> Bash<pre><code>$ sudo parted -l\nModel: QEMU QEMU HARDDISK (scsi)\nDisk /dev/sda: 10,7GB\nSector size (logical/physical): 512B/512B\nPartition Table: unknown\nDisk Flags:\n\nNumber  Start   End     Size    File system  Name    Flags\n 1      1049kB  10,7GB  10,7GB               mydata\n\n# Muiden levyjen output poistettu\n</code></pre>"},{"location":"tiedostojarjestelma/osiot/#tiedostojarjestelman-luonti","title":"Tiedostoj\u00e4rjestelm\u00e4n luonti","text":"<p>Linuxista l\u00f6ytyy komento <code>mkfs</code>, mutta sen man pages sanoo: <code>This mkfs frontend is deprecated in favour of filesystem specific mkfs.&lt;type&gt; utils.</code> Emmeh\u00e4n siis k\u00e4yd\u00e4 vanhentunutta komentoa, vaan tuoreempaa. Konepellin alla t\u00e4m\u00e4 kutsuu <code>mke2fs</code>-ohjelmaa.</p> Bash<pre><code>$ sudo mkfs.ext4 -L MyData /dev/sda1\nmke2fs 1.46.5 (30-Dec-2021)\nDiscarding device blocks: done                            \nCreating filesystem with 2620928 4k blocks and 655360 inodes\nFilesystem UUID: 2923e1e0-d42a-42d0-a702-abf4d814dd43\n...\n</code></pre> <p>T\u00e4ss\u00e4 tapauksessa loimme levyj\u00e4rjestelm\u00e4n ext4, mutta my\u00f6s muita vaihtoehtoja l\u00f6ytyy. N\u00e4it\u00e4 ovat muiden muassa:</p> <ul> <li>Extended filesystemin vanhemmat versiot kuten ext2</li> <li>B-tree filesystem (btrfs), lausuttuna \"better FS\", joka tukee monia ext4:st\u00e4 puuttuvia featureita kuten kryptausta.</li> <li>File allocation table (FAT). Jo MS-DOS-ajoilta tuttu tiedostoj\u00e4rjestelm\u00e4, jonka variantteja (EXFAT jne.) k\u00e4ytet\u00e4\u00e4n usein USB-muisteissa ja SD-muistikorteissa. GPT:n k\u00e4ytt\u00e4m\u00e4 EFI system partition eli /boot/efi on FAT-osio.</li> <li>XFS. Red Hat Enterprise Linuxin vakiona k\u00e4ytt\u00e4m\u00e4 tiedostoj\u00e4rjestelm\u00e4.</li> </ul>"},{"location":"tiedostojarjestelma/osiot/#osion-mounttaus","title":"Osion mounttaus","text":"Bash<pre><code># Luo kansio mihin osio mountataan\n$ sudo mkdir /mnt/mydata\n\n# Salli itsellesi p\u00e4\u00e4sy tavalla tai toisella. \n# Uusi group olisi hyv\u00e4 k\u00e4yt\u00e4nt\u00f6, t\u00e4m\u00e4 on nopea k\u00e4yt\u00e4nt\u00f6.\n$ sudo chown opettaja:opettaja /mnt/mydata\n\n# Mount\n$ sudo mount /dev/sda1 /mnt/mydata\n\n# Tarkista\n$ mount | grep sda\n/dev/sda1 on /mnt/mydata type ext4 (rw,relatime)\n</code></pre>"},{"location":"tiedostojarjestelma/osiot/#osion-mounttaus-bootissa","title":"Osion mounttaus bootissa","text":"<p>Yksi pieni ongelma on viel\u00e4 j\u00e4ljell\u00e4. Nykyisell\u00e4\u00e4n levy\u00e4 ei mountata buutin yhteydess\u00e4 mihink\u00e4\u00e4n, joten joutuisit aina ajamaan k\u00e4sin <code>sudo mount ...</code>-komennon. T\u00e4t\u00e4 varten meid\u00e4n tarvitsee lis\u00e4t\u00e4 kyseinen osio <code>fstab</code>-tiedostoon. Luethan ohjekirjan ennen fstab-tiedostoon kajoamista! Ubuntun fstab ohjeet l\u00f6ytyv\u00e4t esimerkiksi verkkoversiona Ubuntun manpagesista tai vanhalla tutulla <code>man</code>-komennolla.</p> <p>Tip</p> <p>T\u00e4h\u00e4n on my\u00f6s mahdollista k\u00e4ytt\u00e4\u00e4 graafisia ty\u00f6kaluja, kuten <code>gnome-disk-utility</code> alias Disks. Sinulla ei kuitenkaan ole v\u00e4ltt\u00e4m\u00e4tt\u00e4 aina ty\u00f6p\u00f6yt\u00e4ymp\u00e4rist\u00f6\u00e4 k\u00e4ytett\u00e4v\u00e4n\u00e4, joten kannattaa opetella my\u00f6s komentorivin k\u00e4ytt\u00f6.</p> Bash<pre><code># Tarkista osion UUID. Ei siis levyn vaan osion (sda1)\n$ sudo blkdid /dev/sda1\n/dev/sda1: LABEL=\"MyData\" UUID=\"2923e1e0-d42a-42d0-a702-abf4d814dd43\" BLOCK_SIZE=\"4096\" TYPE=\"ext4\" PARTLABEL=\"mydata\" PARTUUID=\"d860c8fb-13ba-4ee0-a3a7-d234d7585ec3\"\n</code></pre> <p>Lis\u00e4\u00e4 rivi fstabiin. Alla n\u00e4kyy<code>/etc/fstab</code>-tiedostota vain muutama rivi. Loput on leikattu pois luettavuuden parantamisen takia:</p> Bash<pre><code># &lt;file system&gt; &lt;mount point&gt;   &lt;type&gt;  &lt;options&gt;       &lt;dump&gt;  &lt;pass&gt;\n# / was on /dev/vda2 during installation\nUUID=a094efbe-85e7-4ca3-ad32-fd590709b753 /               ext4    errors=remount-ro 0       1\nUUID=2923e1e0-d42a-42d0-a702-abf4d814dd43 /mnt/mydata     ext4    defaults          0       2\n</code></pre> <p>Jatkossa, kun k\u00e4ynnist\u00e4t koneen, kernel mounttaa bootin yhteydess\u00e4 levyn sille m\u00e4\u00e4r\u00e4ttyyn paikkaan File System Hierarchyss\u00e4. Mik\u00e4li haluat tutkia siihen kohdistuneita operaatioita, tutki kernel ring bufferia komennolla:</p> Bash<pre><code>$ sudo dmesg | grep sda\n[    3.476610] sd 0:0:0:0: [sda] Attached SCSI disk\n[    4.092008] EXT4-fs (sda1): mounted filesystem 2923e1e0-d42a-42d0-a702-abf4d814dd43 with ordered data mode. Quota mode: none.\n</code></pre> <p>Uusi partitio on n\u00e4kyvill\u00e4 muun muassa lsblk komennon outputissa:</p> Bash<pre><code>$ lsblk -e 7\nNAME   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS\nsda      8:0    0   10G  0 disk \n\u2514\u2500sda1   8:1    0   10G  0 part /mnt/mydata\nsdb      8:16   0   10G  0 disk \nsr0     11:0    1 1024M  0 rom  \nvda    252:0    0   64G  0 disk \n\u251c\u2500vda1 252:1    0  512M  0 part /boot/efi\n\u2514\u2500vda2 252:2    0 63,5G  0 part /\n</code></pre>"},{"location":"tiedostojarjestelma/osiot/#osion-poisto","title":"Osion poisto","text":"<p>Aloita poistamalla rivi, jonka lis\u00e4sit <code>fstab</code>-tiedostoon. Jos k\u00e4yt\u00e4t <code>nano</code>-editoria, valittu rivi poistuu n\u00e4pp\u00e4r\u00e4sti Ctrl+K pikan\u00e4pp\u00e4imell\u00e4.</p> <p>T\u00e4m\u00e4n j\u00e4lkeen voit poistaa mountin. T\u00e4m\u00e4 hoituu komennolla <code>sudo umount /mnt/mydata</code>.</p> <p>Ja t\u00e4m\u00e4n j\u00e4lkeen voit poistaa partition:</p> Bash<pre><code>$ sudo parted /dev/sda\n\n# Varmista osion ID erityisesti jos niit\u00e4 on levyll\u00e4 monta\n(parted) print\n...\nNumber  Start   End     Size    File system  Name    Flags\n 1      1049kB  10,7GB  10,7GB  ext4         mydata\n\n# Poista valittu id\n(parted) rm 1\n\n# Tarkista, ett\u00e4 osio poistui. Huomaathan, ett\u00e4 GPT eli\n# partitiointitaulu on yh\u00e4 tallella. Sit\u00e4 ei ole tarve\n# poistaa t\u00e4ss\u00e4 harjoituksessa.\n(parted) print\n...\nPartition Table: gpt\n...\n\n(parted) quit\n</code></pre>"}]}